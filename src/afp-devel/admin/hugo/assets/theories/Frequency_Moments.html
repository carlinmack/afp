<div id='Frequency_Moment_k'>lts</title>
</head>


<body>
<div class="head">
<h1>Theory Frequency_Moments_Preliminary_Results</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Preliminary Results</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Frequency_Moments_Preliminary_Results</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> 
    </span><span class="quoted"><span>"</span><a href="../../HOL/HOL/Transcendental.html"><span>HOL.Transcendental</span></a><span>"</span></span><span> 
    </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Computational_Algebra/Primes.html"><span>HOL-Computational_Algebra.Primes</span></a><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Library/Extended_Real.html"><span>HOL-Library.Extended_Real</span></a><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Library/Multiset.html"><span>HOL-Library.Multiset</span></a><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Library/Sublist.html"><span>HOL-Library.Sublist</span></a><span>"</span></span><span>
    </span><a href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html"><span>Prefix_Free_Code_Combinators.Prefix_Free_Code_Combinators</span></a><span>
    </span><a href="../Bertrands_Postulate/Bertrand.html"><span>Bertrands_Postulate.Bertrand</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>This section contains various preliminary results.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_399..404">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.card_ordered_pairs|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.card_ordered_pairs|thm"><span>card_ordered_pairs</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>::</span></span><span>linorder</span><span class="main"><span>)</span></span><span> </span><span>set</span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_563..564">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_399..404"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_611..619">inj_swap</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span>fst</span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>inj_onI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>prod_eq_iff</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span>fst</span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>`</span></span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>card_image</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>inj_on_subset</span><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_611..619"><span>inj_swap</span></a><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>arg_cong</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>set_eq_iff</span><span> </span><span>image_iff</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>âª</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_Un_disjoint</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_563..564"><span>a</span></a><span> </span><span>finite_subset</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> B</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="free"><span class="free"><span>M</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>Ã</span></span></span></span><span> </span><span class="free"><span class="free"><span class="free"><span>M</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>subsetI</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>arg_cong</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>set_eq_iff</span><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_Diff_subset</span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_563..564"><span>a</span></a><span> </span><span>finite_subset</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> B</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="free"><span class="free"><span>M</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>Ã</span></span></span></span><span> </span><span class="free"><span class="free"><span class="free"><span>M</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>subsetI</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_399..404"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>arg_cong2</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>(-)</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>arg_cong</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power2_eq_square</span><span> </span><span>set_eq_iff</span><span> </span><span>image_iff</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>card</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>arg_cong2</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>(-)</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>card_image</span><span> </span><span>inj_onI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power2_eq_square</span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.ereal_mono|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.ereal_mono|thm"><span>ereal_mono</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>ereal</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.log_mono|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.log_mono|thm"><span>log_mono</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>log</span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>log</span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>log_le_cancel_iff</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.abs_ge_iff|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.abs_ge_iff|thm"><span>abs_ge_iff</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>::</span></span><span>real</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>abs</span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>â¨</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>-</span></span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.count_list_gr_1|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.count_list_gr_1|thm"><span>count_list_gr_1</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.count_list_append|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.count_list_append|thm"><span>count_list_append</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>count_list</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span class="main"><span>@</span></span><span class="free"><span>ys</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>count_list</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>count_list</span><span> </span><span class="free"><span>ys</span></span><span> </span><span class="free"><span>v</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2358..2363">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.count_list_lt_suffix|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.count_list_lt_suffix|thm"><span>count_list_lt_suffix</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>suffix</span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>b</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>|</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span>  </span><span>length</span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>length</span><span> </span><span class="free"><span>a</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span>count_list</span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>count_list</span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>length</span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>length</span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_2358..2363"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>suffix_length_le</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="main"><span>(</span></span><span>nths</span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>length</span><span> </span><span class="free"><span>a</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_2358..2363"><span>assms</span></a><span> </span><span>diff_commute</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>set_nths</span><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_2716..2717">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="main"><span>(</span></span><span>take</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>length</span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span class="quasi_keyword"><span>asm</span></span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>lessThan_def</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>take</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>length</span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>@</span></span><span>drop</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>length</span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>take</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>length</span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>@</span></span><span class="free"><span>a</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_2358..2363"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span>suffix_take</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_3003..3004">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>take</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>length</span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>@</span></span><span class="free"><span>a</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>count_list</span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>count_list</span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>count_list</span><span> </span><span class="main"><span>(</span></span><span>take</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>length</span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>count_list</span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_2716..2717"><span>a</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.count_list_gr_1|fact"><span>count_list_gr_1</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>fast</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>  
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>count_list</span><span> </span><span class="free"><span>b</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_3003..3004"><span>b</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.count_list_append|fact"><span>count_list_append</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3363..3368">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.suffix_drop_drop|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.suffix_drop_drop|thm"><span>suffix_drop_drop</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>suffix</span><span> </span><span class="main"><span>(</span></span><span>drop</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>drop</span><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>drop</span><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>take</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>drop</span><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>@</span></span><span>drop</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>-</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>drop</span><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>append_take_drop_id</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>take</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>-</span></span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>drop</span><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>@</span></span><span>drop</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_3363..3368"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>drop</span><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>take</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>-</span></span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>drop</span><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>@</span></span><span>drop</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>suffix_def</span><span class="main"><span>)</span></span><span> 
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.count_list_card|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.count_list_card|thm"><span>count_list_card</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>count_list</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>count_list</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>length</span><span> </span><span class="main"><span>(</span></span><span>filter</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(=)</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>length_filter_conv_card</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>metis</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4074..4079">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.card_gr_1_iff|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.card_gr_1_iff|thm"><span>card_gr_1_iff</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_4074..4079"><span>assms</span></a><span> </span><span>card_le_Suc0_iff_eq</span><span> </span><span>leI</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4211..4216">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.count_list_ge_2_iff|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.count_list_ge_2_iff|thm"><span>count_list_ge_2_iff</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>z</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>z</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span>z</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>count_list</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span>y</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_4211..4216"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.card_gr_1_iff|fact"><span>card_gr_1_iff</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> x</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="free"><span class="free"><span>y</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> y</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="free"><span class="free"><span>z</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.count_list_card|fact"><span>count_list_card</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Results about multisets and sorting</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>This is a induction scheme over the distinct elements of a multisets: 
</span><span>We can represent each multiset as a sum like: 
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>text</span></span><span> </span><span class="raw_text"><span>"replicate_mset n<span class="hidden">â©</span><sub>1</sub> x<span class="hidden">â©</span><sub>1</sub> + replicate_mset n<span class="hidden">â©</span><sub>2</sub> x<span class="hidden">â©</span><sub>2</sub> + ... + replicate_mset n<span class="hidden">â©</span><sub>k</sub> x<span class="hidden">â©</span><sub>k</sub>"</span></span><span class="antiquote"><span>}</span></span></span><span> where the 
</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>x<span class="hidden">â©</span><sub>i</sub></span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> are distinct.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4835..4840">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.disj_induct_mset|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.disj_induct_mset|thm"><span>disj_induct_mset</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="main"><span>{#}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span> </span><span class="bound"><span>M</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>M</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>Â¬</span></span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â#</span></span><span> </span><span class="bound"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>M</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>replicate_mset</span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>size</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>M</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span>nat_less_induct</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_5032..5033">1</span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{#}</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_4835..4840"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>x</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_5175..5180">x_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â#</span></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>multiset_nonemptyE</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_5228..5234">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>M1</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>replicate_mset</span><span> </span><span class="main"><span>(</span></span><span>count</span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_5298..5303">M_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>M1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>replicate_mset</span><span> </span><span class="main"><span>(</span></span><span>count</span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>count_le_replicate_mset_subset_eq</span><span> </span><span>dual_order.refl</span><span> </span><span>subset_mset.diff_add</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>size</span><span> </span><span class="skolem"><span>M1</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>size</span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_5298..5303"><span>M_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_5175..5180"><span>x_def</span></a><span> </span><span>count_greater_zero_iff</span><span> </span><span>less_add_same_cancel1</span><span> </span><span>size_replicate_mset</span><span> </span><span>size_union</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="skolem"><span>M1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_5032..5033"><span>1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>P</span></span><span> </span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_5298..5303"><span>M_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_4835..4840"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_5228..5234"><span>M1_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_5175..5180"><span>x_def</span></a><span> </span><span>count_eq_zero_iff</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.prod_mset_conv|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.prod_mset_conv|thm"><span>prod_mset_conv</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'b</span></span><span class="main"><span>::</span></span><span class="main"><span>{</span></span><span>comm_monoid_mult</span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prod_mset</span><span> </span><span class="main"><span>(</span></span><span>image_mset</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>prod</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>count</span><span> </span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set_mset</span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>A</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.disj_induct_mset|fact"><span>disj_induct_mset</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>1</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_5978..5979">2</span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>count</span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_5978..5979"><span>2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>count_eq_zero_iff</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set_mset</span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_5978..5979"><span>2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span> 
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6180..6185">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.sum_collapse|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.sum_collapse|thm"><span>sum_collapse</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'b</span></span><span class="main"><span>::</span></span><span class="main"><span>{</span></span><span>comm_monoid_add</span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>z</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="free"><span>z</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sum</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>z</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>sum.union_disjoint</span><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> A</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>A</span></span><span class="main"><span>-</span></span><span class="main"><span>{</span></span><span class="free"><span>z</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> B</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>z</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> g</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_6180..6185"><span>assms</span></a><span> </span><span>sum.insert_if</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>There is a version </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> [</span><span>source</span><span>] </span><span>sum_list_map_eq_sum_count</span><span class="antiquote"><span>}</span></span></span><span> but it doesn't work
</span><span>if the function maps into the reals.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.sum_list_eval|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.sum_list_eval|thm"><span>sum_list_eval</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'b</span></span><span class="main"><span>::</span></span><span class="main"><span>{</span></span><span>ring</span><span class="main"><span>,</span></span><span>semiring_1</span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sum_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>.</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_6727..6733">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>M</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>mset</span><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sum_mset</span><span> </span><span class="main"><span>(</span></span><span>image_mset</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set_mset</span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>count</span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.disj_induct_mset|fact"><span>disj_induct_mset</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>1</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_6939..6940">2</span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6957..6958">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set_mset</span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_6939..6940"><span>2</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_6939..6940"><span>2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_6957..6958"><span>a</span></a><span>  </span><span>count_eq_zero_iff</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>count_list</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>count</span><span> </span><span class="main"><span>(</span></span><span>mset</span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_6727..6733"><span>M_def</span></a><span> </span><span>sum_mset_sum_list</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.prod_list_eval|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.prod_list_eval|thm"><span>prod_list_eval</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'b</span></span><span class="main"><span>::</span></span><span class="main"><span>{</span></span><span>ring</span><span class="main"><span>,</span></span><span>semiring_1</span><span class="main"><span>,</span></span><span>comm_monoid_mult</span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prod_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_7423..7429">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>M</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>mset</span><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prod_mset</span><span> </span><span class="main"><span>(</span></span><span>image_mset</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set_mset</span><span> </span><span class="skolem"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span>count</span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M</span></span><span>"</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.disj_induct_mset|fact"><span>disj_induct_mset</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>1</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_7629..7630">2</span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7647..7648">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set_mset</span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_7629..7630"><span>2</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7707..7708">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>count</span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_7629..7630"><span>2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span>  </span><span>count_eq_zero_iff</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>blast</span></span><span> 
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_7629..7630"><span>2</span></a><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_7647..7648"><span>a</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_7707..7708"><span>b</span></a><span> </span><span>mult.commute</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>count_list</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>count</span><span> </span><span class="main"><span>(</span></span><span>mset</span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_7423..7429"><span>M_def</span></a><span> </span><span>prod_mset_prod_list</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.sorted_sorted_list_of_multiset|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.sorted_sorted_list_of_multiset|thm"><span>sorted_sorted_list_of_multiset</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sorted</span><span> </span><span class="main"><span>(</span></span><span>sorted_list_of_multiset</span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>M</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span>sorted_insort</span><span class="main"><span>)</span></span><span> 

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.count_mset|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.count_mset|thm"><span>count_mset</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>count</span><span> </span><span class="main"><span>(</span></span><span>mset</span><span> </span><span class="free"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>count_list</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>xs</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.swap_filter_image|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.swap_filter_image|thm"><span>swap_filter_image</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>filter_mset</span><span> </span><span class="free"><span>g</span></span><span> </span><span class="main"><span>(</span></span><span>image_mset</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>image_mset</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>filter_mset</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>A</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8337..8342">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.list_eq_iff|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.list_eq_iff|thm"><span>list_eq_iff</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>mset</span><span> </span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>mset</span><span> </span><span class="free"><span>ys</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sorted</span><span> </span><span class="free"><span>xs</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sorted</span><span> </span><span class="free"><span>ys</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>xs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>ys</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_8337..8342"><span>assms</span></a><span> </span><span>properties_for_sort</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8493..8498">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.sorted_list_of_multiset_image_commute|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.sorted_list_of_multiset_image_commute|thm"><span>sorted_list_of_multiset_image_commute</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>mono</span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sorted_list_of_multiset</span><span> </span><span class="main"><span>(</span></span><span>image_mset</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>sorted_list_of_multiset</span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sorted</span><span> </span><span class="main"><span>(</span></span><span>sorted_list_of_multiset</span><span> </span><span class="main"><span>(</span></span><span>image_mset</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.sorted_sorted_list_of_multiset|fact"><span>sorted_sorted_list_of_multiset</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span>sorted_wrt</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>sorted_list_of_multiset</span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>sorted_wrt_mono_rel</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> P</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>Î»</span></span></span></span><span class="bound"><span class="bound"><span class="bound"><span>x</span></span></span></span><span> </span><span class="bound"><span class="bound"><span class="bound"><span>y</span></span></span></span><span class="main"><span class="main"><span class="main"><span>.</span></span></span></span><span> </span><span class="bound"><span class="bound"><span class="bound"><span>x</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>â¤</span></span></span></span><span> </span><span class="bound"><span class="bound"><span class="bound"><span>y</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>monoD</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_8493..8498"><span>assms</span></a><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.sorted_sorted_list_of_multiset|fact"><span>sorted_sorted_list_of_multiset</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sorted</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>sorted_list_of_multiset</span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>sorted_wrt_map</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.list_eq_iff|fact"><span>list_eq_iff</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Results about rounding and floating point numbers</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.round_down_ge|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.round_down_ge|thm"><span>round_down_ge</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.round_down|const"><span>round_down</span></a><span> </span><span class="free"><span>prec</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="free"><span>prec</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.round_down_correct|fact"><span>round_down_correct</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>meson</span></span><span> </span><span>diff_diff_eq</span><span> </span><span>diff_eq_diff_less_eq</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.truncate_down_ge|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.truncate_down_ge|thm"><span>truncate_down_ge</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><span class="free"><span>prec</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>abs</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="free"><span>prec</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>abs</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_9421..9425">True</span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.round_down|const"><span>round_down</span></a><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>prec</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>x</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real_of_int</span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>prec</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>x</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.round_down_ge|fact"><span>round_down_ge</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><span class="free"><span>prec</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>x</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><span class="free"><span>prec</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>add_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>powr_add</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down_def|fact"><span>truncate_down_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><span class="free"><span>prec</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><span class="free"><span>prec</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_9421..9425"><span>True</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><span>mult_right_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>le_log_iff</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9957..9962">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.truncate_down_pos|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.truncate_down_pos|thm"><span>truncate_down_pos</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="free"><span>prec</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><span class="free"><span>prec</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>right_diff_distrib</span><span> </span><span>diff_le_eq</span><span class="main"><span>)</span></span><span>
   </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.truncate_down_ge|fact"><span>truncate_down_ge</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_9957..9962"><span>assms</span></a><span>  </span><span>abs_of_nonneg</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10154..10159">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.truncate_down_eq|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.truncate_down_eq|thm"><span>truncate_down_eq</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>abs</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span class="main"><span>-</span></span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>max</span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>abs</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>diff_right_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.truncate_down_ge|fact"><span>truncate_down_ge</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>abs</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>y</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down_le|fact"><span>truncate_down_le</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>diff_right_mono</span><span> </span><span>add_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_10154..10159"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>abs</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>max</span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10698..10699">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>max</span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>abs</span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>diff_right_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.truncate_down_ge|fact"><span>truncate_down_ge</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>abs</span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down_le|fact"><span>truncate_down_le</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>diff_right_mono</span><span> </span><span>add_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_10154..10159"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>abs</span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>max</span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_11165..11166">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>y</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>max</span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="free"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>abs_le_iff</span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_10698..10699"><span>a</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_11165..11166"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.rat_of_float_def|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.rat_of_float_def|thm"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.rat_of_float_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.rat_of_float|const"><span>rat_of_float</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float|type"><span>float</span></a><span> </span><span class="main"><span>â</span></span><span> </span><span>rat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>rat_of_float</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>of_int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.exponent|const"><span>exponent</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.exponent|const"><span>exponent</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.exponent|const"><span>exponent</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.real_of_rat_of_float|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.real_of_rat_of_float|thm"><span>real_of_rat_of_float</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.rat_of_float|const"><span>rat_of_float</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.real_of_float|const"><span>real_of_float</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.rat_of_float|const"><span>rat_of_float</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa|const"><span>mantissa</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.exponent|const"><span>exponent</span></a><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.rat_of_float_def|fact"><span>rat_of_float_def</span></a><span> </span><span>of_rat_mult</span><span> </span><span>of_rat_divide</span><span> </span><span>of_rat_power</span><span> </span><span>powr_realpow</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>powr_minus_divide</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.real_of_float|const"><span>real_of_float</span></a><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.mantissa_exponent|fact"><span>mantissa_exponent</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> 
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.log_est|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.log_est|thm"><span>log_est</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>of_nat_mono</span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.suc_n_le_2_pow_n|fact"><span>suc_n_le_2_pow_n</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>powr_realpow</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>Transcendental.log_le_iff</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.truncate_mantissa_bound|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.truncate_mantissa_bound|thm"><span>truncate_mantissa_bound</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span>abs</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>x</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>_</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_12335..12341">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>q</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>q</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>â</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>x</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>abs</span><span> </span><span class="skolem"><span>q</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_12439..12440">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>abs</span><span> </span><span class="skolem"><span>q</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>q</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_12439..12440"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>abs_of_nonneg</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_12335..12341"><span>q_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>x</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_12335..12341"><span>q_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>of_int_floor_le</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>x</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>x</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_12439..12440"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>powr_add</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_12439..12440"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>powr_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>powr_realpow</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>add.commute</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>abs</span><span> </span><span class="skolem"><span>q</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>of_int_le_iff</span><span> </span><span>of_int_numeral</span><span> </span><span>of_int_power</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>abs</span><span> </span><span class="skolem"><span>q</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_13188..13189">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>powr_realpow</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>add.commute</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>x</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_13188..13189"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>x</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_13188..13189"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>powr_add</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>q</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_12335..12341"><span>q_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>abs</span><span> </span><span class="skolem"><span>q</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_13188..13189"><span>a</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>abs_of_neg</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>mult_pos_neg2</span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_12335..12341"><span>q_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>abs</span><span> </span><span class="skolem"><span>q</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>of_int_less_iff</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>abs</span><span> </span><span class="skolem"><span>q</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>abs</span><span> </span><span class="skolem"><span>q</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>abs</span><span> </span><span class="skolem"><span>q</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_12335..12341"><span>q_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>abs</span><span> </span><span class="skolem"><span>q</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_12335..12341"><span>q_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.truncate_float_bit_count|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.truncate_float_bit_count|thm"><span>truncate_float_bit_count</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e|const"><span>F<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.float_of|const"><span>float_of</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><span class="free"><span>r</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>10</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>Â¦</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>x</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_14179..14185">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>m</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>m</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>â</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>x</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_14250..14256">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>e</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>e</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>x</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>int</span><span> </span><span class="free"><span>r</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_14299..14300">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>real_of_int</span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>x</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>e</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_14250..14256"><span>e_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>abs</span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.truncate_mantissa_bound|fact"><span>truncate_mantissa_bound</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_14179..14185"><span>m_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>abs</span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="skolem"><span>m</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>of_int_le_iff</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¦</span></span><span>real_of_int</span><span> </span><span class="skolem"><span>m</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>r</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_14732..14733">c</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="skolem"><span>m</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>r</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>Transcendental.log_le_iff</span><span> </span><span>powr_add</span><span> </span><span>powr_realpow</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="skolem"><span>e</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>x</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span>  </span><span>real_of_int</span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_14250..14256"><span>e_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real_of_int</span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>abs_le_iff</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_int</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>distrib_left</span><span> </span><span>distrib_right</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_15176..15177">d</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="skolem"><span>e</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_int</span><span> </span><span class="free"><span>r</span></span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="skolem"><span>e</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_int</span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_15176..15177"><span>d</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>log_mult</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.log_est|fact"><span>log_est</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>add.commute</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_15547..15548">e</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="skolem"><span>e</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e|const"><span>F<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.float_of|const"><span>float_of</span></a><span> </span><span class="main"><span>(</span></span><span>real_of_int</span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>e</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down_def|fact"><span>truncate_down_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.round_down_def|fact"><span>round_down_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_14179..14185"><span>m_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_14299..14300"><span>a</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>6</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="skolem"><span>m</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="skolem"><span>e</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.float_bit_count_2|fact"><span>float_bit_count_2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>6</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_14732..14733"><span>c</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_15547..15548"><span>e</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>ereal_less_eq</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><span>mult_left_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.prime_above_def|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.prime_above_def|thm"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.prime_above_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.prime_above|const"><span>prime_above</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>prime_above</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>SOME</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>..</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span>prime</span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>The term </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above|const"><span>prime_above</span></a><span> </span><span class="free"><span>n</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> returns a prime between </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span class="main"><span>::</span></span><span>nat</span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> and </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span>.
</span><span>Because of Bertrand's postulate there always is such a value. In a refinement of the algorithms, it may make sense to
</span><span>replace this with an algorithm, that finds such a prime exactly or approximately.
</span><span>
</span><span>The definition is intentionally inexact, to allow refinement with various algorithms, without modifying the
</span><span>high-level mathematical correctness proof.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_16736..16741">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.ex_subset|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.ex_subset|thm"><span>ex_subset</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>B</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_16736..16741"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.prime_above_prime|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.prime_above_prime|thm"><span>prime_above_prime</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prime</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above|const"><span>prime_above</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.prime_above_range|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.prime_above_range|thm"><span>prime_above_range</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above|const"><span>prime_above</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>n</span></span><span class="main"><span>..</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span>n</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_16963..16969">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>r</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>n</span></span><span class="main"><span>..</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span>n</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span>prime</span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span class="main"><span>&gt;</span></span><span class="numeral"><span>2</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>&lt;..&lt;</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>prime</span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Bertrands_Postulate/Bertrand.html#Bertrand.bertrand|fact"><span>bertrand</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>&lt;..&lt;</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>n</span></span><span class="main"><span>..</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>subsetI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>n</span></span><span class="main"><span>..</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span>n</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>prime</span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.ex_subset|fact"><span>ex_subset</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_16963..16969"><span>r_def</span></a><span> </span><span>Bex_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>n</span></span><span class="main"><span>..</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span>n</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prime</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>two_is_prime_nat</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_16963..16969"><span>r_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>exI</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above|const"><span>prime_above</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>SOME</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above_def|fact"><span>prime_above_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_16963..16969"><span>r_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17731..17732">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above|const"><span>prime_above</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>someI_ex</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prime</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above|const"><span>prime_above</span></a><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_17731..17732"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_16963..16969"><span>r_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above|const"><span>prime_above</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>n</span></span><span class="main"><span>..</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span>n</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_17731..17732"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#offset_16963..16969"><span>r_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.prime_above_min|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.prime_above_min|thm"><span>prime_above_min</span></span></span><span class="main"><span>:</span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above|const"><span>prime_above</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above_prime|fact"><span>prime_above_prime</span></a><span> 
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>prime_ge_2_nat</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.prime_above_lower_bound|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.prime_above_lower_bound|thm"><span>prime_above_lower_bound</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above|const"><span>prime_above</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above_range|fact"><span>prime_above_range</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments_Preliminary_Results.prime_above_upper_bound|fact"><span class="entity_def" id="Frequency_Moments_Preliminary_Results.prime_above_upper_bound|thm"><span>prime_above_upper_bound</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above|const"><span>prime_above</span></a><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span>n</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above_range|fact"><span>prime_above_range</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre></div><div id='Frequency_Moment_k'>

<body>
<div class="head">
<h1>Theory Frequency_Moments</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>"</span><span>Frequency Moments</span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Frequency_Moments</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> 
    </span><a href="Frequency_Moments_Preliminary_Results.html"><span>Frequency_Moments_Preliminary_Results</span></a><span>
    </span><a href="../Universal_Hash_Families/Field.html"><span>Universal_Hash_Families.Field</span></a><span>
    </span><a href="../Interpolation_Polynomials_HOL_Algebra/Interpolation_Polynomial_Cardinalities.html"><span>Interpolation_Polynomials_HOL_Algebra.Interpolation_Polynomial_Cardinalities</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>This section contains a definition of the frequency moments of a stream and a few general results about 
</span><span>frequency moments..</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moments.F_def|fact"><span class="entity_def" id="Frequency_Moments.F_def|thm"><span class="entity_def" id="Frequency_Moments.F_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moments.F|const"><span>F</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>F</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span>rat_of_nat</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>xs</span></span></span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments.F_ge_0|fact"><span class="entity_def" id="Frequency_Moments.F_ge_0|thm"><span>F_ge_0</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F_def|fact"><span>F_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>sum_nonneg</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_518..523">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments.F_gr_0|fact"><span class="entity_def" id="Frequency_Moments.F_gr_0|thm"><span>F_gr_0</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>[]</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>rat_of_nat</span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>rat_of_nat</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_518..523"><span>assms</span></a><span> </span><span>card_0_eq</span><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> A</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>set</span><span> </span><span class="free"><span>as</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>of_nat_mono</span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>List.finite_set</span><span> </span><span>One_nat_def</span><span> </span><span>Suc_leI</span><span> </span><span>neq0_conv</span><span> </span><span>set_empty</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span>rat_of_nat</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>sum_mono</span><span> </span><span>one_le_power</span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span>  </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.count_list_gr_1|fact"><span>count_list_gr_1</span></a><span>  </span><span>of_nat_1</span><span> </span><span>of_nat_le_iff</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F_def|fact"><span>F_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moments.P\&lt;^sub&gt;e_def|fact"><span class="entity_def" id="Frequency_Moments.P\&lt;^sub&gt;e_def|thm"><span class="entity_def" id="Frequency_Moments.P\&lt;^sub&gt;e_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moments.P\&lt;^sub&gt;e|const"><span>P<span class="hidden">â©</span><sub>e</sub></span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span>list</span><span> </span><span class="main"><span>â</span></span><span> </span><span>bool</span><span> </span><span>list</span><span> </span><span>option</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>P<span class="hidden">â©</span><sub>e</sub></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials|const"><span>bounded_degree_polynomials</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>Field.mod_ring</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="keyword1"><span>then</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e|const"><span>Nb<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Polynomials.html#Polynomials.ring.coeff|const"><span>ring.coeff</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>Field.mod_ring</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span>None</span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments.poly_encoding|fact"><span class="entity_def" id="Frequency_Moments.poly_encoding|thm"><span>poly_encoding</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.P\&lt;^sub&gt;e|const"><span>P<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>p</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_1373..1377">True</span><span>
  </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.cring|locale"><span>cring</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>Field.mod_ring</span></a><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring_is_cring|fact"><span>mod_ring_is_cring</span></a><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_1373..1377"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1448..1450">by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_1464..1465">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#offset_1448..1450"><span>coeff</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials|const"><span>bounded_degree_polynomials</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>inj_onI</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_1598..1599">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials|const"><span>bounded_degree_polynomials</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_1659..1660">c</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials|const"><span>bounded_degree_polynomials</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_1720..1721">d</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>restrict</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#offset_1448..1450"><span>coeff</span></a><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>restrict</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#offset_1448..1450"><span>coeff</span></a><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moments.html#offset_1448..1450"><span>coeff</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_1448..1450"><span>coeff</span></a><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>i</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>i</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>lessThan_iff</span><span> </span><span>restrict_apply</span><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_1720..1721"><span>d</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_1962..1963">e</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moments.html#offset_1448..1450"><span>coeff</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.ring.zero|const"><span>ð¬</span></a></span><span>â</span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>p</span></span><span>â</span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_1598..1599"><span>b</span></a><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_1962..1963"><span>e</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_1448..1450"><span>coeff_length</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials_length|fact"><span>bounded_degree_polynomials_length</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_1448..1450"><span>coeff</span></a><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>i</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_1659..1660"><span>c</span></a><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_1962..1963"><span>e</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_1448..1450"><span>coeff_length</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials_length|fact"><span>bounded_degree_polynomials_length</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_1598..1599"><span>b</span></a><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_1659..1660"><span>c</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Polynomials.html#Polynomials.univ_poly_carrier|fact"><span>univ_poly_carrier</span></a><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_1448..1450"><span>coeff_iff_polynomial_cond</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials_length|fact"><span>bounded_degree_polynomials_length</span></a><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>f</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.P\&lt;^sub&gt;e|const"><span>P<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>f</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.P\&lt;^sub&gt;e_def|fact"><span>P<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_1464..1465"><span>a</span></a><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_1373..1377"><span>True</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding_compose|fact"><span>encoding_compose</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span><span class="main"><span class="main"><span class="main"><span>0</span></span></span></span><span class="main"><span class="main"><span class="main"><span>..&lt;</span></span></span></span><span class="free"><span class="free"><span class="free"><span>n</span></span></span></span><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span></a></span></a></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e|const"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e|const"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e|const"><span>Nb<span class="hidden">â©</span><sub>e</sub></span></a></a></a><span> </span><span class="free"><span class="free"><span class="free"><span>p</span></span></span></span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.fun_encoding|fact"><span>fun_encoding</span></a><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bounded_nat_encoding|fact"><span>bounded_nat_encoding</span></a><span class="main"><span>)</span></span><span> 
     </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>f</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.P\&lt;^sub&gt;e|const"><span>P<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="bound"><span>f</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.P\&lt;^sub&gt;e_def|fact"><span>P<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding_triv|fact"><span>encoding_triv</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2772..2777">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moments.bounded_degree_polynomial_bit_count|fact"><span class="entity_def" id="Frequency_Moments.bounded_degree_polynomial_bit_count|thm"><span>bounded_degree_polynomial_bit_count</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>p</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials|const"><span>bounded_degree_polynomials</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>Field.mod_ring</span></a><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.P\&lt;^sub&gt;e|const"><span>P<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Ring.html#Ring.cring|locale"><span>cring</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>Field.mod_ring</span></a><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring_is_cring|fact"><span>mod_ring_is_cring</span></a><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_2772..2777"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3041..3043">by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_3058..3059">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Algebra/Polynomial_Divisibility.html#Polynomial_Divisibility.poly_ring|const"><span>poly_ring</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_2772..2777"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials_def|fact"><span>bounded_degree_polynomials_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real_of_int</span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>p</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>p</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>floor_eq_iff</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_2772..2777"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_3359..3360">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>p</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.P\&lt;^sub&gt;e|const"><span>P<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.Nb\&lt;^sub&gt;e|const"><span>Nb<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#offset_3041..3043"><span>coeff</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_2772..2777"><span>assms</span></a><span> </span><span>restrict_extensional</span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span>arg_cong</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>sum_list</span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.P\&lt;^sub&gt;e_def|fact"><span>P<span class="hidden">â©</span><sub>e</sub>_def</span></a><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.fun_bit_count|fact"><span>fun_bit_count</span></a><span> </span><span>lessThan_atLeast0</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>]</span></span><span class="main"><span>.</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>p</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_3041..3043"><span>coeff_in_carrier</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_3058..3059"><span>a</span></a><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring_carr|fact"><span>mod_ring_carr</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bounded_nat_bit_count_2|fact"><span>bounded_nat_bit_count_2</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog|const"><span>floorlog</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>p</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>sum_list_triv</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>p</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_2772..2777"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../../HOL/HOL-Library/Log_Nat.html#Log_Nat.floorlog_def|fact"><span>floorlog_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>ereal_less_eq</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span> </span><a class="entity_ref" href="Frequency_Moments.html#offset_3359..3360"><span>b</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span></pre></div><div id='Frequency_Moment_k'>>
<div class="head">
<h1>Theory K_Smallest</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Ranks, $k$ smallest element and elements</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>K_Smallest</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> 
    </span><a href="Frequency_Moments_Preliminary_Results.html"><span>Frequency_Moments_Preliminary_Results</span></a><span>
    </span><a href="../Interpolation_Polynomials_HOL_Algebra/Interpolation_Polynomial_Cardinalities.html"><span>Interpolation_Polynomials_HOL_Algebra.Interpolation_Polynomial_Cardinalities</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>This section contains definitions and results for the selection of the $k$ smallest elements, the $k$-th smallest element, rank of an element in an ordered set.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="K_Smallest.rank_of_def|fact"><span class="entity_def" id="K_Smallest.rank_of_def|thm"><span class="entity_def" id="K_Smallest.rank_of_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="K_Smallest.rank_of|const"><span>rank_of</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>linorder</span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span>set</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>rank_of</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>S</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>S</span></span></span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>  
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>The function </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> returns the rank of an element within a set.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_563..568">lemma</span></span></span><span> </span><span class="entity_def" id="K_Smallest.rank_mono|fact"><span class="entity_def" id="K_Smallest.rank_mono|thm"><span>rank_mono</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>y</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="free"><span>y</span></span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of_def|fact"><span>rank_of_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_563..568"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_709..714">lemma</span></span></span><span> </span><span class="entity_def" id="K_Smallest.rank_mono_2|fact"><span class="entity_def" id="K_Smallest.rank_mono_2|thm"><span>rank_mono_2</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>S'</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>S'</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of_def|fact"><span>rank_of_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_709..714"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_859..864">lemma</span></span></span><span> </span><span class="entity_def" id="K_Smallest.rank_mono_commute|fact"><span class="entity_def" id="K_Smallest.rank_mono_commute|thm"><span>rank_mono_commute</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>S</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>T</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>strict_mono_on</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>T</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>T</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_1033..1034">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>T</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_859..864"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>strict_mono_on_imp_inj_on</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of_def|fact"><span>rank_of_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>arg_cong</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_859..864"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>arg_cong</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>arg_cong</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>(`)</span></span></span></span><span> </span><span class="free"><span class="free"><span class="free"><span>f</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><span>in_mono</span><span> </span><span>linorder_not_le</span><span> </span><span>strict_mono_onD</span><span> </span><span>strict_mono_on_leD</span><span> </span><span>set_eq_iff</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_859..864"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_image</span><span>  </span><span>inj_on_subset</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_1033..1034"><span>a</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of_def|fact"><span>rank_of_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="K_Smallest.least_def|fact"><span class="entity_def" id="K_Smallest.least_def|thm"><span class="entity_def" id="K_Smallest.least_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="K_Smallest.least|const"><span>least</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>least</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>S</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>S</span></span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="bound"><span>y</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>S</span></span></span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>The function </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> returns the k smallest elements of a finite set.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1794..1799">lemma</span></span></span><span> </span><span class="entity_def" id="K_Smallest.rank_strict_mono|fact"><span class="entity_def" id="K_Smallest.rank_strict_mono|thm"><span>rank_strict_mono</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>strict_mono_on</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="bound"><span>y</span></span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of_def|fact"><span>rank_of_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_1794..1799"><span>assms</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>psubset_card_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of_def|fact"><span>rank_of_def</span></a><span> </span><span>strict_mono_on_def</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2106..2111">lemma</span></span></span><span> </span><span class="entity_def" id="K_Smallest.rank_of_image|fact"><span class="entity_def" id="K_Smallest.rank_of_image|thm"><span>rank_of_image</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span>card</span><span> </span><span class="free"><span>S</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>card_seteq</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span>card</span><span> </span><span class="free"><span>S</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>card</span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>psubset_card_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_2106..2111"><span>assms</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span>card</span><span> </span><span class="free"><span>S</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>image_subsetI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of_def|fact"><span>rank_of_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>strict_mono_on_imp_inj_on</span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_strict_mono|fact"><span>rank_strict_mono</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_2106..2111"><span>assms</span></a><span class="main"><span>)</span></span><span> 
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span>card</span><span> </span><span class="free"><span>S</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>card_image</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2650..2655">lemma</span></span></span><span> </span><span class="entity_def" id="K_Smallest.card_least|fact"><span class="entity_def" id="K_Smallest.card_least|thm"><span>card_least</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>min</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_2767..2771">True</span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>t</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="bound"><span>t</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>card</span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of_def|fact"><span>rank_of_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_2650..2655"><span>assms</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>t</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="bound"><span>t</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_2767..2771"><span>True</span></a><span> </span><span>not_less_iff_gr_or_eq</span><span> </span><span>order_less_le_trans</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_def|fact"><span>least_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_2767..2771"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_3087..3088">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>leI</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_2650..2655"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Interpolation_Polynomial_Cardinalities.html#Interpolation_Polynomial_Cardinalities.card_vimage_inj_on|fact"><span>card_vimage_inj_on</span></a><span> </span><span>strict_mono_on_imp_inj_on</span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_strict_mono|fact"><span>rank_strict_mono</span></a><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of_image|fact"><span>rank_of_image</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>Collect_conj_eq</span><span> </span><span>Int_commute</span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_def|fact"><span>least_def</span></a><span> </span><span>vimage_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_3087..3088"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="K_Smallest.least_subset|fact"><span class="entity_def" id="K_Smallest.least_subset|thm"><span>least_subset</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_def|fact"><span>least_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3521..3526">lemma</span></span></span><span> </span><span class="entity_def" id="K_Smallest.least_mono_commute|fact"><span class="entity_def" id="K_Smallest.least_mono_commute|thm"><span>least_mono_commute</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>strict_mono_on</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_3656..3657">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>strict_mono_on_imp_inj_on</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_3521..3526"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>min</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.card_least|fact"><span>card_least</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#offset_3521..3526"><span>assms</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>min</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>card_image</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_3656..3657"><span>a</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.card_least|fact"><span>card_least</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#offset_3521..3526"><span>assms</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>card_image</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>inj_on_subset</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_3656..3657"><span>a</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_def|fact"><span>least_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_4122..4123">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_4189..4190">c</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>â</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_3521..3526"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>image_subsetI</span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_def|fact"><span>least_def</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_mono_commute|fact"><span>rank_mono_commute</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> T</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>S</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_4122..4123"><span>b</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_4189..4190"><span>c</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_3521..3526"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_seteq</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_def|fact"><span>least_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4423..4428">lemma</span></span></span><span> </span><span class="entity_def" id="K_Smallest.least_eq_iff|fact"><span class="entity_def" id="K_Smallest.least_eq_iff|thm"><span>least_eq_iff</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>B</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>B</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>B</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>B</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_4423..4428"><span>assms</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_mono_2|fact"><span>rank_mono_2</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_4423..4428"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>,</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span> </span><span>order_le_less_trans</span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_def|fact"><span>least_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_4423..4428"><span>assms</span></a><span> </span><span>finite_subset</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_4423..4428"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>,</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span> </span><span>card_mono</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_4423..4428"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>,</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.card_least|fact"><span>card_least</span></a><span> </span><span>min_le_iff_disj</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>finite_subset</span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_subset|fact"><span>least_subset</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_4423..4428"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>,</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_seteq</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5043..5048">lemma</span></span></span><span> </span><span class="entity_def" id="K_Smallest.least_insert|fact"><span class="entity_def" id="K_Smallest.least_insert|thm"><span>least_insert</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>(</span></span><span>insert</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>(</span></span><span>insert</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_eq_iff|fact"><span>least_eq_iff</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="main"><span>(</span></span><span>insert</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_5043..5048"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>insert</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>insert</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_subset|fact"><span>least_subset</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>insert</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_5362..5363">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>insert</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>S</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_5386..5387">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>(</span></span><span>insert</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>y</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>(</span></span><span>insert</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_5043..5048"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_mono_2|fact"><span>rank_mono_2</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_5386..5387"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¨</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_5362..5363"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_def|fact"><span>least_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="K_Smallest.count_le_def|fact"><span class="entity_def" id="K_Smallest.count_le_def|thm"><span class="entity_def" id="K_Smallest.count_le_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="K_Smallest.count_le|const"><span>count_le</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>count_le</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>M</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>size</span><span> </span><span class="main"><span>{#</span></span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â#</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>M</span></span></span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>#}</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="K_Smallest.count_less_def|fact"><span class="entity_def" id="K_Smallest.count_less_def|thm"><span class="entity_def" id="K_Smallest.count_less_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="K_Smallest.count_less|const"><span>count_less</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>count_less</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>M</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>size</span><span> </span><span class="main"><span>{#</span></span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â#</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>M</span></span></span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>#}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="K_Smallest.nth_mset_def|fact"><span class="entity_def" id="K_Smallest.nth_mset_def|thm"><span class="entity_def" id="K_Smallest.nth_mset_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="K_Smallest.nth_mset|const"><span>nth_mset</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>linorder</span><span class="main"><span>)</span></span><span> </span><span>multiset</span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'a</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>nth_mset</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>M</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>sorted_list_of_multiset</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>M</span></span></span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5989..5994">lemma</span></span></span><span> </span><span class="entity_def" id="K_Smallest.nth_mset_bound_left|fact"><span class="entity_def" id="K_Smallest.nth_mset_bound_left|thm"><span>nth_mset_bound_left</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>size</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.count_less|const"><span>count_less</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset|const"><span>nth_mset</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>ccontr</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_6119..6125">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>xs</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>sorted_list_of_multiset</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6175..6179">s_xs</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sorted</span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#offset_6119..6125"><span>xs_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.sorted_sorted_list_of_multiset|fact"><span>sorted_sorted_list_of_multiset</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6252..6256">l_xs</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span>  </span><a class="entity_ref" href="K_Smallest.html#offset_5989..5994"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#offset_6119..6125"><span>xs_def</span></a><span> </span><span>size_mset</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6344..6348">M_xs</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>mset</span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#offset_6119..6125"><span>xs_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_6393..6394">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_6175..6179"><span>s_xs</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_6252..6256"><span>l_xs</span></a><span> </span><span>sorted_iff_nth_mono</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset|const"><span>nth_mset</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset|const"><span>nth_mset</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_6549..6550">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset_def|fact"><span>nth_mset_def</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_6119..6125"><span>xs_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_6393..6394"><span>a</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_6549..6550"><span>b</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_6252..6256"><span>l_xs</span></a><span> </span><span>order_le_less_trans</span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_mono</span><span> </span><span>subsetI</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>length</span><span> </span><span class="main"><span>(</span></span><span>filter</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>length_filter_conv_card</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>size</span><span> </span><span class="main"><span>(</span></span><span>mset</span><span> </span><span class="main"><span>(</span></span><span>filter</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>size_mset</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.count_less|const"><span>count_less</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.count_less_def|fact"><span>count_less_def</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_6344..6348"><span>M_xs</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_5989..5994"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>False</span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_7116..7121">lemma</span></span></span><span> </span><span class="entity_def" id="K_Smallest.nth_mset_bound_left_excl|fact"><span class="entity_def" id="K_Smallest.nth_mset_bound_left_excl|thm"><span>nth_mset_bound_left_excl</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>size</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.count_le|const"><span>count_le</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset|const"><span>nth_mset</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>ccontr</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_7249..7255">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>xs</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>sorted_list_of_multiset</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7305..7309">s_xs</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sorted</span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#offset_7249..7255"><span>xs_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.sorted_sorted_list_of_multiset|fact"><span>sorted_sorted_list_of_multiset</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7382..7386">l_xs</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span>  </span><a class="entity_ref" href="K_Smallest.html#offset_7116..7121"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#offset_7249..7255"><span>xs_def</span></a><span> </span><span>size_mset</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7475..7479">M_xs</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>mset</span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#offset_7249..7255"><span>xs_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_7524..7525">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_7305..7309"><span>s_xs</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_7382..7386"><span>l_xs</span></a><span> </span><span>sorted_iff_nth_mono</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset|const"><span>nth_mset</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset|const"><span>nth_mset</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_7680..7681">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset_def|fact"><span>nth_mset_def</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_7249..7255"><span>xs_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_7524..7525"><span>a</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_7680..7681"><span>b</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_7382..7386"><span>l_xs</span></a><span> </span><span>order_le_less_trans</span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_mono</span><span> </span><span>subsetI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_7680..7681"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_mono</span><span> </span><span>subsetI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>length</span><span> </span><span class="main"><span>(</span></span><span>filter</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>length_filter_conv_card</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>size</span><span> </span><span class="main"><span>(</span></span><span>mset</span><span> </span><span class="main"><span>(</span></span><span>filter</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>size_mset</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.count_le|const"><span>count_le</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.count_le_def|fact"><span>count_le_def</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_7475..7479"><span>M_xs</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_7116..7121"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>False</span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8354..8359">lemma</span></span></span><span> </span><span class="entity_def" id="K_Smallest.nth_mset_bound_right|fact"><span class="entity_def" id="K_Smallest.nth_mset_bound_right|thm"><span>nth_mset_bound_right</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>size</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.count_le|const"><span>count_le</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset|const"><span>nth_mset</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>x</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>ccontr</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_8483..8489">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>xs</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>sorted_list_of_multiset</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8539..8543">s_xs</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sorted</span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#offset_8483..8489"><span>xs_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.sorted_sorted_list_of_multiset|fact"><span>sorted_sorted_list_of_multiset</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8616..8620">l_xs</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span>  </span><a class="entity_ref" href="K_Smallest.html#offset_8354..8359"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#offset_8483..8489"><span>xs_def</span></a><span> </span><span>size_mset</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8709..8713">M_xs</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>mset</span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#offset_8483..8489"><span>xs_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset|const"><span>nth_mset</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset|const"><span>nth_mset</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset_def|fact"><span>nth_mset_def</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_8483..8489"><span>xs_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_8896..8897">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_8539..8543"><span>s_xs</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_8616..8620"><span>l_xs</span></a><span> </span><span>sorted_iff_nth_mono</span><span> </span><span>leI</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.count_le|const"><span>count_le</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>size</span><span> </span><span class="main"><span>(</span></span><span>mset</span><span> </span><span class="main"><span>(</span></span><span>filter</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.count_le_def|fact"><span>count_le_def</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_8709..8713"><span>M_xs</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>length</span><span> </span><span class="main"><span>(</span></span><span>filter</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>size_mset</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>length_filter_conv_card</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_8896..8897"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_mono</span><span> </span><span>subsetI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.count_le|const"><span>count_le</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>False</span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_8354..8359"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9471..9476">lemma</span></span></span><span> </span><span class="entity_def" id="K_Smallest.nth_mset_commute_mono|fact"><span class="entity_def" id="K_Smallest.nth_mset_commute_mono|thm"><span>nth_mset_commute_mono</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>mono</span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>size</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset|const"><span>nth_mset</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset|const"><span>nth_mset</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>(</span></span><span>image_mset</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_9614..9615">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="main"><span>(</span></span><span>sorted_list_of_multiset</span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_9471..9476"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>mset_sorted_list_of_multiset</span><span> </span><span>size_mset</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_9614..9615"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset_def|fact"><span>nth_mset_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.sorted_list_of_multiset_image_commute|fact"><span>sorted_list_of_multiset_image_commute</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_9471..9476"><span>assms</span></a><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>1</span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> 

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9831..9836">lemma</span></span></span><span> </span><span class="entity_def" id="K_Smallest.nth_mset_max|fact"><span class="entity_def" id="K_Smallest.nth_mset_max(2)|thm"><span class="entity_def" id="K_Smallest.nth_mset_max(1)|thm"><span>nth_mset_max</span></span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>size</span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset|const"><span>nth_mset</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>count</span><span> </span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset|const"><span>nth_mset</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Max</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set_mset</span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set_mset</span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_10034..10040">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>xs</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>sorted_list_of_multiset</span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10090..10097">k_bound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10034..10040"><span>xs_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>size_mset</span><span> </span><span>mset_sorted_list_of_multiset</span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_9831..9836"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>  

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10205..10210">A_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>A</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>mset</span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#offset_10034..10040"><span>xs_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10254..10258">s_xs</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>sorted</span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#offset_10034..10040"><span>xs_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.sorted_sorted_list_of_multiset|fact"><span>sorted_sorted_list_of_multiset</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>count</span><span> </span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_9831..9836"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#offset_10034..10040"><span>xs_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset_def|fact"><span>nth_mset_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_10440..10446">no_col</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>count_list</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#offset_10205..10210"><span>A_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.count_mset|fact"><span>count_mset</span></a><span class="main"><span>)</span></span><span> 

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10532..10538">inj_xs</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>inj_onI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>full_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.count_list_ge_2_iff|fact"><span>count_list_ge_2_iff</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10090..10097"><span>k_bound</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10440..10446"><span>no_col</span></a><span>
        </span><span>le_neq_implies_less</span><span> </span><span>linorder_not_le</span><span> </span><span>order_le_less_trans</span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10254..10258"><span>s_xs</span></a><span> </span><span>sorted_iff_nth_mono</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>ccontr</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>y</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_10857..10858">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_10908..10909">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10940..10941">d</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>Suc</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10908..10909"><span>a</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10857..10858"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(!)</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>card_image</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10532..10538"><span>inj_xs</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of_def|fact"><span>rank_of_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10090..10097"><span>k_bound</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_mono</span><span> </span><span>image_subsetI</span><span> </span><span>conjI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.count_list_ge_2_iff|fact"><span>count_list_ge_2_iff</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10440..10446"><span>no_col</span></a><span> </span><span>not_le</span><span> </span><span>le_imp_less_Suc</span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10254..10258"><span>s_xs</span></a><span> 
          </span><span>sorted_iff_nth_mono</span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10940..10941"><span>d</span></a><span> </span><span>order_less_le</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of_def|fact"><span>rank_of_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_mono</span><span> </span><span>subsetI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
       </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Suc_eq_plus1</span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10908..10909"><span>a</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10857..10858"><span>b</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10254..10258"><span>s_xs</span></a><span> </span><span>order_less_le_trans</span><span> </span><span>sorted_iff_nth_mono</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>False</span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_11648..11649">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>y</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of_def|fact"><span>rank_of_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_mono</span><span> </span><span>subsetI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
       </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>imageI</span><span> </span><span>in_set_conv_nth</span><span> </span><span>mem_Collect_eq</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>card_image_le</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_mono</span><span> </span><span>subsetI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>not_less</span><span class="main"><span>)</span></span><span>
       </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>sorted_iff_nth_mono</span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10254..10258"><span>s_xs</span></a><span> </span><span>linorder_not_less</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_11648..11649"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_12332..12341">rank_conv</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â·</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>  </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_12445..12446">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>y</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_12445..12446"><span>a</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_subset|fact"><span>least_subset</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>i</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_12567..12574">i_bound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_12596..12601">y_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="skolem"><span>i</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>in_set_conv_nth</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.rank_of|const"><span>rank_of</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_12445..12446"><span>a</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_12596..12601"><span>y_def</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_12567..12574"><span>i_bound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_def|fact"><span>least_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_12332..12341"><span>rank_conv</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_12567..12574"><span>i_bound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10254..10258"><span>s_xs</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_12567..12574"><span>i_bound</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10090..10097"><span>k_bound</span></a><span> </span><span>sorted_nth_mono</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_12596..12601"><span>y_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10090..10097"><span>k_bound</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_12332..12341"><span>rank_conv</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_def|fact"><span>least_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Max</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>Max_eqI</span><span> </span><span>finite_subset</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_subset|fact"><span>least_subset</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset|const"><span>nth_mset</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Max</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>K_Smallest.least</span></a><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset_def|fact"><span>nth_mset_def</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10034..10040"><span>xs_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Max</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set_mset</span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#offset_10205..10210"><span>A_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset|const"><span>nth_mset</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Max</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set_mset</span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..</span></span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>card_image</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10532..10538"><span>inj_xs</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#offset_12332..12341"><span>rank_conv</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#offset_10090..10097"><span>k_bound</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_mono</span><span> </span><span>image_subsetI</span><span> </span><span>finite_subset</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_subset|fact"><span>least_subset</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_def|fact"><span>least_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.card_least|fact"><span>card_least</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set_mset</span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#offset_10205..10210"><span>A_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre></div><div id='Frequency_Moment_k'>>
<div class="head">
<h1>Theory Landau_Ext</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Landau Symbols</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Landau_Ext</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> 
    </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Library/Landau_Symbols.html"><span>HOL-Library.Landau_Symbols</span></a><span>"</span></span><span>
    </span><span class="quoted"><span>"</span><a href="../../HOL/HOL/Topological_Spaces.html"><span>HOL.Topological_Spaces</span></a><span>"</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>This section contains results about Landau Symbols in addition to "HOL-Library.Landau".</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_221..226">lemma</span></span></span><span> </span><span class="entity_def" id="Landau_Ext.landau_sum|fact"><span class="entity_def" id="Landau_Ext.landau_sum|thm"><span>landau_sum</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>g1</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>real</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>g2</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f1</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g1</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f2</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f1</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>f2</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>g1</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>g2</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>c1</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_459..461">a1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>c1</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_476..478">b1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f1</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>c1</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g1</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_221..226"><span>assms</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo_def|fact"><span>bigo_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>c2</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_597..599">a2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>c2</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_614..616">b2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f2</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>c2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g2</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_221..226"><span>assms</span></a><span class="main"><span>(</span></span><span>4</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo_def|fact"><span>bigo_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f1</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>f2</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span>max</span><span> </span><span class="skolem"><span>c1</span></span><span> </span><span class="skolem"><span>c2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g1</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>g2</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>eventually_mono</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>eventually_conj</span><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_476..478"><span>b1</span></a><span> </span><span>eventually_conj</span><span class="main"><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_614..616"><span>b2</span></a><span> </span><span>eventually_conj</span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_221..226"><span>assms</span></a><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span></span></span></span><span>1</span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>,</span></span></span></span></span></span></span><span>2</span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span></span></span></span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span></span></span><span class="main"><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span></span><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_930..931">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¦</span></span><span class="free"><span>f1</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>c1</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>g1</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>f2</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>c2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>g2</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>g1</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>g2</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¦</span></span><span class="free"><span>f1</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>f2</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>f1</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>f2</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>abs_triangle_ineq</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>c1</span></span><span> </span><span class="main"><span>*</span></span><span>  </span><span class="main"><span>Â¦</span></span><span class="free"><span>g1</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>c2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>g2</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_930..931"><span>a</span></a><span> </span><span>add_mono</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>max</span><span> </span><span class="skolem"><span>c1</span></span><span> </span><span class="skolem"><span>c2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>g1</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>max</span><span> </span><span class="skolem"><span>c1</span></span><span> </span><span class="skolem"><span>c2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>g2</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><span>mult_right_mono</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>max</span><span> </span><span class="skolem"><span>c1</span></span><span> </span><span class="skolem"><span>c2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>g1</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>g2</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>max</span><span> </span><span class="skolem"><span>c1</span></span><span> </span><span class="skolem"><span>c2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Â¦</span></span><span class="free"><span>g1</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>g2</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_930..931"><span>a</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_459..461"><span>a1</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_597..599"><span>a2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¦</span></span><span class="free"><span>f1</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>f2</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>max</span><span> </span><span class="skolem"><span>c1</span></span><span> </span><span class="skolem"><span>c2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>g1</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>g2</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>max</span><span> </span><span class="skolem"><span>c1</span></span><span> </span><span class="skolem"><span>c2</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>F</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>f1</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>f2</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>max</span><span> </span><span class="skolem"><span>c1</span></span><span> </span><span class="skolem"><span>c2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>g1</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>g2</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_459..461"><span>a1</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_597..599"><span>a2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo_def|fact"><span>bigo_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span> 
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1718..1723">lemma</span></span></span><span> </span><span class="entity_def" id="Landau_Ext.landau_sum_1|fact"><span class="entity_def" id="Landau_Ext.landau_sum_1|thm"><span>landau_sum_1</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>g1</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>real</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>g2</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g1</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>g1</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>g2</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>g1</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>g2</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_1718..1723"><span>assms</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.zero_in_bigo|fact"><span>zero_in_bigo</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_sum|fact"><span>landau_sum</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2061..2066">lemma</span></span></span><span> </span><span class="entity_def" id="Landau_Ext.landau_sum_2|fact"><span class="entity_def" id="Landau_Ext.landau_sum_2|thm"><span>landau_sum_2</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>g1</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>real</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>g2</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g2</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>g1</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>g2</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>g1</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>g2</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_2061..2066"><span>assms</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.zero_in_bigo|fact"><span>zero_in_bigo</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_sum|fact"><span>landau_sum</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2404..2409">lemma</span></span></span><span> </span><span class="entity_def" id="Landau_Ext.landau_ln_3|fact"><span class="entity_def" id="Landau_Ext.landau_ln_3|thm"><span>landau_ln_3</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>::</span></span><span>real</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span> 
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>Â¦</span></span><span>ln</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>real</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>ln_bound</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>f</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><span>eventually_mono</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_2404..2409"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_2404..2409"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_trans|fact"><span>landau_o.big_trans</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2780..2785">lemma</span></span></span><span> </span><span class="entity_def" id="Landau_Ext.landau_ln_2|fact"><span class="entity_def" id="Landau_Ext.landau_ln_2|thm"><span>landau_ln_2</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>::</span></span><span>real</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span> 
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>c</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_3002..3003">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_3017..3018">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_2780..2785"><span>assms</span></a><span class="main"><span>(</span></span><span>4</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo_def|fact"><span>bigo_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_3118..3124">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>d</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>d</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span>max</span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="skolem"><span>c</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>ln</span><span> </span><span class="free"><span>a</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>d</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>d</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>eventually_mono</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>eventually_conj</span><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_3017..3018"><span>b</span></a><span> </span><span>eventually_conj</span><span class="main"><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_2780..2785"><span>assms</span></a><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span></span></span><span>3</span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>,</span></span></span></span></span></span><span>2</span><span class="main"><span class="main"><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span></span></span><span class="main"><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span></span><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_3340..3341">c</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¦</span></span><span class="free"><span>f</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>g</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>abs_of_nonneg</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><span>ln_ge_zero</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_3340..3341"><span>c</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_3340..3341"><span>c</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_2780..2785"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span>  </span><span>mult_pos_pos</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_3002..3003"><span>a</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>      
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ln</span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_3340..3341"><span>c</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_2780..2785"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>ln_mult</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_3002..3003"><span>a</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>d</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span>ln</span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_2780..2785"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_3340..3341"><span>c</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><span>iffD2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>ln_le_cancel_iff</span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Landau_Ext.html#offset_3118..3124"><span>d_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>d</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_2780..2785"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_3340..3341"><span>c</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><span>mult_left_mono</span><span> </span><span>iffD2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>ln_le_cancel_iff</span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Landau_Ext.html#offset_3118..3124"><span>d_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>d</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>d</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_3340..3341"><span>c</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_2780..2785"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>d</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>F</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>d</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>Â¦</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>d</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_3118..3124"><span>d_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_2780..2785"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_pos_nonneg</span><span> </span><span>divide_nonneg_pos</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo_def|fact"><span>bigo_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4421..4426">lemma</span></span></span><span> </span><span class="entity_def" id="Landau_Ext.landau_real_nat|fact"><span class="entity_def" id="Landau_Ext.landau_real_nat|thm"><span>landau_real_nat</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>int</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>of_int</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>c</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_4577..4578">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_4592..4593">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>eventually</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>of_int</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>F</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_4421..4426"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo_def|fact"><span>bigo_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>F</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>Â¦</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>eventually_mono</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_4592..4593"><span>b</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>  </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_4577..4578"><span>a</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo_def|fact"><span>bigo_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4849..4854">lemma</span></span></span><span> </span><span class="entity_def" id="Landau_Ext.landau_ceil|fact"><span class="entity_def" id="Landau_Ext.landau_ceil|thm"><span>landau_ceil</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>â</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>â</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><span>always_eventually</span><span> </span><span>allI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>abs</span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_4849..4854"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_4849..4854"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5246..5251">lemma</span></span></span><span> </span><span class="entity_def" id="Landau_Ext.landau_rat_ceil|fact"><span class="entity_def" id="Landau_Ext.landau_rat_ceil|thm"><span>landau_rat_ceil</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>â</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_5407..5408">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¦</span></span><span>real_of_int</span><span> </span><span class="main"><span>â</span></span><span class="skolem"><span>x</span></span><span class="main"><span>â</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>Â¦</span></span><span class="skolem"><span>x</span></span><span class="main"><span>Â¦</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>rat</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span>  </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>  </span><span>add.commute</span><span>  </span><span>of_int_ceiling_le_add_one</span><span> </span><span>of_rat_ceiling</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_5620..5625">False</span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real_of_rat</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real_of_rat</span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>â</span></span><span class="skolem"><span>x</span></span><span class="main"><span>â</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>ceiling_correct</span><span> </span><span>of_rat_ceiling</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>â</span></span><span class="skolem"><span>x</span></span><span class="main"><span>â</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>-</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>â</span></span><span class="skolem"><span>x</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>of_rat_minus</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_5620..5625"><span>False</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>â</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_5407..5408"><span>a</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><span>always_eventually</span><span> </span><span>allI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_5246..5251"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_5246..5251"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big.abs_in_iff|fact"><span>landau_o.big.abs_in_iff</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6307..6312">lemma</span></span></span><span> </span><span class="entity_def" id="Landau_Ext.landau_nat_ceil|fact"><span class="entity_def" id="Landau_Ext.landau_nat_ceil|thm"><span>landau_nat_ceil</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="free"><span>F'</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="free"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_6307..6312"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_real_nat|fact"><span>landau_real_nat</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ceil|fact"><span>landau_ceil</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6492..6497">lemma</span></span></span><span> </span><span class="entity_def" id="Landau_Ext.eventually_prod1&apos;|fact"><span class="entity_def" id="Landau_Ext.eventually_prod1&apos;|thm"><span>eventually_prod1'</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>B</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span>bot</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="keyword1"><span>Ã<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="keyword1"><span>Ã<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="keyword1"><span>Ã<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>case_prod_beta'</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>eventually_prod1</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_6492..6497"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_6492..6497"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6859..6864">lemma</span></span></span><span> </span><span class="entity_def" id="Landau_Ext.eventually_prod2&apos;|fact"><span class="entity_def" id="Landau_Ext.eventually_prod2&apos;|thm"><span>eventually_prod2'</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span>bot</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="keyword1"><span>Ã<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="keyword1"><span>Ã<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="keyword1"><span>Ã<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>case_prod_beta'</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>B</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>eventually_prod2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_6859..6864"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_6859..6864"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Landau_Ext.sequentially_inf|fact"><span class="entity_def" id="Landau_Ext.sequentially_inf|thm"><span>sequentially_inf</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span>sequentially</span><span class="main"><span>.</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><span>eventually_at_top_linorder</span><span> </span><span>nat_ceiling_le_eq</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>instantiation</span></span></span><span> </span><span>rat</span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>linorder_topology</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Landau_Ext.open_rat_def|fact"><span class="entity_def" id="Landau_Ext.open_rat_inst.open_rat|fact"><span class="entity_def" id="Landau_Ext.open_rat_def|thm"><span class="entity_def" id="Landau_Ext.open_rat_inst.open_rat|thm"><span class="entity_def" id="Landau_Ext.open_rat_def_raw|axiom"><span class="entity_def" id="Landau_Ext.open_rat_inst.open_rat_def|axiom"><span class="entity_def" id="Landau_Ext.open_rat_inst.open_rat|const"><span class="entity_def" id="offset_7391..7401">definition</span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="class_parameter"><span>open_rat</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>rat</span><span> </span><span>set</span><span> </span><span class="main"><span>â</span></span><span> </span><span>bool</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>open_rat</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>generate_topology</span><span> </span><span class="main"><span>(</span></span><span>range</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>âª</span></span><span> </span><span>range</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>&lt;..}</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Landau_Ext.arity_linorder_topology_rat|fact"><span class="entity_def" id="Landau_Ext.arity_linorder_topology_rat|thm"><span>instance</span></span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>standard</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_7391..7401"><span>open_rat_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Landau_Ext.inv_at_right_0_inf|fact"><span class="entity_def" id="Landau_Ext.inv_at_right_0_inf|thm"><span>inv_at_right_0_inf</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span>at_right</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7651..7652">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_7681..7682">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>&lt;..&lt;</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>rat_of_int</span><span> </span><span class="main"><span>(</span></span><span>max</span><span> </span><span class="main"><span>â</span></span><span class="free"><span>c</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_rat</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><span>max</span><span> </span><span class="main"><span>â</span></span><span class="free"><span>c</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_rat</span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_7681..7682"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_right_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><span>max</span><span> </span><span class="main"><span>â</span></span><span class="free"><span>c</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>  </span><span class="main"><span>*</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span>rat_of_int</span><span>  </span><span class="main"><span>(</span></span><span>max</span><span> </span><span class="main"><span>â</span></span><span class="free"><span>c</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_7681..7682"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_strict_left_mono</span><span> </span><span>iffD2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>of_rat_less</span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>of_rat_divide</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_rat</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>real_of_rat</span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_7681..7682"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>pos_le_divide_eq</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#offset_7651..7652"><span>a</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>eventually_at_rightI</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> b</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span class="main"><span class="main"><span class="main"><span>/</span></span></span></span><span>rat_of_int</span><span> </span><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>max</span><span> </span><span class="main"><span class="main"><span class="main"><span>â</span></span></span></span><span class="free"><span class="free"><span class="free"><span>c</span></span></span></span><span class="main"><span class="main"><span class="main"><span>â</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span></pre></div><div id='Frequency_Moment_k'><body>
<div class="head">
<h1>Theory Probability_Ext</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Probability Spaces</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Some additional results about probability spaces in addition to "HOL-Probability".</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Probability_Ext</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span>
    </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Probability/Stream_Space.html"><span>HOL-Probability.Stream_Space</span></a><span>"</span></span><span>
    </span><a href="../Universal_Hash_Families/Carter_Wegman_Hash_Family.html"><span>Universal_Hash_Families.Carter_Wegman_Hash_Family</span></a><span>
    </span><a href="Frequency_Moments_Preliminary_Results.html"><span>Frequency_Moments_Preliminary_Results</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Random variables that depend on disjoint sets of the components of a product space are
</span><span>independent.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_401..406">lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.make_ext|fact"><span class="entity_def" id="Probability_Ext.make_ext|thm"><span>make_ext</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><span>(</span></span><span>restrict</span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>Pi</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>PiE</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_401..406"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>PiE_def</span><span> </span><span>Pi_def</span><span> </span><span>set_eq_iff</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>force</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_571..576">lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.PiE_reindex|fact"><span class="entity_def" id="Probability_Ext.PiE_reindex|thm"><span>PiE_reindex</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>PiE</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><span>restrict</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span>PiE</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="var"><span>?g</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="var"><span>?g</span></span><span class="main"><span>`</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>subsetI</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_781..782">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>Pi<span class="hidden">â©</span><sub>E</sub></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_823..828">y_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>if</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span>the_inv_into</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span>undefined</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_907..908">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>PiE</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_781..782"><span>a</span></a><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_571..576"><span>assms</span></a><span> </span><span>the_inv_into_f_eq</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_571..576"><span>assms</span></a><span class="main"><span>]</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_823..828"><span>y_def</span></a><span> </span><span>PiE_iff</span><span> </span><span>extensional_def</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_1038..1039">c</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><span>restrict</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_781..782"><span>a</span></a><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_571..576"><span>assms</span></a><span> </span><span>the_inv_into_f_eq</span><span> </span><span>extensional_arb</span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>ext</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Probability_Ext.html#offset_823..828"><span>y_def</span></a><span> </span><span>PiE_iff</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="var"><span>?g</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_907..908"><span>b</span></a><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_1038..1039"><span>c</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?g</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="var"><span>?rhs</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="var"><span>?lhs</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>image_subsetI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>Pi_def</span><span> </span><span>PiE_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1363..1370">context</span></span></span><span> </span><span>prob_space</span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1389..1394">lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.measure_pmf.indep_sets_reindex|fact"><span class="entity_def" id="Probability_Ext.prob_space.indep_sets_reindex|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.indep_sets_reindex|thm"><span class="entity_def" id="Probability_Ext.prob_space.indep_sets_reindex|thm"><span class="entity_def" id="offset_1395..1413">indep_sets_reindex</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>indep_sets</span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>indep_sets</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_1513..1514">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>J</span></span><span> </span><span class="bound"><span>g</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>J</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="bound"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>g</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>g</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_1389..1394"><span>assms</span></a><span> </span><span>prod.reindex_cong</span><span> </span><span>subset_inj_on</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>J</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>Î <span class="hidden">â©</span><sub>E</sub></span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><span>restrict</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span>PiE</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="skolem"><span>J</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>J</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_1389..1394"><span>assms</span></a><span> </span><span>inj_on_subset</span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#Probability_Ext.PiE_reindex|fact"><span>PiE_reindex</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>

  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_1793..1794">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>P</span></span><span> </span><span class="bound"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>J</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span>  </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>P</span></span><span> </span><span class="main"><span>(</span></span><span>restrict</span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>J</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>A'</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><span>Î <span class="hidden">â©</span><sub>E</sub></span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>P</span></span><span> </span><span class="bound"><span>A'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>A'</span></span><span class="main"><span>â</span></span><span>PiE</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="bound"><span>J</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>P</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>A'</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_1931..1932">c</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>J</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>finite</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="bound"><span>J</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>finite</span><span> </span><span class="bound"><span>J</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_1389..1394"><span>assms</span></a><span> </span><span>finite_image_iff</span><span> </span><span>inj_on_subset</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Probability_Ext.html#offset_1363..1370"><span>indep_sets_def</span></a><span> </span><span>all_subset_image</span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_1513..1514"><span>a</span></a><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_1931..1932"><span>c</span></a><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Probability_Ext.html#Probability_Ext.make_ext|fact"><span>make_ext</span></a><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_1793..1794"><span>b</span></a><span> </span><span class="quasi_keyword"><span>cong</span></span><span class="main"><span class="main"><span>:</span></span></span><span>restrict_cong</span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2148..2153">lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.measure_pmf.indep_vars_cong_AE|fact"><span class="entity_def" id="Probability_Ext.prob_space.indep_vars_cong_AE|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.indep_vars_cong_AE|thm"><span class="entity_def" id="Probability_Ext.prob_space.indep_vars_cong_AE|thm"><span>indep_vars_cong_AE</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>AE</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>Y'</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>indep_vars</span><span> </span><span class="free"><span>M'</span></span><span> </span><span class="free"><span>X'</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>random_variable</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M'</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Y'</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>indep_vars</span><span> </span><span class="free"><span>M'</span></span><span> </span><span class="free"><span>Y'</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_2367..2371">True</span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2380..2381">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>AE</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>Y'</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>AE_mp</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_2148..2153"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><span>AE_I2</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>cong</span></span><span class="main"><span class="main"><span>:</span></span></span><span>restrict_cong</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2505..2506">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>random_variable</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M'</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_2148..2153"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>indep_vars_def2</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2609..2610">c</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="keyword1"><span>AE</span></span><span> </span><span class="bound"><span>xa</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>xa</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>Y'</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>xa</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>AE_mp</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_2148..2153"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><span>AE_I2</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span>Pi<span class="hidden">â©</span><sub>M</sub></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>M'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>Y'</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span>Pi<span class="hidden">â©</span><sub>M</sub></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>M'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>distr_cong_AE</span><span> </span><span>measurable_restrict</span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_2380..2381"><span>a</span></a><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_2505..2506"><span>b</span></a><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_2148..2153"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span>Pi<span class="hidden">â©</span><sub>M</sub></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M'</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_2148..2153"><span>assms</span></a><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_2367..2371"><span>True</span></a><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_2505..2506"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>indep_vars_iff_distr_eq_PiM'</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span>Pi<span class="hidden">â©</span><sub>M</sub></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M'</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Y'</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>PiM_cong</span><span> </span><span>distr_cong_AE</span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_2609..2610"><span>c</span></a><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_2148..2153"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_2505..2506"><span>b</span></a><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span>Pi<span class="hidden">â©</span><sub>M</sub></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>M'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>Y'</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Pi<span class="hidden">â©</span><sub>M</sub></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span>distr</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M'</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Y'</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_2367..2371"><span>True</span></a><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_2148..2153"><span>assms</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>indep_vars_iff_distr_eq_PiM'</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>indep_vars_def2</span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_1363..1370"><span>indep_sets_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3398..3403">lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.measure_pmf.indep_vars_reindex|fact"><span class="entity_def" id="Probability_Ext.prob_space.indep_vars_reindex|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.indep_vars_reindex|thm"><span class="entity_def" id="Probability_Ext.prob_space.indep_vars_reindex|thm"><span class="entity_def" id="offset_3404..3422">indep_vars_reindex</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>indep_vars</span><span> </span><span class="free"><span>M'</span></span><span> </span><span class="free"><span>X'</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>indep_vars</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M'</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>X'</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_3398..3403"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>indep_vars_def2</span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_1395..1413"><span>indep_sets_reindex</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3599..3604">lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.measure_pmf.variance_divide|fact"><span class="entity_def" id="Probability_Ext.prob_space.variance_divide|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.variance_divide|thm"><span class="entity_def" id="Probability_Ext.prob_space.variance_divide|thm"><span>variance_divide</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>variance</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="free"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>variance</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="free"><span>r</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_3599..3604"><span>assms</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>Bochner_Integration.integral_divide</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_3599..3604"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>diff_divide_distrib</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>power2_eq_square</span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3880..3885">lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.measure_pmf.pmf_mono|fact"><span class="entity_def" id="Probability_Ext.prob_space.pmf_mono|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.pmf_mono|thm"><span class="entity_def" id="Probability_Ext.prob_space.pmf_mono|thm"><span class="entity_def" id="offset_3886..3894">pmf_mono</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure_pmf</span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob</span><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>prob</span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob</span><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>prob</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>P</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="main"><span>(</span></span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span>  </span><span>measure_pmf_eq</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_3880..3885"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>prob</span><span> </span><span class="free"><span>Q</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_3880..3885"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>finite_measure.finite_measure_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4228..4233">lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.measure_pmf.pmf_add|fact"><span class="entity_def" id="Probability_Ext.prob_space.pmf_add|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.pmf_add|thm"><span class="entity_def" id="Probability_Ext.prob_space.pmf_add|thm"><span class="entity_def" id="offset_4234..4241">pmf_add</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure_pmf</span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>â¨</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob</span><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>prob</span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>prob</span><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>events</span><span> </span><span class="main"><span>=</span></span><span> </span><span>UNIV</span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_4228..4233"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob</span><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>prob</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>âª</span></span><span> </span><span class="free"><span>R</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_4228..4233"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_3886..3894"><span>pmf_mono</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_4228..4233"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>prob</span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>prob</span><span> </span><span class="free"><span>R</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>measure_subadditive</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4626..4631">lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.measure_pmf.pmf_add_2|fact"><span class="entity_def" id="Probability_Ext.prob_space.pmf_add_2|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.pmf_add_2|thm"><span class="entity_def" id="Probability_Ext.prob_space.pmf_add_2|thm"><span>pmf_add_2</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure_pmf</span><span> </span><span class="free"><span>p</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>r1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>r2</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¨</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>r1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>r2</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>prob</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>Q</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_4234..4241"><span>pmf_add</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_4626..4631"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_4626..4631"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2-3</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Probability_Ext.measure_pmf.covariance_def|fact"><span class="entity_def" id="Probability_Ext.prob_space.covariance_def|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.covariance_def|thm"><span class="entity_def" id="Probability_Ext.prob_space.covariance_def|thm"><span class="entity_def" id="Probability_Ext.prob_space.covariance_def_raw|axiom"><span class="entity_def" id="offset_4990..5000">definition</span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Probability_Ext.prob_space.covariance.cong|fact"><span class="entity_def" id="Probability_Ext.prob_space.covariance.cong|thm"><span class="entity_def" id="Probability_Ext.measure_pmf.covariance|const"><span class="entity_def" id="Probability_Ext.prob_space.covariance|const"><span class="entity_def" id="offset_5001..5011">covariance</span></span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>covariance</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>g</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>expectation</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>expectation</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>g</span></span></span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>expectation</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>g</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.measure_pmf.real_prod_integrable|fact"><span class="entity_def" id="Probability_Ext.prob_space.real_prod_integrable|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.real_prod_integrable|thm"><span class="entity_def" id="Probability_Ext.prob_space.real_prod_integrable|thm"><span class="entity_def" id="offset_5111..5131">real_prod_integrable</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>measurable</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>borel_measurable</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>g</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>borel_measurable</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_5244..5250">sq_int</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><span>integrable_iff_bounded</span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â«<span class="hidden">â§</span><sup>+</sup></span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>ennreal</span><span> </span><span class="main"><span>(</span></span><span>norm</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â«<span class="hidden">â§</span><sup>+</sup></span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>ennreal</span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ennreal</span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â</span></span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>abs_mult</span><span> </span><span>ennreal_mult</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span>  </span><span class="main"><span>(</span></span><span class="main"><span>â«<span class="hidden">â§</span><sup>+</sup></span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>ennreal</span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â</span></span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â«<span class="hidden">â§</span><sup>+</sup></span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>ennreal</span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â</span></span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>Cauchy_Schwarz_nn_integral</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>â</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_5244..5250"><span>sq_int</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>integrable_iff_bounded</span><span> </span><span>ennreal_power</span><span> </span><span>ennreal_mult_less_top</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â«<span class="hidden">â§</span><sup>+</sup></span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ennreal</span><span> </span><span class="main"><span>(</span></span><span>norm</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>â</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â«<span class="hidden">â§</span><sup>+</sup></span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ennreal</span><span> </span><span class="main"><span>(</span></span><span>norm</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>â</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>power_less_top_ennreal</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5945..5950">lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.measure_pmf.covariance_eq|fact"><span class="entity_def" id="Probability_Ext.prob_space.covariance_eq|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.covariance_eq|thm"><span class="entity_def" id="Probability_Ext.prob_space.covariance_eq|thm"><span>covariance_eq</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>borel_measurable</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>g</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>borel_measurable</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Probability_Ext.html#offset_5001..5011"><span>covariance</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>expectation</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>expectation</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>expectation</span><span> </span><span class="free"><span>g</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>square_integrable_imp_integrable</span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_5945..5950"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>g</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>square_integrable_imp_integrable</span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_5945..5950"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_5945..5950"><span>assms</span></a><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_5111..5131"><span>real_prod_integrable</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Probability_Ext.html#offset_4990..5000"><span>covariance_def</span></a><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span> </span><span>prob_space</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6499..6504">lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.measure_pmf.covar_integrable|fact"><span class="entity_def" id="Probability_Ext.prob_space.covar_integrable|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.covar_integrable|thm"><span class="entity_def" id="Probability_Ext.prob_space.covar_integrable|thm"><span class="entity_def" id="offset_6505..6521">covar_integrable</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>borel_measurable</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>g</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>borel_measurable</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>expectation</span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>expectation</span><span> </span><span class="free"><span>g</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>square_integrable_imp_integrable</span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_6499..6504"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>g</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>square_integrable_imp_integrable</span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_6499..6504"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_6499..6504"><span>assms</span></a><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_5111..5131"><span>real_prod_integrable</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_7013..7018">lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.measure_pmf.sum_square_int|fact"><span class="entity_def" id="Probability_Ext.prob_space.sum_square_int|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.sum_square_int|thm"><span class="entity_def" id="Probability_Ext.prob_space.sum_square_int|thm"><span>sum_square_int</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'b</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>borel_measurable</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_7013..7018"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>Bochner_Integration.integrable_sum</span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_5111..5131"><span>real_prod_integrable</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power2_eq_square</span><span> </span><span>sum_distrib_left</span><span> </span><span>sum_distrib_right</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_7479..7484">lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.measure_pmf.var_sum_1|fact"><span class="entity_def" id="Probability_Ext.prob_space.var_sum_1|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.var_sum_1|thm"><span class="entity_def" id="Probability_Ext.prob_space.var_sum_1|thm"><span class="entity_def" id="offset_7485..7494">var_sum_1</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'b</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>borel_measurable</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span>variance</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_5001..5011"><span>covariance</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7753..7754">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>expectation</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>expectation</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_7479..7484"><span>assms</span></a><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_6505..6521"><span>covar_integrable</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>variance</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>expectation</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>expectation</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>square_integrable_imp_integrable</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_7479..7484"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>,</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>Bochner_Integration.integral_sum</span><span>  </span><span>sum_subtractf</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>expectation</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>expectation</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span>  </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>expectation</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>power2_eq_square</span><span> </span><span>sum_distrib_right</span><span> </span><span>sum_distrib_left</span><span> </span><span>mult.commute</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_5001..5011"><span>covariance</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_7753..7754"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>Bochner_Integration.integral_sum</span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_4990..5000"><span>covariance_def</span></a><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.measure_pmf.covar_self_eq|fact"><span class="entity_def" id="Probability_Ext.prob_space.covar_self_eq|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.covar_self_eq|thm"><span class="entity_def" id="Probability_Ext.prob_space.covar_self_eq|thm"><span class="entity_def" id="offset_8501..8514">covar_self_eq</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Probability_Ext.html#offset_5001..5011"><span>covariance</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>variance</span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Probability_Ext.html#offset_4990..5000"><span>covariance_def</span></a><span> </span><span>power2_eq_square</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8628..8633">lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.measure_pmf.covar_indep_eq_zero|fact"><span class="entity_def" id="Probability_Ext.prob_space.covar_indep_eq_zero|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.covar_indep_eq_zero|thm"><span class="entity_def" id="Probability_Ext.prob_space.covar_indep_eq_zero|thm"><span class="entity_def" id="offset_8634..8653">covar_indep_eq_zero</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="free"><span>g</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>indep_var</span><span> </span><span>borel</span><span> </span><span class="free"><span>f</span></span><span> </span><span>borel</span><span> </span><span class="free"><span>g</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Probability_Ext.html#offset_5001..5011"><span>covariance</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8818..8819">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>indep_var</span><span> </span><span>borel</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>t</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>expectation</span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span>borel</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>t</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>expectation</span><span> </span><span class="free"><span>g</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>g</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>indep_var_compose</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_8628..8633"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>expectation</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>expectation</span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>expectation</span><span> </span><span class="free"><span>g</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_8818..8819"><span>a</span></a><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_8628..8633"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>indep_var_lebesgue_integral</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>comp_def</span><span> </span><span>prob_space</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Probability_Ext.html#offset_4990..5000"><span>covariance_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9178..9183">lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.measure_pmf.var_sum_2|fact"><span class="entity_def" id="Probability_Ext.prob_space.var_sum_2|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.var_sum_2|thm"><span class="entity_def" id="Probability_Ext.prob_space.var_sum_2|thm"><span class="entity_def" id="offset_9184..9193">var_sum_2</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'b</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>borel_measurable</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>variance</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
      </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span>variance</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_5001..5011"><span>covariance</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>variance</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_5001..5011"><span>covariance</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_7485..7494"><span>var_sum_1</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_9178..9183"><span>assms</span></a><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>1</span><span class="main"><span class="main"><span class="main"><span>,</span></span></span></span><span>2</span><span class="main"><span class="main"><span class="main"><span>,</span></span></span></span><span>3</span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_5001..5011"><span>covariance</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>-</span></span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_5001..5011"><span>covariance</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_9178..9183"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>sum.insert</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>insert_absorb</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span>variance</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>  </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>â</span></span><span class="free"><span>I</span></span><span class="main"><span>-</span></span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_5001..5011"><span>covariance</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_8501..8514"><span>covar_self_eq</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>sum.distrib</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9952..9957">lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.measure_pmf.var_sum_pairwise_indep|fact"><span class="entity_def" id="Probability_Ext.prob_space.var_sum_pairwise_indep|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.var_sum_pairwise_indep|thm"><span class="entity_def" id="Probability_Ext.prob_space.var_sum_pairwise_indep|thm"><span class="entity_def" id="offset_9958..9980">var_sum_pairwise_indep</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'b</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>borel_measurable</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>indep_var</span><span> </span><span>borel</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span>borel</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>variance</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span>variance</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_5001..5011"><span>covariance</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_8634..8653"><span>covar_indep_eq_zero</span></a><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_9952..9957"><span>assms</span></a><span class="main"><span>(</span></span><span>4</span><span class="main"><span>)</span></span><span> </span><span>square_integrable_imp_integrable</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_9952..9957"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>,</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span>a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_5001..5011"><span>covariance</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_9184..9193"><span>var_sum_2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_9952..9957"><span>assms</span></a><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>1</span><span class="main"><span class="main"><span class="main"><span>,</span></span></span></span><span>2</span><span class="main"><span class="main"><span class="main"><span>,</span></span></span></span><span>3</span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_10582..10587">lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.measure_pmf.indep_var_from_indep_vars|fact"><span class="entity_def" id="Probability_Ext.prob_space.indep_var_from_indep_vars|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.indep_var_from_indep_vars|thm"><span class="entity_def" id="Probability_Ext.prob_space.indep_var_from_indep_vars|thm"><span class="entity_def" id="offset_10588..10613">indep_var_from_indep_vars</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="free"><span>j</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>indep_vars</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>M'</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>indep_var</span><span> </span><span class="free"><span>M'</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>M'</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10728..10729">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>inj</span><span> </span><span class="main"><span>(</span></span><span>case_bool</span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_10582..10587"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>bool.case_eq_if</span><span> </span><span>inj_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10818..10819">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>range</span><span> </span><span class="main"><span>(</span></span><span>case_bool</span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>i</span></span><span class="main"><span>,</span></span><span class="free"><span>j</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>UNIV_bool</span><span> </span><span>insert_commute</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10904..10905">c</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>indep_vars</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>M'</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>range</span><span> </span><span class="main"><span>(</span></span><span>case_bool</span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_10582..10587"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_10818..10819"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>True</span><span> </span><span class="main"><span>=</span></span><span> </span><span>indep_vars</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>M'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>case_bool</span><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span>UNIV</span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_3404..3422"><span>indep_vars_reindex</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_10728..10729"><span>a</span></a><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_10904..10905"><span>c</span></a><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>comp_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>indep_vars</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>case_bool</span><span> </span><span class="free"><span>M'</span></span><span> </span><span class="free"><span>M'</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>case_bool</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="free"><span>j</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span>UNIV</span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>indep_vars_cong</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span>bool.case_distrib</span><span> </span><span>bool.case_eq_if</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="var"><span>?thesis</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_1363..1370"><span>indep_var_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11374..11379">lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.measure_pmf.var_sum_pairwise_indep_2|fact"><span class="entity_def" id="Probability_Ext.prob_space.var_sum_pairwise_indep_2|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.var_sum_pairwise_indep_2|thm"><span class="entity_def" id="Probability_Ext.prob_space.var_sum_pairwise_indep_2|thm"><span class="entity_def" id="offset_11380..11404">var_sum_pairwise_indep_2</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'b</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>borel_measurable</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>J</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>card</span><span> </span><span class="bound"><span>J</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>indep_vars</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span> </span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>borel</span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>J</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>variance</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span>variance</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_11374..11379"><span>assms</span></a><span class="main"><span>(</span></span><span>4</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_9958..9980"><span>var_sum_pairwise_indep</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_11374..11379"><span>assms</span></a><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>1</span><span class="main"><span class="main"><span class="main"><span>,</span></span></span></span><span>2</span><span class="main"><span class="main"><span class="main"><span>,</span></span></span></span><span>3</span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_10588..10613"><span>indep_var_from_indep_vars</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_11793..11798">lemma</span></span></span><span> </span><span class="entity_def" id="Probability_Ext.measure_pmf.var_sum_all_indep|fact"><span class="entity_def" id="Probability_Ext.prob_space.var_sum_all_indep|fact"><span class="entity_def" id="Probability_Ext.measure_pmf.var_sum_all_indep|thm"><span class="entity_def" id="Probability_Ext.prob_space.var_sum_all_indep|thm"><span>var_sum_all_indep</span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'b</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>borel_measurable</span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>integrable</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>indep_vars</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span> </span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>borel</span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>variance</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span>variance</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_11380..11404"><span>var_sum_pairwise_indep_2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_11793..11798"><span>assms</span></a><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>1</span><span class="main"><span class="main"><span class="main"><span>,</span></span></span></span><span>2</span><span class="main"><span class="main"><span class="main"><span>,</span></span></span></span><span>3</span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>indep_vars_subset</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#offset_11793..11798"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>  </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre></div><div id='Frequency_Moment_k'><body>
<div class="head">
<h1>Theory Product_PMF_Ext</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Indexed Products of Probability Mass Functions</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Product_PMF_Ext</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="../../HOL/HOL/Main.html"><span>Main</span></a><span> </span><a href="Probability_Ext.html"><span>Probability_Ext</span></a><span> </span><span class="quoted"><span>"</span><a href="../../HOL/HOL-Probability/Product_PMF.html"><span>HOL-Probability.Product_PMF</span></a><span>"</span></span><span> </span><a href="../Universal_Hash_Families/Preliminary_Results.html"><span>Universal_Hash_Families.Preliminary_Results</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>This section introduces a restricted version of </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span>Pi_pmf</span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> where the default value is </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><span>undefined</span><span>"</span></span><span class="antiquote"><span>}</span></span></span><span>
</span><span>and contains some additional results about that case in addition to </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>theory</span></span><span> "</span><a href="../../HOL/HOL-Probability/Product_PMF.html"><span>HOL-Probability.Product_PMF</span></a><span>"</span><span class="antiquote"><span>}</span></span></span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="entity"><span class="entity_def" id="Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>prod_pmf</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>M</span></span></span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span>Pi_pmf</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>I</span></span></span></span><span> </span><span>undefined</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>M</span></span></span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_489..494">lemma</span></span></span><span> </span><span class="entity_def" id="Product_PMF_Ext.pmf_prod_pmf|fact"><span class="entity_def" id="Product_PMF_Ext.pmf_prod_pmf|thm"><span>pmf_prod_pmf</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>extensional</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span>pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>  </span><span>pmf_Pi</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_489..494"><span>assms</span></a><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>1</span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>extensional_def</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Product_PMF_Ext.PiE_defaut_undefined_eq|fact"><span class="entity_def" id="Product_PMF_Ext.PiE_defaut_undefined_eq|thm"><span>PiE_defaut_undefined_eq</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>PiE_dflt</span><span> </span><span class="free"><span>I</span></span><span> </span><span>undefined</span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>PiE</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>PiE_dflt_def</span><span> </span><span>PiE_def</span><span> </span><span>extensional_def</span><span> </span><span>Pi_def</span><span> </span><span>set_eq_iff</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>blast</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_825..830">lemma</span></span></span><span> </span><span class="entity_def" id="Product_PMF_Ext.set_prod_pmf|fact"><span class="entity_def" id="Product_PMF_Ext.set_prod_pmf|thm"><span>set_prod_pmf</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>set_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>PiE</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>(</span></span><span>set_pmf</span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>set_Pi_pmf</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_825..830"><span>assms</span></a><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.PiE_defaut_undefined_eq|fact"><span>PiE_defaut_undefined_eq</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>A more general version of </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> [</span><span>source</span><span>] "</span><span>measure_Pi_pmf_Pi</span><span>"</span><span class="antiquote"><span>}</span></span></span><span>.</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1053..1058">lemma</span></span></span><span> </span><span class="entity_def" id="Product_PMF_Ext.prob_prod_pmf&apos;|fact"><span class="entity_def" id="Product_PMF_Ext.prob_prod_pmf&apos;|thm"><span>prob_prod_pmf'</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>J</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>measure</span><span> </span><span class="main"><span>(</span></span><span>measure_pmf</span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>Pi</span><span> </span><span class="free"><span>J</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>J</span></span><span class="main"><span>.</span></span><span> </span><span>measure</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_1219..1220">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>Pi</span><span> </span><span class="free"><span>J</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Pi</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>if</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>J</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span>UNIV</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_1053..1058"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>Pi_def</span><span> </span><span>set_eq_iff</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_1053..1058"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>if_distrib</span><span>  </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_1219..1220"><span>a</span></a><span> </span><span>measure_Pi_pmf_Pi</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_1053..1058"><span>assms</span></a><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>1</span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>prod.If_cases</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_1053..1058"><span>assms</span></a><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>1</span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>Int_absorb1</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1464..1469">lemma</span></span></span><span> </span><span class="entity_def" id="Product_PMF_Ext.prob_prod_pmf_slice|fact"><span class="entity_def" id="Product_PMF_Ext.prob_prod_pmf_slice|thm"><span>prob_prod_pmf_slice</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>measure</span><span> </span><span class="main"><span>(</span></span><span>measure_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>P</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prob_prod_pmf&apos;|fact"><span>prob_prod_pmf'</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_1464..1469"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>,</span></span><span> </span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> J</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{</span></span><span class="free"><span>i</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> M</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> A</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>Collect</span><span> </span><span class="free"><span>P</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Product_PMF_Ext.html#offset_1464..1469"><span>assms</span></a><span> </span><span>Pi_def</span><span class="main"><span>)</span></span><span>


</span><span class="keyword1"><span class="command"><span class="entity_def" id="Product_PMF_Ext.restrict_dfl_def|fact"><span class="entity_def" id="Product_PMF_Ext.restrict_dfl_def|thm"><span class="entity_def" id="Product_PMF_Ext.restrict_dfl_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Product_PMF_Ext.restrict_dfl|const"><span>restrict_dfl</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>restrict_dfl</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>A</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>if</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>A</span></span></span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>f</span></span></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>d</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1814..1819">lemma</span></span></span><span> </span><span class="entity_def" id="Product_PMF_Ext.pi_pmf_decompose|fact"><span class="entity_def" id="Product_PMF_Ext.pi_pmf_decompose|thm"><span>pi_pmf_decompose</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl|const"><span>restrict_dfl</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span>Pi_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>j</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2003..2010">fin_F_I</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_1814..1819"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="var"><span>?thesis</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_2003..2010"><span>fin_F_I</span></a><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>I</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span>finite_induct</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>empty</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl_def|fact"><span>restrict_dfl_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_2239..2245">insert</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>F</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2260..2261">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="skolem"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>âª</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="skolem"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>I</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_2239..2245"><span>insert</span></a><span class="main"><span>(</span></span><span>4</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2339..2340">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>F</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span>  </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="skolem"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_2239..2245"><span>insert</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>,</span></span><span>4</span><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>set_eq_iff</span><span> </span><span>image_def</span><span> </span><span>vimage_def</span><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2453..2454">c</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="skolem"><span>I</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_2239..2245"><span>insert</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2509..2510">d</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>j</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="skolem"><span>I</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>j</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="skolem"><span>I</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_2239..2245"><span>insert</span></a><span class="main"><span>(</span></span><span>4</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span> 

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span>Pi_pmf</span><span> </span><span class="skolem"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Pi_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="skolem"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>âª</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="skolem"><span>I</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Product_PMF_Ext.html#offset_2260..2261"><span>a</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>g</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>h</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>if</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="skolem"><span>I</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="bound"><span>g</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="bound"><span>h</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><span>(</span></span><span>pair_pmf</span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="skolem"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="skolem"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_2239..2245"><span>insert</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>Pi_pmf_union</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>g</span></span><span class="main"><span>,</span></span><span class="bound"><span>h</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>if</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>I</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="bound"><span>g</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="keyword1"><span>if</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>I</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="bound"><span>h</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>(</span></span><span>pair_pmf</span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="skolem"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span>Pi_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>j</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="skolem"><span>I</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Product_PMF_Ext.html#offset_2239..2245"><span>insert</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_2339..2340"><span>b</span></a><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_2453..2454"><span>c</span></a><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>map_pmf_comp</span><span> </span><span>case_prod_beta'</span><span> </span><span>apsnd_def</span><span> </span><span>map_prod_def</span><span> 
          </span><span>pair_map_pmf2</span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_2339..2340"><span>b</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl_def|fact"><span>restrict_dfl_def</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>fst_conv</span><span> </span><span>snd_conv</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>g</span></span><span class="main"><span>,</span></span><span class="bound"><span>h</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>if</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>I</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>h</span></span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>:=</span></span><span> </span><span class="bound"><span>g</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><span>(</span></span><span>pair_pmf</span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="skolem"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="skolem"><span>F</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span>Pi_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>j</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="skolem"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_2239..2245"><span>insert</span></a><span class="main"><span>(</span></span><span>4</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_2509..2510"><span>d</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>arg_cong2</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>map_pmf</span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>ext</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>case_prod_beta'</span><span> </span><span class="quasi_keyword"><span>cong</span></span><span class="main"><span class="main"><span>:</span></span></span><span>Pi_pmf_cong</span><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>if</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>I</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="main"><span>(</span></span><span>insert</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>F</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>j</span></span><span class="main"><span>.</span></span><span> </span><span>Pi_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>j</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="skolem"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>Pi_pmf_insert</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_2239..2245"><span>insert</span></a><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>1</span><span class="main"><span class="main"><span class="main"><span>,</span></span></span></span><span>2</span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>map_pmf_comp</span><span> </span><span>case_prod_beta'</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Product_PMF_Ext.html#offset_2239..2245"><span>insert</span></a><span class="main"><span class="main"><span>(</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl_def|fact"><span>restrict_dfl_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_1814..1819"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Product_PMF_Ext.restrict_dfl_iter|fact"><span class="entity_def" id="Product_PMF_Ext.restrict_dfl_iter|thm"><span>restrict_dfl_iter</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl|const"><span>restrict_dfl</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl|const"><span>restrict_dfl</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>J</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl|const"><span>restrict_dfl</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="free"><span>J</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>d</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>ext</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl_def|fact"><span>restrict_dfl_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_4051..4056">lemma</span></span></span><span> </span><span class="entity_def" id="Product_PMF_Ext.indep_vars_restrict&apos;|fact"><span class="entity_def" id="Product_PMF_Ext.indep_vars_restrict&apos;|thm"><span>indep_vars_restrict'</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob_space.indep_vars</span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl|const"><span>restrict_dfl</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?Q</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span>Pi_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_4295..4296">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>prob_space.indep_vars</span><span> </span><span class="var"><span>?Q</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_4051..4056"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>indep_vars_Pi_pmf</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_4418..4419">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>AE</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span>measure_pmf</span><span> </span><span class="var"><span>?Q</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl|const"><span>restrict_dfl</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>d</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_4051..4056"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>PiE_dflt_def</span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl_def|fact"><span>restrict_dfl_def</span></a><span> </span><span>AE_measure_pmf_iff</span><span> </span><span>set_Pi_pmf</span><span> </span><span>comp_def</span><span> </span><span>Int_commute</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob_space.indep_vars</span><span> </span><span class="var"><span>?Q</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl|const"><span>restrict_dfl</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Probability_Ext.html#Probability_Ext.prob_space.indep_vars_cong_AE|fact"><span>prob_space.indep_vars_cong_AE</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>prob_space_measure_pmf</span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_4418..4419"><span>b</span></a><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_4295..4296"><span>a</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>  </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>prob_space_measure_pmf</span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../Universal_Hash_Families/Preliminary_Results.html#Preliminary_Results.prob_space.indep_vars_distr|fact"><span>prob_space.indep_vars_distr</span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.pi_pmf_decompose|fact"><span>pi_pmf_decompose</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_4051..4056"><span>assms</span></a><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span>  
        </span><span>map_pmf_rep_eq</span><span> </span><span>comp_def</span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl_iter|fact"><span>restrict_dfl_iter</span></a><span> </span><span>Int_commute</span><span class="main"><span>)</span></span><span> 
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5035..5040">lemma</span></span></span><span> </span><span class="entity_def" id="Product_PMF_Ext.indep_vars_restrict_intro&apos;|fact"><span class="entity_def" id="Product_PMF_Ext.indep_vars_restrict_intro&apos;|thm"><span>indep_vars_restrict_intro'</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>J</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl|const"><span>restrict_dfl</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>J</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>J</span></span><span> </span><span class="main"><span>â¹</span></span><span>  </span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>space</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M'</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob_space.indep_vars</span><span> </span><span class="main"><span>(</span></span><span>measure_pmf</span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>M'</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>J</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_5326..5332">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>M</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span>measure_pmf</span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>interpret</span></span></span><span> </span><span>prob_space</span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_5326..5332"><span>M_def</span></a><span> </span><span>prob_space_measure_pmf</span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5440..5442">by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Product_PMF_Ext.html#offset_5440..5442"><span>indep_vars</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl|const"><span>restrict_dfl</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_5326..5332"><span>M_def</span></a><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.indep_vars_restrict&apos;|fact"><span>indep_vars_restrict'</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_5035..5040"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Product_PMF_Ext.html#offset_5440..5442"><span>indep_vars</span></a><span> </span><span class="free"><span>M'</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl|const"><span>restrict_dfl</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>(</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>-`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_5035..5040"><span>assms</span></a><span class="main"><span>(</span></span><span>4</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_5440..5442"><span>indep_vars_compose2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> Y</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="free"><span class="free"><span>X'</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> N</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="free"><span class="free"><span>M'</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> M'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>Î»</span></span></span></span><span class="main"><span class="bound"><span class="main"><span class="bound"><span class="main"><span class="bound"><span>_</span></span></span></span></span></span></span><span class="main"><span class="main"><span class="main"><span>.</span></span></span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Preliminary_Results.html#Preliminary_Results.discrete|const"><a class="entity_ref" href="../Universal_Hash_Families/Preliminary_Results.html#Preliminary_Results.discrete|const"><a class="entity_ref" href="../Universal_Hash_Families/Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a></a></a><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>  </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Product_PMF_Ext.html#offset_5035..5040"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Product_PMF_Ext.html#offset_5440..5442"><span>indep_vars</span></a><span> </span><span class="free"><span>M'</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>X'</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_5035..5040"><span>assms</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Product_PMF_Ext.html#offset_5035..5040"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span class="quasi_keyword"><span>cong</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Product_PMF_Ext.html#offset_5440..5442"><span>indep_vars_cong</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_5326..5332"><span>M_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_5035..5040"><span>assms</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> 
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5990..5995">lemma</span></span></span><span>  
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'b</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'c</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="main"><span>{</span></span><span>second_countable_topology</span><span class="main"><span>,</span></span><span>banach</span><span class="main"><span>,</span></span><span>real_normed_field</span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="main"><span>(</span></span><span>measure_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>  </span><span class="entity_def" id="Product_PMF_Ext.integrable_Pi_pmf_slice|fact"><span class="entity_def" id="Product_PMF_Ext.integrable_Pi_pmf_slice|thm"><span>integrable_Pi_pmf_slice</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Product_PMF_Ext.expectation_Pi_pmf_slice|fact"><span class="entity_def" id="Product_PMF_Ext.expectation_Pi_pmf_slice|thm"><span>expectation_Pi_pmf_slice</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>integral<span class="hidden">â§</span><sup>L</sup></span></span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>integral<span class="hidden">â§</span><sup>L</sup></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6349..6350">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>distr</span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>distr</span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>distr_cong</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6471..6472">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>measure_pmf.random_variable</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span>borel</span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_5990..5995"><span>assms</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6553..6554">c</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="main"><span>(</span></span><span>distr</span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_5990..5995"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>,</span></span><span>2</span><span class="main"><span>,</span></span><span>3</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_6349..6350"><span>a</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><span>map_pmf_rep_eq</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><span>Pi_pmf_component</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>integrable_distr</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="free"><span class="free"><span>f</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> M'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="free"><span class="free"><span>M</span></span></span></span><span> </span><span class="free"><span class="free"><span class="free"><span>i</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>  </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_6553..6554"><span>c</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>integral<span class="hidden">â§</span><sup>L</sup></span></span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>integral<span class="hidden">â§</span><sup>L</sup></span></span><span> </span><span class="main"><span>(</span></span><span>distr</span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_6471..6472"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>integral_distr</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span class="keyword1"><span>integral<span class="hidden">â§</span><sup>L</sup></span></span><span> </span><span class="main"><span>(</span></span><span>map_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_6349..6350"><span>a</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><span>map_pmf_rep_eq</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span class="keyword1"><span>integral<span class="hidden">â§</span><sup>L</sup></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_5990..5995"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>,</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>Pi_pmf_component</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>integral<span class="hidden">â§</span><sup>L</sup></span></span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>integral<span class="hidden">â§</span><sup>L</sup></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>This is an improved version of </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> [</span><span>source</span><span>] "</span><span>expectation_prod_Pi_pmf</span><span>"</span><span class="antiquote"><span>}</span></span></span><span>.
</span><span>It works for general normed fields instead of non-negative real functions .</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_7463..7468">lemma</span></span></span><span> </span><span class="entity_def" id="Product_PMF_Ext.expectation_prod_Pi_pmf|fact"><span class="entity_def" id="Product_PMF_Ext.expectation_prod_Pi_pmf|thm"><span>expectation_prod_Pi_pmf</span></span></span><span class="main"><span>:</span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="tfree"><span>'b</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'c</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="main"><span>{</span></span><span>second_countable_topology</span><span class="main"><span>,</span></span><span>banach</span><span class="main"><span>,</span></span><span>real_normed_field</span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>integrable</span><span> </span><span class="main"><span>(</span></span><span>measure_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>   </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>integral<span class="hidden">â§</span><sup>L</sup></span></span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>integral<span class="hidden">â§</span><sup>L</sup></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7778..7779">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob_space.indep_vars</span><span> </span><span class="main"><span>(</span></span><span>measure_pmf</span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>borel</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>prob_space.indep_vars_compose2</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> Y</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="free"><span class="free"><span>f</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> M'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>Î»</span></span></span></span><span class="main"><span class="bound"><span class="main"><span class="bound"><span class="main"><span class="bound"><span>_</span></span></span></span></span></span></span><span class="main"><span class="main"><span class="main"><span>.</span></span></span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Preliminary_Results.html#Preliminary_Results.discrete|const"><a class="entity_ref" href="../Universal_Hash_Families/Preliminary_Results.html#Preliminary_Results.discrete|const"><a class="entity_ref" href="../Universal_Hash_Families/Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a></a></a><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> 
        </span><span>prob_space_measure_pmf</span><span> </span><span>indep_vars_Pi_pmf</span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_7463..7468"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>integral<span class="hidden">â§</span><sup>L</sup></span></span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>integral<span class="hidden">â§</span><sup>L</sup></span></span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>prob_space.indep_vars_lebesgue_integral</span><span> </span><span>prob_space_measure_pmf</span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_7463..7468"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>,</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> 
        </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_7778..7779"><span>a</span></a><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.integrable_Pi_pmf_slice|fact"><span>integrable_Pi_pmf_slice</span></a><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>integral<span class="hidden">â§</span><sup>L</sup></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>prod.cong</span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.expectation_Pi_pmf_slice|fact"><span>expectation_Pi_pmf_slice</span></a><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_7463..7468"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>,</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8412..8417">lemma</span></span></span><span> </span><span class="entity_def" id="Product_PMF_Ext.variance_prod_pmf_slice|fact"><span class="entity_def" id="Product_PMF_Ext.variance_prod_pmf_slice|thm"><span>variance_prod_pmf_slice</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="main"><span>(</span></span><span>measure_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob_space.variance</span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>prob_space.variance</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8656..8657">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><span class="main"><span>(</span></span><span>measure_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_8412..8417"><span>assms</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span> </span><span>measure_pmf.square_integrable_imp_integrable</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8772..8773">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span>integrable</span><span> </span><span class="main"><span>(</span></span><span>measure_pmf</span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.integrable_Pi_pmf_slice|fact"><span>integrable_Pi_pmf_slice</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_8412..8417"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_8412..8417"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_8412..8417"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8918..8919">c</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span>integrable</span><span> </span><span class="main"><span>(</span></span><span>measure_pmf</span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.integrable_Pi_pmf_slice|fact"><span>integrable_Pi_pmf_slice</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_8412..8417"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_8412..8417"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_8656..8657"><span>a</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>measure_pmf.expectation</span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span>measure_pmf.expectation</span><span> </span><span class="main"><span>(</span></span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span>measure_pmf.expectation</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span>measure_pmf.expectation</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>M</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>f</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_8412..8417"><span>assms</span></a><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_8656..8657"><span>a</span></a><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_8772..8773"><span>b</span></a><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_8918..8919"><span>c</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.expectation_Pi_pmf_slice|fact"><span>expectation_Pi_pmf_slice</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_8412..8417"><span>assms</span></a><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>2</span><span class="main"><span class="main"><span class="main"><span>,</span></span></span></span><span>1</span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>?</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>

  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_8412..8417"><span>assms</span></a><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_8656..8657"><span>a</span></a><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_8772..8773"><span>b</span></a><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_8918..8919"><span>c</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>measure_pmf.variance_eq</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_9429..9434">lemma</span></span></span><span> </span><span class="entity_def" id="Product_PMF_Ext.Pi_pmf_bind_return|fact"><span class="entity_def" id="Product_PMF_Ext.Pi_pmf_bind_return|thm"><span>Pi_pmf_bind_return</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>I</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Pi_pmf</span><span> </span><span class="free"><span>I</span></span><span> </span><span class="free"><span>d'</span></span><span> </span><span class="free"><span>M</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><span>if</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>I</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="free"><span>d</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#offset_9429..9434"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>Pi_pmf_bind</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> d'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>d'</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre></div><div id='Frequency_Moment_k'>


<body>
<div class="head">
<h1>Theory Frequency_Moment_0</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Frequency Moment $0$\label{sec:f0}</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Frequency_Moment_0</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span>
    </span><a href="Frequency_Moments_Preliminary_Results.html"><span>Frequency_Moments_Preliminary_Results</span></a><span>
    </span><a href="../Median_Method/Median.html"><span>Median_Method.Median</span></a><span> 
    </span><a href="K_Smallest.html"><span>K_Smallest</span></a><span> 
    </span><a href="../Universal_Hash_Families/Carter_Wegman_Hash_Family.html"><span>Universal_Hash_Families.Carter_Wegman_Hash_Family</span></a><span>
    </span><a href="Frequency_Moments.html"><span>Frequency_Moments</span></a><span>
    </span><a href="Landau_Ext.html"><span>Landau_Ext</span></a><span> 
    </span><a href="Product_PMF_Ext.html"><span>Product_PMF_Ext</span></a><span>
    </span><a href="../Universal_Hash_Families/Field.html"><span>Universal_Hash_Families.Field</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>This section contains a formalization of a new algorithm for the zero-th frequency moment
</span><span>inspired by ideas described in \cite{baryossed2002}.
</span><span>It is a KMV-type ($k$-minimum value) algorithm with a rounding method and matches the space complexity 
</span><span>of the best algorithm described in \cite{baryossef2002}.
</span><span>
</span><span>In addition to the Isabelle proof here, there is also an informal hand-written proof in
</span><span>Appendix~\ref{sec:f0_proof}.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>type_synonym</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.f0_state|type"><span>f0_state</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span>list</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float|type"><span>float</span></a><span> </span><span>set</span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_0.hash_def|fact"><span class="entity_def" id="Frequency_Moment_0.hash_def|thm"><span class="entity_def" id="Frequency_Moment_0.hash_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_0.hash|const"><span>hash</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>hash</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.ring.hash|const"><span>ring.hash</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_0.f0_init.elims|fact"><span class="entity_def" id="Frequency_Moment_0.f0_init.induct|fact"><span class="entity_def" id="Frequency_Moment_0.f0_init.simps|fact"><span class="entity_def" id="Frequency_Moment_0.f0_init.pelims|fact"><span class="entity_def" id="Frequency_Moment_0.f0_init.cases|fact"><span class="entity_def" id="Frequency_Moment_0.f0_init.termination|fact"><span class="entity_def" id="Frequency_Moment_0.f0_init.pinduct|fact"><span class="entity_def" id="Frequency_Moment_0.f0_init.psimps|fact"><span class="entity_def" id="Frequency_Moment_0.f0_init_rel.inducts|fact"><span class="entity_def" id="Frequency_Moment_0.f0_init_rel.simps|fact"><span class="entity_def" id="Frequency_Moment_0.f0_init_rel.induct|fact"><span class="entity_def" id="Frequency_Moment_0.f0_init_rel.cases|fact"><span class="entity_def" id="Frequency_Moment_0.f0_init_rel.intros|fact"><span class="entity_def" id="Frequency_Moment_0.f0_init_graph.inducts|fact"><span class="entity_def" id="Frequency_Moment_0.f0_init_graph.simps|fact"><span class="entity_def" id="Frequency_Moment_0.f0_init_graph.induct|fact"><span class="entity_def" id="Frequency_Moment_0.f0_init_graph.cases|fact"><span class="entity_def" id="Frequency_Moment_0.f0_init_graph.intros|fact"><span class="entity_def" id="Frequency_Moment_0.f0_init.elims|thm"><span class="entity_def" id="Frequency_Moment_0.f0_init.induct|thm"><span class="entity_def" id="Frequency_Moment_0.f0_init.simps|thm"><span class="entity_def" id="Frequency_Moment_0.f0_init.pelims|thm"><span class="entity_def" id="Frequency_Moment_0.f0_init.cases|thm"><span class="entity_def" id="Frequency_Moment_0.f0_init.termination|thm"><span class="entity_def" id="Frequency_Moment_0.f0_init.pinduct|thm"><span class="entity_def" id="Frequency_Moment_0.f0_init.psimps|thm"><span class="entity_def" id="Frequency_Moment_0.f0_init_rel.inducts|thm"><span class="entity_def" id="Frequency_Moment_0.f0_init_rel.simps|thm"><span class="entity_def" id="Frequency_Moment_0.f0_init_rel.induct|thm"><span class="entity_def" id="Frequency_Moment_0.f0_init_rel.cases|thm"><span class="entity_def" id="Frequency_Moment_0.f0_init_graph.inducts|thm"><span class="entity_def" id="Frequency_Moment_0.f0_init_graph.simps|thm"><span class="entity_def" id="Frequency_Moment_0.f0_init_graph.induct|thm"><span class="entity_def" id="Frequency_Moment_0.f0_init_graph.cases|thm"><span class="entity_def" id="Frequency_Moment_0.f0_init_graph.intros|thm"><span class="entity_def" id="Frequency_Moment_0.f0_init_def|axiom"><span class="entity_def" id="Frequency_Moment_0.f0_init_rel_def|axiom"><span class="entity_def" id="Frequency_Moment_0.f0_init_sumC_def|axiom"><span class="entity_def" id="Frequency_Moment_0.f0_init_graph_def|axiom"><span class="entity_def" id="Frequency_Moment_0.f0_init_dom|const"><span class="entity_def" id="Frequency_Moment_0.f0_init_rel|const"><span class="entity_def" id="Frequency_Moment_0.f0_init_sumC|const"><span class="entity_def" id="Frequency_Moment_0.f0_init_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_0.f0_init|const"><span>f0_init</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>rat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_state|type"><span>f0_state</span></a><span> </span><span>pmf</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f0_init</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Î´</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Îµ</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="main"><span>-</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Îµ</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="numeral"><span>80</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Î´</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>â</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>p</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above|const"><span>prime_above</span></a><span> </span><span class="main"><span>(</span></span><span>max</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="numeral"><span>19</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Î´</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>23</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span> 
      </span><span class="bound"><span>h</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>{..&lt;</span></span><span class="bound"><span>s</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>pmf_of_set</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials|const"><span>bounded_degree_polynomials</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>t</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>p</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>r</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>h</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="bound"><span>s</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{}</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_0.f0_update.elims|fact"><span class="entity_def" id="Frequency_Moment_0.f0_update.induct|fact"><span class="entity_def" id="Frequency_Moment_0.f0_update.simps|fact"><span class="entity_def" id="Frequency_Moment_0.f0_update.pelims|fact"><span class="entity_def" id="Frequency_Moment_0.f0_update.cases|fact"><span class="entity_def" id="Frequency_Moment_0.f0_update.termination|fact"><span class="entity_def" id="Frequency_Moment_0.f0_update.pinduct|fact"><span class="entity_def" id="Frequency_Moment_0.f0_update.psimps|fact"><span class="entity_def" id="Frequency_Moment_0.f0_update_rel.inducts|fact"><span class="entity_def" id="Frequency_Moment_0.f0_update_rel.simps|fact"><span class="entity_def" id="Frequency_Moment_0.f0_update_rel.induct|fact"><span class="entity_def" id="Frequency_Moment_0.f0_update_rel.cases|fact"><span class="entity_def" id="Frequency_Moment_0.f0_update_rel.intros|fact"><span class="entity_def" id="Frequency_Moment_0.f0_update_graph.inducts|fact"><span class="entity_def" id="Frequency_Moment_0.f0_update_graph.simps|fact"><span class="entity_def" id="Frequency_Moment_0.f0_update_graph.induct|fact"><span class="entity_def" id="Frequency_Moment_0.f0_update_graph.cases|fact"><span class="entity_def" id="Frequency_Moment_0.f0_update_graph.intros|fact"><span class="entity_def" id="Frequency_Moment_0.f0_update.elims|thm"><span class="entity_def" id="Frequency_Moment_0.f0_update.induct|thm"><span class="entity_def" id="Frequency_Moment_0.f0_update.simps|thm"><span class="entity_def" id="Frequency_Moment_0.f0_update.pelims|thm"><span class="entity_def" id="Frequency_Moment_0.f0_update.cases|thm"><span class="entity_def" id="Frequency_Moment_0.f0_update.termination|thm"><span class="entity_def" id="Frequency_Moment_0.f0_update.pinduct|thm"><span class="entity_def" id="Frequency_Moment_0.f0_update.psimps|thm"><span class="entity_def" id="Frequency_Moment_0.f0_update_rel.inducts|thm"><span class="entity_def" id="Frequency_Moment_0.f0_update_rel.simps|thm"><span class="entity_def" id="Frequency_Moment_0.f0_update_rel.induct|thm"><span class="entity_def" id="Frequency_Moment_0.f0_update_rel.cases|thm"><span class="entity_def" id="Frequency_Moment_0.f0_update_graph.inducts|thm"><span class="entity_def" id="Frequency_Moment_0.f0_update_graph.simps|thm"><span class="entity_def" id="Frequency_Moment_0.f0_update_graph.induct|thm"><span class="entity_def" id="Frequency_Moment_0.f0_update_graph.cases|thm"><span class="entity_def" id="Frequency_Moment_0.f0_update_graph.intros|thm"><span class="entity_def" id="Frequency_Moment_0.f0_update_def|axiom"><span class="entity_def" id="Frequency_Moment_0.f0_update_rel_def|axiom"><span class="entity_def" id="Frequency_Moment_0.f0_update_sumC_def|axiom"><span class="entity_def" id="Frequency_Moment_0.f0_update_graph_def|axiom"><span class="entity_def" id="Frequency_Moment_0.f0_update_dom|const"><span class="entity_def" id="Frequency_Moment_0.f0_update_rel|const"><span class="entity_def" id="Frequency_Moment_0.f0_update_sumC|const"><span class="entity_def" id="Frequency_Moment_0.f0_update_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_0.f0_update|const"><span>f0_update</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_state|type"><span>f0_state</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_state|type"><span>f0_state</span></a><span> </span><span>pmf</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f0_update</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>t</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>r</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>sketch</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>t</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>r</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span>
      </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>t</span></span></span></span><span> </span><span class="main"><span>(</span></span><span>insert</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.float_of|const"><span>float_of</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>r</span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.hash|const"><span>hash</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>sketch</span></span></span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_0.f0_result.elims|fact"><span class="entity_def" id="Frequency_Moment_0.f0_result.induct|fact"><span class="entity_def" id="Frequency_Moment_0.f0_result.simps|fact"><span class="entity_def" id="Frequency_Moment_0.f0_result.pelims|fact"><span class="entity_def" id="Frequency_Moment_0.f0_result.cases|fact"><span class="entity_def" id="Frequency_Moment_0.f0_result.termination|fact"><span class="entity_def" id="Frequency_Moment_0.f0_result.pinduct|fact"><span class="entity_def" id="Frequency_Moment_0.f0_result.psimps|fact"><span class="entity_def" id="Frequency_Moment_0.f0_result_rel.inducts|fact"><span class="entity_def" id="Frequency_Moment_0.f0_result_rel.simps|fact"><span class="entity_def" id="Frequency_Moment_0.f0_result_rel.induct|fact"><span class="entity_def" id="Frequency_Moment_0.f0_result_rel.cases|fact"><span class="entity_def" id="Frequency_Moment_0.f0_result_rel.intros|fact"><span class="entity_def" id="Frequency_Moment_0.f0_result_graph.inducts|fact"><span class="entity_def" id="Frequency_Moment_0.f0_result_graph.simps|fact"><span class="entity_def" id="Frequency_Moment_0.f0_result_graph.induct|fact"><span class="entity_def" id="Frequency_Moment_0.f0_result_graph.cases|fact"><span class="entity_def" id="Frequency_Moment_0.f0_result_graph.intros|fact"><span class="entity_def" id="Frequency_Moment_0.f0_result.elims|thm"><span class="entity_def" id="Frequency_Moment_0.f0_result.induct|thm"><span class="entity_def" id="Frequency_Moment_0.f0_result.simps|thm"><span class="entity_def" id="Frequency_Moment_0.f0_result.pelims|thm"><span class="entity_def" id="Frequency_Moment_0.f0_result.cases|thm"><span class="entity_def" id="Frequency_Moment_0.f0_result.termination|thm"><span class="entity_def" id="Frequency_Moment_0.f0_result.pinduct|thm"><span class="entity_def" id="Frequency_Moment_0.f0_result.psimps|thm"><span class="entity_def" id="Frequency_Moment_0.f0_result_rel.inducts|thm"><span class="entity_def" id="Frequency_Moment_0.f0_result_rel.simps|thm"><span class="entity_def" id="Frequency_Moment_0.f0_result_rel.induct|thm"><span class="entity_def" id="Frequency_Moment_0.f0_result_rel.cases|thm"><span class="entity_def" id="Frequency_Moment_0.f0_result_graph.inducts|thm"><span class="entity_def" id="Frequency_Moment_0.f0_result_graph.simps|thm"><span class="entity_def" id="Frequency_Moment_0.f0_result_graph.induct|thm"><span class="entity_def" id="Frequency_Moment_0.f0_result_graph.cases|thm"><span class="entity_def" id="Frequency_Moment_0.f0_result_graph.intros|thm"><span class="entity_def" id="Frequency_Moment_0.f0_result_def|axiom"><span class="entity_def" id="Frequency_Moment_0.f0_result_rel_def|axiom"><span class="entity_def" id="Frequency_Moment_0.f0_result_sumC_def|axiom"><span class="entity_def" id="Frequency_Moment_0.f0_result_graph_def|axiom"><span class="entity_def" id="Frequency_Moment_0.f0_result_dom|const"><span class="entity_def" id="Frequency_Moment_0.f0_result_rel|const"><span class="entity_def" id="Frequency_Moment_0.f0_result_sumC|const"><span class="entity_def" id="Frequency_Moment_0.f0_result_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_0.f0_result|const"><span>f0_result</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_state|type"><span>f0_state</span></a><span> </span><span class="main"><span>â</span></span><span> </span><span>rat</span><span> </span><span>pmf</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f0_result</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>t</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>r</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>sketch</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Median_Method/Median.html#Median.median|const"><span>median</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span class="bound"><span class="entity"><span>s</span></span></span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>sketch</span></span></span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>t</span></span></span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>sketch</span></span></span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>else</span></span><span>
        </span><span>rat_of_nat</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>t</span></span></span></span><span class="main"><span>*</span></span><span> </span><span>rat_of_nat</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="main"><span>/</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.rat_of_float|const"><span>rat_of_float</span></a><span> </span><span class="main"><span>(</span></span><span>Max</span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>sketch</span></span></span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage.elims|fact"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage.induct|fact"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage.simps|fact"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage.pelims|fact"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage.cases|fact"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage.termination|fact"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage.pinduct|fact"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage.psimps|fact"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_rel.inducts|fact"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_rel.simps|fact"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_rel.induct|fact"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_rel.cases|fact"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_rel.intros|fact"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_graph.inducts|fact"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_graph.simps|fact"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_graph.induct|fact"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_graph.cases|fact"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_graph.intros|fact"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage.elims|thm"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage.induct|thm"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage.simps|thm"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage.pelims|thm"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage.cases|thm"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage.termination|thm"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage.pinduct|thm"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage.psimps|thm"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_rel.inducts|thm"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_rel.simps|thm"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_rel.induct|thm"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_rel.cases|thm"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_graph.inducts|thm"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_graph.simps|thm"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_graph.induct|thm"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_graph.cases|thm"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_graph.intros|thm"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_def|axiom"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_rel_def|axiom"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_sumC_def|axiom"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_graph_def|axiom"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_dom|const"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_rel|const"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_sumC|const"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_0.f0_space_usage|const"><span>f0_space_usage</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f0_space_usage</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Îµ</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Î´</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>
    </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="main"><span>-</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Îµ</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><span>in</span></span><span> 
    </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Î´</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>23</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>in</span></span><span>
    </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="numeral"><span>80</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Î´</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><span>in</span></span><span>
    </span><span class="numeral"><span>6</span></span><span> </span><span class="main"><span>+</span></span><span>
    </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>
    </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>
    </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>21</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>
    </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>
    </span><span>real</span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>5</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>21</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>
    </span><span>real</span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>13</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>13</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_0.encode_f0_state_def|fact"><span class="entity_def" id="Frequency_Moment_0.encode_f0_state_def|thm"><span class="entity_def" id="Frequency_Moment_0.encode_f0_state_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_0.encode_f0_state|const"><span>encode_f0_state</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_state|type"><span>f0_state</span></a><span> </span><span class="main"><span>â</span></span><span> </span><span>bool</span><span> </span><span>list</span><span> </span><span>option</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>encode_f0_state</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> 
    </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_prod|const"><span>Ã<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span>
    </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>p</span></span><span class="main"><span>.</span></span><span> 
    </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_prod|const"><span>Ã<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="bound"><span>s</span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.P\&lt;^sub&gt;e|const"><span>P<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="bound"><span>p</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_prod|const"><span>Ã<span class="hidden">â©</span><sub>e</sub></span></a></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="bound"><span>s</span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.S\&lt;^sub&gt;e|const"><span>S<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e|const"><span>F<span class="hidden">â©</span><sub>e</sub></span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.encode_f0_state|const"><span>encode_f0_state</span></a><span> </span><span class="main"><span>(</span></span><span>dom</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.encode_f0_state|const"><span>encode_f0_state</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.encode_f0_state|const"><span>encode_f0_state</span></a><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.encode_f0_state_def|fact"><span>encode_f0_state_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.dependent_encoding|fact"><span>dependent_encoding</span></a><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.exp_golomb_encoding|fact"><span>exp_golomb_encoding</span></a><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.poly_encoding|fact"><span>poly_encoding</span></a><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.fun_encoding|fact"><span>fun_encoding</span></a><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.set_encoding|fact"><span>set_encoding</span></a><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.float_encoding|fact"><span>float_encoding</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding_imp_inj|fact"><span>encoding_imp_inj</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2776..2783">context</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>rat</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span>list</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>result</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_2870..2877">Îµ_range</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>&lt;..&lt;</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_2904..2911">Î´_range</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>&lt;..&lt;</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_2938..2946">as_range</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>set</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>result</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>state</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>state</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_update|const"><span>f0_update</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_init|const"><span>f0_init</span></a><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_result|const"><span>f0_result</span></a><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>  

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_0.t_def|fact"><span class="entity_def" id="Frequency_Moment_0.t_def|thm"><span class="entity_def" id="Frequency_Moment_0.t_def_raw|axiom"><span class="entity_def" id="offset_3072..3082">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_0.t|const"><span class="entity_def" id="offset_3083..3084">t</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="numeral"><span>80</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>â</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.t_gt_0|fact"><span class="entity_def" id="Frequency_Moment_0.t_gt_0|thm"><span class="entity_def" id="offset_3140..3146">t_gt_0</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3072..3082"><span>t_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_0.s_def|fact"><span class="entity_def" id="Frequency_Moment_0.s_def|thm"><span class="entity_def" id="Frequency_Moment_0.s_def_raw|axiom"><span class="entity_def" id="offset_3199..3209">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_0.s|const"><span class="entity_def" id="offset_3210..3211">s</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>s</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.s_gt_0|fact"><span class="entity_def" id="Frequency_Moment_0.s_gt_0|thm"><span class="entity_def" id="offset_3271..3277">s_gt_0</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2870..2877"><span>Îµ_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3199..3209"><span>s_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_0.p_def|fact"><span class="entity_def" id="Frequency_Moment_0.p_def|thm"><span class="entity_def" id="Frequency_Moment_0.p_def_raw|axiom"><span class="entity_def" id="offset_3330..3340">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_0.p|const"><span class="entity_def" id="offset_3341..3342">p</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>p</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above|const"><span>prime_above</span></a><span> </span><span class="main"><span>(</span></span><span>max</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="numeral"><span>19</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.p_prime|fact"><span class="entity_def" id="Frequency_Moment_0.p_prime|thm"><span class="entity_def" id="offset_3393..3400">p_prime</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>Factorial_Ring.prime</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3330..3340"><span>p_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above_prime|fact"><span>prime_above_prime</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>presburger</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.p_ge_18|fact"><span class="entity_def" id="Frequency_Moment_0.p_ge_18|thm"><span class="entity_def" id="offset_3487..3494">p_ge_18</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>18</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>19</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3330..3340"><span>p_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above_lower_bound|fact"><span>prime_above_lower_bound</span></a><span> </span><span>max.bounded_iff</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.p_gt_0|fact"><span class="entity_def" id="Frequency_Moment_0.p_gt_0|thm"><span class="entity_def" id="offset_3633..3639">p_gt_0</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3487..3494"><span>p_ge_18</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.p_gt_1|fact"><span class="entity_def" id="Frequency_Moment_0.p_gt_1|thm"><span class="entity_def" id="offset_3685..3691">p_gt_1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3487..3494"><span>p_ge_18</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.n_le_p|fact"><span class="entity_def" id="Frequency_Moment_0.n_le_p|thm"><span class="entity_def" id="offset_3738..3744">n_le_p</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>max</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="numeral"><span>19</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3330..3340"><span>p_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above_lower_bound|fact"><span>prime_above_lower_bound</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.p_le_n|fact"><span class="entity_def" id="Frequency_Moment_0.p_le_n|thm"><span class="entity_def" id="offset_3918..3924">p_le_n</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>40</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>max</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="numeral"><span>19</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3330..3340"><span>p_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above_upper_bound|fact"><span>prime_above_upper_bound</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>40</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>19</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.as_lt_p|fact"><span class="entity_def" id="Frequency_Moment_0.as_lt_p|thm"><span class="entity_def" id="offset_4143..4150">as_lt_p</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2938..2946"><span>as_range</span></a><span> </span><span>atLeastLessThan_iff</span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>order_less_le_trans</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> _ </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3738..3744"><span>n_le_p</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>blast</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.as_subset_p|fact"><span class="entity_def" id="Frequency_Moment_0.as_subset_p|thm"><span class="entity_def" id="offset_4282..4293">as_subset_p</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>set</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>}</span></span><span>"</span></span></span><span>
   </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4143..4150"><span>as_lt_p</span></a><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>subset_iff</span><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_0.r_def|fact"><span class="entity_def" id="Frequency_Moment_0.r_def|thm"><span class="entity_def" id="Frequency_Moment_0.r_def_raw|axiom"><span class="entity_def" id="offset_4366..4376">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_0.r|const"><span class="entity_def" id="offset_4377..4378">r</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>23</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.r_bound|fact"><span class="entity_def" id="Frequency_Moment_0.r_bound|thm"><span class="entity_def" id="offset_4449..4456">r_bound</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>23</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>23</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_nonneg_nonneg</span><span> </span><span>mult_nonneg_nonneg</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4366..4376"><span>r_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.r_ge_23|fact"><span class="entity_def" id="Frequency_Moment_0.r_ge_23|thm"><span class="entity_def" id="offset_4782..4789">r_ge_23</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>23</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="numeral"><span>23</span></span><span class="main"><span>::</span></span><span>real</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>23</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>23</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><span>mult_nonneg_nonneg</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4449..4456"><span>r_bound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>23</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.two_pow_r_le_1|fact"><span class="entity_def" id="Frequency_Moment_0.two_pow_r_le_1|thm"><span class="entity_def" id="offset_5060..5074">two_pow_r_le_1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_5117..5118">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>real</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4782..4789"><span>r_ge_23</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5117..5118"><span>a</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>intro</span></span><span> </span><span>powr_less_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5252..5266">interpretation</span></span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.carter_wegman_hash_family|locale"><span>carter_wegman_hash_family</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> </span><span class="quoted"><span class="numeral"><span>2</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>rewrites</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Universal_Hash_Families/Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.ring.hash|const"><span>ring.hash</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.hash|const"><span>Frequency_Moment_0.hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.carter_wegman_hash_familyI|fact"><span>carter_wegman_hash_familyI</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring_is_field|fact"><span>mod_ring_is_field</span></a><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring_finite|fact"><span>mod_ring_finite</span></a><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.hash_def|fact"><span>hash_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3393..3400"><span>p_prime</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_0.tr_hash_def|fact"><span class="entity_def" id="Frequency_Moment_0.tr_hash_def|thm"><span class="entity_def" id="Frequency_Moment_0.tr_hash_def_raw|axiom"><span class="entity_def" id="offset_5487..5497">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_0.tr_hash|const"><span class="entity_def" id="offset_5498..5505">tr_hash</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>tr_hash</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_0.sketch_rv_def|fact"><span class="entity_def" id="Frequency_Moment_0.sketch_rv_def|thm"><span class="entity_def" id="Frequency_Moment_0.sketch_rv_def_raw|axiom"><span class="entity_def" id="offset_5564..5574">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_0.sketch_rv|const"><span class="entity_def" id="offset_5575..5584">sketch_rv</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>sketch_rv</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.float_of|const"><span>float_of</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_0.estimate_def|fact"><span class="entity_def" id="Frequency_Moment_0.estimate_def|thm"><span class="entity_def" id="Frequency_Moment_0.estimate_def_raw|axiom"><span class="entity_def" id="offset_5666..5676">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_0.estimate|const"><span class="entity_def" id="offset_5677..5685">estimate</span></span></span><span> 
   </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>estimate</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>S</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span>card</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>S</span></span></span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="keyword1"><span>then</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>S</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span>of_nat</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>of_nat</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>/</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.rat_of_float|const"><span>rat_of_float</span></a><span> </span><span class="main"><span>(</span></span><span>Max</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>S</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_0.sketch_rv&apos;_def|fact"><span class="entity_def" id="Frequency_Moment_0.sketch_rv&apos;_def|thm"><span class="entity_def" id="Frequency_Moment_0.sketch_rv&apos;_def_raw|axiom"><span class="entity_def" id="offset_5805..5815">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_0.sketch_rv&apos;|const"><span class="entity_def" id="offset_5816..5826">sketch_rv'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>sketch_rv'</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_0.estimate&apos;_def|fact"><span class="entity_def" id="Frequency_Moment_0.estimate&apos;_def|thm"><span class="entity_def" id="Frequency_Moment_0.estimate&apos;_def_raw|axiom"><span class="entity_def" id="offset_5895..5905">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_0.estimate&apos;|const"><span class="entity_def" id="offset_5906..5915">estimate'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>estimate'</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>S</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span>card</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>S</span></span></span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="keyword1"><span>then</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>S</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span>Max</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>S</span></span></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_0.\&lt;Omega&gt;\&lt;^sub&gt;0_def|fact"><span class="entity_def" id="Frequency_Moment_0.\&lt;Omega&gt;\&lt;^sub&gt;0_def|thm"><span class="entity_def" id="Frequency_Moment_0.\&lt;Omega&gt;\&lt;^sub&gt;0_def_raw|axiom"><span class="entity_def" id="offset_6011..6021">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_0.\&lt;Omega&gt;\&lt;^sub&gt;0|const"><span class="entity_def" id="offset_6022..6025">Î©<span class="hidden">â©</span><sub>0</sub></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Î©<span class="hidden">â©</span><sub>0</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>pmf_of_set</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>space</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6088..6093">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.f0_alg_sketch|fact"><span class="entity_def" id="Frequency_Moment_0.f0_alg_sketch|thm"><span class="entity_def" id="offset_6094..6107">f0_alg_sketch</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>sketch</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>state</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>state</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_update|const"><span>f0_update</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_init|const"><span>f0_init</span></a><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>sketch</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>,</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>,</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>,</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>,</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6022..6025"><span>Î©<span class="hidden">â©</span><sub>0</sub></span></a><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5564..5574"><span>sketch_rv_def</span></a><span> 
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6088..6093"><span>sketch_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>as</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span>rev_induct</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>Nil</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3199..3209"><span>s_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3330..3340"><span>p_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>map_pmf_def</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3072..3082"><span>t_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4366..4376"><span>r_def</span></a><span> </span><span>Let_def</span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_def|fact"><span>least_def</span></a><span> </span><span>restrict_def</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>space_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6011..6021"><span>Î©<span class="hidden">â©</span><sub>0</sub>_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_6505..6509">snoc</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?sketch</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.float_of|const"><span>float_of</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span>set</span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>state</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>state</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_update|const"><span>f0_update</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>@</span></span><span> </span><span class="main"><span>[</span></span><span class="skolem"><span>x</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_init|const"><span>f0_init</span></a><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
     </span><span class="main"><span>(</span></span><span>map_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="var"><span>?sketch</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6022..6025"><span>Î©<span class="hidden">â©</span><sub>0</sub></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_update|const"><span>f0_update</span></a><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>restrict_def</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6505..6509"><span>snoc</span></a><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_init.simps|fact"><span>f0_init.simps</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6022..6025"><span>Î©<span class="hidden">â©</span><sub>0</sub></span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_update|const"><span>f0_update</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="var"><span>?sketch</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>map_pmf_def</span><span> </span><span>bind_assoc_pmf</span><span> </span><span>bind_return_pmf</span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_update.simps|fact"><span>f0_update.simps</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="var"><span>?sketch</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span class="main"><span>@</span></span><span class="main"><span>[</span></span><span class="skolem"><span>x</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6022..6025"><span>Î©<span class="hidden">â©</span><sub>0</sub></span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_insert|fact"><span>least_insert</span></a><span> </span><span>map_pmf_def</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5487..5497"><span>tr_hash_def</span></a><span> </span><span class="quasi_keyword"><span>cong</span></span><span class="main"><span class="main"><span>:</span></span></span><span>restrict_cong</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_7182..7187">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.card_nat_in_ball|fact"><span class="entity_def" id="Frequency_Moment_0.card_nat_in_ball(2)|thm"><span class="entity_def" id="Frequency_Moment_0.card_nat_in_ball(1)|thm"><span class="entity_def" id="offset_7188..7204">card_nat_in_ball</span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>q</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>real</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>q</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>q</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>q</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_7376..7377">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>of_nat</span><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>â</span></span><span>real</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>-</span></span><span class="free"><span>q</span></span><span class="main"><span>â</span></span><span class="main"><span>..</span></span><span class="main"><span>â</span></span><span>real</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>+</span></span><span class="free"><span>q</span></span><span class="main"><span>â</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_7182..7187"><span>assms</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>ceiling_le_iff</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>A</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>card_image</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>â</span></span><span>real</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>-</span></span><span class="free"><span>q</span></span><span class="main"><span>â</span></span><span class="main"><span>..</span></span><span class="main"><span>â</span></span><span>real</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>+</span></span><span class="free"><span>q</span></span><span class="main"><span>â</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>{</span></span><span>of_nat</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_mono</span><span> </span><span>image_subsetI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_7182..7187"><span>A_def</span></a><span> </span><span>abs_le_iff</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="main"><span>â</span></span><span>real</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>-</span></span><span class="free"><span>q</span></span><span class="main"><span>â</span></span><span class="main"><span>..</span></span><span class="main"><span>â</span></span><span>real</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>+</span></span><span class="free"><span>q</span></span><span class="main"><span>â</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>card_Diff_singleton</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_7376..7377"><span>a</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>int</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="main"><span>â</span></span><span>real</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>-</span></span><span class="free"><span>q</span></span><span class="main"><span>â</span></span><span class="main"><span>..</span></span><span class="main"><span>â</span></span><span>real</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>+</span></span><span class="free"><span>q</span></span><span class="main"><span>â</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>int</span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>of_nat_diff</span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_7376..7377"><span>a</span></a><span> </span><span>card_0_eq</span><span> </span><span>empty_iff</span><span> </span><span>finite_atLeastAtMost_int</span><span> </span><span>less_one</span><span> </span><span>linorder_not_le</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>â</span></span><span class="free"><span>q</span></span><span class="main"><span>+</span></span><span>real</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>â</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span class="main"><span>â</span></span><span>real</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>-</span></span><span class="free"><span>q</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_7182..7187"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span>q</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>q</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="free"><span>q</span></span><span class="main"><span>â</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>subsetI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_7182..7187"><span>A_def</span></a><span> </span><span>abs_le_iff</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>finite_subset</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.prob_degree_lt_1|fact"><span class="entity_def" id="Frequency_Moment_0.prob_degree_lt_1|thm"><span class="entity_def" id="offset_8290..8306">prob_degree_lt_1</span></span></span><span class="main"><span>:</span></span><span>
   </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Polynomials.html#Polynomials.degree|const"><span>degree</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> 
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>space</span></a><span> </span><span class="main"><span>â©</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>length</span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials|const"><span>bounded_degree_polynomials</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span>set_eq_iff</span><span> </span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials_def|fact"><span>bounded_degree_polynomials_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>space_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>field_size</span></a><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials|const"><span>bounded_degree_polynomials</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>space</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>space_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>bounded_degree_polynomials_card</span></a><span> </span><span>power2_eq_square</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span> </span><span>measure_pmf_of_set</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8834..8839">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.collision_prob|fact"><span class="entity_def" id="Frequency_Moment_0.collision_prob|thm"><span class="entity_def" id="offset_8840..8854">collision_prob</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="numeral"><span>5</span></span><span class="main"><span>/</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="var"><span>?l</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="var"><span>?r1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="var"><span>?r2</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_9105..9111">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>Ï</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>real</span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>9</span></span><span class="main"><span>/</span></span><span class="numeral"><span>8</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_9146..9156">rho_c_ge_0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_9105..9111"><span>Ï_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_8834..8839"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> 

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>c_ge_0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>c</span></span><span class="main"><span>â¥</span></span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_8834..8839"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Algebra/Polynomials.html#Polynomials.degree|const"><span>degree</span></a><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>space</span></a><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Polynomials.html#Polynomials.degree|const"><span>degree</span></a><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>Ï</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials_def|fact"><span>bounded_degree_polynomials_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>space_def</span></a><span class="main"><span>)</span></span><span> 
     </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>One_nat_def</span><span> </span><span>Suc_1</span><span> </span><span>le_less_Suc_eq</span><span> </span><span>less_imp_diff_less</span><span> </span><span>list.size</span><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>pos2</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_9459..9460">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â¹</span></span><span>  </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Polynomials.html#Polynomials.degree|const"><span>degree</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>space</span></a><span> </span><span class="main"><span>â¹</span></span><span>  </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â </span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>Ï</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>inj_onD</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>inj_if_degree_1</span></a><span class="main"><span>]</span></span><span>  </span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring_carr|fact"><span>mod_ring_carr</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span> 

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_9617..9618">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Polynomials.html#Polynomials.degree|const"><span>degree</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>5</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_9739..9746">b_assms</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span>"</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span>"</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_9811..9812">c</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>Â¦</span></span><span>real</span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_9887..9894">c_assms</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="skolem"><span>u</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="skolem"><span>u</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="skolem"><span>v</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>9</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>9</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="numeral"><span>23</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4782..4789"><span>r_ge_23</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span> </span><span>powr_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>9</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_9105..9111"><span>Ï_def</span></a><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_10301..10302">d</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span class="main"><span>*</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>Ï</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_8834..8839"><span>assms</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5060..5074"><span>two_pow_r_le_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>pos_divide_le_eq</span><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span>  </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.truncate_down_pos|fact"><span>truncate_down_pos</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><span>of_nat_0_le_iff</span><span class="main"><span>]</span></span><span> </span><span>order_trans</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>  </span><span class="free"><span>c</span></span><span>  </span><span class="main"><span>â¹</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>Ï</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5060..5074"><span>two_pow_r_le_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>order_trans</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> _ </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_10301..10302"><span>d</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>pos_le_divide_eq</span><span class="main"><span>)</span></span><span> 

      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_10753..10754">e</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>Ï</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>Ï</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_9887..9894"><span>c_assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>Â¦</span></span><span>real</span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span>max</span><span> </span><span class="main"><span>Â¦</span></span><span>real</span><span> </span><span class="skolem"><span>u</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>Â¦</span></span><span>real</span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_9887..9894"><span>c_assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.truncate_down_eq|fact"><span>truncate_down_eq</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_10753..10754"><span>e</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_right_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¦</span></span><span>real</span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>

      </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_10753..10754"><span>e</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Polynomials.html#Polynomials.degree|const"><span>degree</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span>
      </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>u</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>v</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="bound"><span>v</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span>
      </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span>  </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>fst</span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>snd</span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_9459..9460"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>pmf_mono</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5487..5497"><span>tr_hash_def</span></a><span class="main"><span>)</span></span><span> 
       </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash_range</span></a><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring_carr|fact"><span>mod_ring_carr</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_9739..9746"><span>b_assms</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4282..4293"><span>as_subset_p</span></a><span> </span><span>lessThan_iff</span><span> </span><span>nat_neq_iff</span><span> </span><span>subset_eq</span><span class="main"><span>)</span></span><span> 

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>u</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>v</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>â§</span></span><span>
      </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="bound"><span>v</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> 
      </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>fst</span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span>  </span><span class="skolem"><span>y</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>snd</span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>measure_UNION_le</span><span> </span><span>finite_cartesian_product</span><span> </span><span>finite_subset</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> B</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>{</span></span></span></span><span class="main"><span class="main"><span class="main"><span>0</span></span></span></span><span class="main"><span class="main"><span class="main"><span>..&lt;</span></span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a></a></a><span class="main"><span class="main"><span class="main"><span>}</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>Ã</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>{</span></span></span></span><span class="main"><span class="main"><span class="main"><span>0</span></span></span></span><span class="main"><span class="main"><span class="main"><span>..&lt;</span></span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a></a></a><span class="main"><span class="main"><span class="main"><span>}</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
       </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>u</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>v</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>â§</span></span><span>
      </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="bound"><span>v</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> 
      </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span class="skolem"><span>y</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="bound"><span>u</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>sum_mono</span><span>  </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>pmf_mono</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>force</span></span><span>

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>u</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>v</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>â§</span></span><span>
      </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="bound"><span>v</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_8834..8839"><span>assms</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4282..4293"><span>as_subset_p</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_9739..9746"><span>b_assms</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>sum_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash_prob</span></a><span class="main"><span>)</span></span><span>  </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span> </span><span>power2_eq_square</span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> 
      </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>u</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>v</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="bound"><span>v</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> 
      </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>u</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>v</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_9811..9812"><span>c</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_mono</span><span> </span><span>of_nat_mono</span><span> </span><span>card_mono</span><span> </span><span>finite_cartesian_product</span><span> </span><span>finite_subset</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> B</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>{..&lt;</span></span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a></a></a><span class="main"><span class="main"><span class="main"><span>}</span></span></span></span><span class="main"><span class="main"><span class="main"><span>Ã</span></span></span></span><span class="main"><span class="main"><span class="main"><span>{..&lt;</span></span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a></a></a><span class="main"><span class="main"><span class="main"><span>}</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="operator"><span>auto</span></span><span>

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>u'</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â§</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span>
        </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>u</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>,</span></span><span class="bound"><span>v</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>u'</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â§</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="bound"><span>u'</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span> </span><span>of_nat_mono</span><span> </span><span>card_mono</span><span> </span><span>finite_cartesian_product</span><span> </span><span>finite_subset</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> B</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>{..&lt;</span></span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a></a></a><span class="main"><span class="main"><span class="main"><span>}</span></span></span></span><span class="main"><span class="main"><span class="main"><span>Ã</span></span></span></span><span class="main"><span class="main"><span class="main"><span>{..&lt;</span></span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a></a></a><span class="main"><span class="main"><span class="main"><span>}</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
       </span><span class="operator"><span>auto</span></span><span>

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>u'</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â§</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span>
      </span><span>card</span><span>  </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>u</span></span><span class="main"><span>,</span></span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>u'</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â§</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="bound"><span>u'</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span> </span><span>of_nat_mono</span><span> </span><span>card_UN_le</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>u'</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â§</span></span><span>  </span><span>real</span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span>
      </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>u'</span></span><span> </span><span class="main"><span>,</span></span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>v</span></span><span class="main"><span>.</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>u'</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â§</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="bound"><span>u'</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>arg_cong2</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>(*)</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>arg_cong</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>sum.cong</span><span> </span><span>arg_cong</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
       </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>set_eq_iff</span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>u'</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â§</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span>
      </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>v</span></span><span class="main"><span>.</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>u'</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â§</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="bound"><span>u'</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span> </span><span>of_nat_mono</span><span> </span><span>sum_mono</span><span> </span><span>card_image_le</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>u'</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â§</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span>
      </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>v</span></span><span class="main"><span>.</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>u'</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="bound"><span>u'</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span> </span><span>sum_mono</span><span> </span><span>of_nat_mono</span><span> </span><span>card_mono</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_7188..7204"><span>card_nat_in_ball</span></a><span> </span><span>subsetI</span><span class="main"><span>)</span></span><span>  </span><span class="operator"><span>auto</span></span><span>

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>u'</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â§</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span>
      </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>v</span></span><span class="main"><span>.</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>u'</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="bound"><span>u'</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>u'</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â§</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span> </span><span>sum_mono</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_7188..7204"><span>card_nat_in_ball</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â§</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span>  </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_9146..9156"><span>rho_c_ge_0</span></a><span> </span><span>le_nat_floor</span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span> </span><span>mult_right_mono</span><span> </span><span>of_nat_mono</span><span> </span><span>card_mono</span><span> </span><span>subsetI</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span>  </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>+</span></span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_9146..9156"><span>rho_c_ge_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span> </span><span>mult_right_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span>  </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>+</span></span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_8834..8839"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>distrib_left</span><span> </span><span>distrib_right</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_9105..9111"><span>Ï_def</span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>ac_simps</span></span></span><span> </span><span>power2_eq_square</span><span class="main"><span>)</span></span><span> 

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>5</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span>  </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>divide_right_mono</span><span> </span><span>mult_right_mono</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_9105..9111"><span>Ï_def</span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="var"><span>?l</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Polynomials.html#Polynomials.degree|const"><span>degree</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
    </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Polynomials.html#Polynomials.degree|const"><span>degree</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â§</span></span><span>
    </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>pmf_mono</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>metis</span></span><span> </span><span>linorder_neqE_nat</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> 
    </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Polynomials.html#Polynomials.degree|const"><span>degree</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span>  </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>c</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>measure_UNION_le</span><span> </span><span>finite_cartesian_product</span><span> </span><span>finite_subset</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> B</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>set</span><span> </span><span class="free"><span class="free"><span class="free"><span>as</span></span></span></span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>Ã</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>set</span><span> </span><span class="free"><span class="free"><span class="free"><span>as</span></span></span></span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="operator"><span>auto</span></span><span>

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>5</span></span><span>  </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_9617..9618"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>sum_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>case_prod_beta</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="numeral"><span>5</span></span><span class="main"><span>/</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>  </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>card</span><span>  </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span class="main"><span>,</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="numeral"><span>5</span></span><span class="main"><span>/</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>  </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.card_ordered_pairs|fact"><span>card_ordered_pairs</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span> 

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="numeral"><span>5</span></span><span class="main"><span>/</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power2_eq_square</span><span> </span><span>mult_left_mono</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>5</span></span><span class="main"><span>/</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>c</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_16920..16921">f</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="var"><span>?l</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Polynomials.html#Polynomials.degree|const"><span>degree</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="var"><span>?r1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="var"><span>?l</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="var"><span>?l</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Polynomials.html#Polynomials.degree|const"><span>degree</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Polynomials.html#Polynomials.degree|const"><span>degree</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>pmf_add</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="var"><span>?r1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="var"><span>?r2</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_16920..16921"><span>f</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_8290..8306"><span>prob_degree_lt_1</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.of_bool_square|fact"><span class="entity_def" id="Frequency_Moment_0.of_bool_square|thm"><span class="entity_def" id="offset_17211..17225">of_bool_square</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>of_bool</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>of_bool</span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>::</span></span><span>real</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_0.Q_def|fact"><span class="entity_def" id="Frequency_Moment_0.Q_def|thm"><span class="entity_def" id="Frequency_Moment_0.Q_def_raw|axiom"><span class="entity_def" id="offset_17295..17305">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_0.Q|const"><span class="entity_def" id="offset_17306..17307">Q</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Q</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>x</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span>int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>y</span></span></span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_0.m_def|fact"><span class="entity_def" id="Frequency_Moment_0.m_def|thm"><span class="entity_def" id="Frequency_Moment_0.m_def_raw|axiom"><span class="entity_def" id="offset_17371..17381">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_0.m|const"><span class="entity_def" id="offset_17382..17383">m</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>m</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_17419..17424">lemma</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>int</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.exp_Q|fact"><span class="entity_def" id="Frequency_Moment_0.exp_Q|thm"><span class="entity_def" id="offset_17473..17478">exp_Q</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>of_int</span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.var_Q|fact"><span class="entity_def" id="Frequency_Moment_0.var_Q|thm"><span class="entity_def" id="offset_17545..17550">var_Q</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>of_int</span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17623..17633">exp_single</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real_of_int</span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>/</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_17715..17716">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17755..17761">x_le_p</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17715..17716"><span>a</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4143..4150"><span>as_lt_p</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span>indicat_real</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.hash|const"><span>Frequency_Moment_0.hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>arg_cong2</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span class="keyword1"><span class="keyword1"><span>integral<span class="hidden">â§</span><sup>L</sup></span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>ext</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>int</span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>}</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>int</span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob_range</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17755..17761"><span>x_le_p</span></a><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{..&lt;</span></span><span>nat</span><span> </span><span class="free"><span>a</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17419..17424"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>arg_cong2</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>(/)</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>arg_cong</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>arg_cong</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
       </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>set_eq_iff</span><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span>real_of_int</span><span> </span><span class="free"><span>a</span></span><span class="main"><span>/</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17419..17424"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real_of_int</span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>/</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>expectation</span></a><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17295..17305"><span>Q_def</span></a><span> </span><span>Int_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>Bochner_Integration.integral_sum</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>/</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>sum.cong</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17623..17633"><span>exp_single</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span>  </span><span>real_of_int</span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17371..17381"><span>m_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>/</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_19112..19117">indep</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>J</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>card</span><span> </span><span class="skolem"><span>J</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>indep_vars</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>borel</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>J</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>J</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4282..4293"><span>as_subset_p</span></a><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring_carr|fact"><span>mod_ring_carr</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>indep_vars_compose2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> Y</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>Î»</span></span></span></span><span class="bound"><span class="bound"><span class="bound"><span>i</span></span></span></span><span> </span><span class="bound"><span class="bound"><span class="bound"><span>x</span></span></span></span><span class="main"><span class="main"><span class="main"><span>.</span></span></span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>int</span><span> </span><span class="bound"><span class="bound"><span class="bound"><span>x</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>&lt;</span></span></span></span><span> </span><span class="free"><span class="free"><span class="free"><span>a</span></span></span></span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> M'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>Î»</span></span></span></span><span class="main"><span class="bound"><span class="main"><span class="bound"><span class="main"><span class="bound"><span>_</span></span></span></span></span></span></span><span class="main"><span class="main"><span class="main"><span>.</span></span></span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Preliminary_Results.html#Preliminary_Results.discrete|const"><a class="entity_ref" href="../Universal_Hash_Families/Preliminary_Results.html#Preliminary_Results.discrete|const"><a class="entity_ref" href="../Universal_Hash_Families/Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a></a></a><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span>
        </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>k_wise_indep_vars_subset</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>k_wise_indep</span></a><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>finite_subset</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> _ </span><span>finite_set</span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_19439..19441">rv</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>random_variable</span></a><span> </span><span>borel</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
     </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17295..17305"><span>Q_def</span></a><span> </span><span>Int_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>var_sum_pairwise_indep_2</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_19112..19117"><span>indep</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_19439..19441"><span>rv</span></a><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>sum_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>variance_eq</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17211..17225"><span>of_bool_square</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17623..17633"><span>exp_single</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>/</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17371..17381"><span>m_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>/</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.t_bound|fact"><span class="entity_def" id="Frequency_Moment_0.t_bound|thm"><span class="entity_def" id="offset_20118..20125">t_bound</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>81</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>80</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3072..3082"><span>t_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3140..3146"><span>t_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>80</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span>  </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power_le_one</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>81</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.t_r_bound|fact"><span class="entity_def" id="Frequency_Moment_0.t_r_bound|thm"><span class="entity_def" id="offset_20471..20480">t_r_bound</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>40</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>720</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>720</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>81</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>23</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4449..4456"><span>r_bound</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_20118..20125"><span>t_bound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span> </span><span>mult_mono</span><span> </span><span>power_mono</span><span> </span><span>powr_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>720</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>81</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="numeral"><span>23</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span> </span><span>mult_mono</span><span> </span><span>power_mono</span><span> </span><span>add_mono</span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power_le_one</span><span> </span><span>powr_diff</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>720</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>81</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>  </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="numeral"><span>23</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>arg_cong2</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>(*)</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power2_eq_square</span><span> </span><span>power4_eq_xxxx</span><span> </span><span>log_divide</span><span> </span><span>log_powr</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>720</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>81</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="numeral"><span>23</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.m_eq_F_0|fact"><span class="entity_def" id="Frequency_Moment_0.m_eq_F_0|thm"><span class="entity_def" id="offset_21382..21390">m_eq_F_0</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>=</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17371..17381"><span>m_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F_def|fact"><span>F_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.estimate&apos;_bounds|fact"><span class="entity_def" id="Frequency_Moment_0.estimate&apos;_bounds|thm"><span class="entity_def" id="offset_21462..21478">estimate'_bounds</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>of_rat</span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5906..5915"><span>estimate'</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_21620..21624">True</span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_21627..21633">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>Î´'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Î´'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>4</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_21674..21680">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>u</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>â</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>+</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_21725..21731">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>v</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>â</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span>"</span></span></span><span>

  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_21777..21783">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>has_no_collision</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>has_no_collision</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¶</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¨</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>23</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4449..4456"><span>r_bound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>powr_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span class="numeral"><span>23</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>arg_cong2</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span class="keyword1"><span class="keyword1"><span>(powr)</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span> </span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>powr_mono</span><span> </span><span>diff_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span> </span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span>  </span><span class="numeral"><span>16</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>powr_diff</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>16</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>log_divide</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>8</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>pos_divide_less_eq</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_22585..22591">r_le_Î´</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>8</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_22652..22659">Î´'_gt_0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Î´'</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21627..21633"><span>Î´'_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Î´'</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>3</span></span><span class="main"><span>/</span></span><span class="numeral"><span>4</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21627..21633"><span>Î´'_def</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_22804..22811">Î´'_lt_1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Î´'</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>81</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_20118..20125"><span>t_bound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>81</span></span><span class="main"><span>*</span></span><span class="numeral"><span>9</span></span><span class="main"><span>/</span></span><span class="numeral"><span>16</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21627..21633"><span>Î´'_def</span></a><span> </span><span>power2_eq_square</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>46</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>divide_right_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_23064..23071">t_le_Î´'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>46</span></span><span class="main"><span>/</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>80</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>80</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3072..3082"><span>t_def</span></a><span> </span><span>of_nat_ceiling</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>80</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_23347..23354">t_ge_Î´'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>45</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21627..21633"><span>Î´'_def</span></a><span> </span><span>power2_eq_square</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17371..17381"><span>m_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2938..2946"><span>as_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3738..3744"><span>n_le_p</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_23555..23561">m_le_p</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span>t_le_m</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21620..21624"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_23642..23648">m_ge_0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17371..17381"><span>m_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21620..21624"><span>True</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3140..3146"><span>t_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21725..21731"><span>v_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22804..22811"><span>Î´'_lt_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23642..23648"><span>m_ge_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>divide_left_mono</span><span> </span><span>mult_left_mono</span><span> </span><span>mult_nonneg_nonneg</span><span> </span><span>mult_pos_pos</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21627..21633"><span>Î´'_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_23972..23980">v_ubound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_24053..24059">a_ge_1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22652..22659"><span>Î´'_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3633..3639"><span>p_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23642..23648"><span>m_ge_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3140..3146"><span>t_gt_0</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span>mult_pos_pos</span><span> </span><span>divide_pos_pos</span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21674..21680"><span>u_def</span></a><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_24177..24183">a_ge_0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22652..22659"><span>Î´'_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23642..23648"><span>m_ge_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23555..23561"><span>m_le_p</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3140..3146"><span>t_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_right_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_24470..24476">v_gt_0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>mult_pos_pos</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23642..23648"><span>m_ge_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22804..22811"><span>Î´'_lt_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21725..21731"><span>v_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_24548..24554">v_ge_1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real_of_int</span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21620..21624"><span>True</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17371..17381"><span>m_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22652..22659"><span>Î´'_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23642..23648"><span>m_ge_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_24726..24736">a_le_p_aux</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span>"</span></span></span><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21674..21680"><span>u_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23642..23648"><span>m_ge_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22652..22659"><span>Î´'_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_24726..24736"><span>a_le_p_aux</span></a><span>  </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_24726..24736"><span>a_le_p_aux</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3633..3639"><span>p_gt_0</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>pos_divide_less_eq</span><span> </span><span class="dynamic"><span class="dynamic"><span>ac_simps</span></span></span><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>int_less_real_le</span><span> </span><span>not_less</span><span> </span><span>of_int_le_iff</span><span> </span><span>of_int_of_nat_eq</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_25094..25100">u_le_p</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>int</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>Sigma_Algebra.space</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M</span></a><span class="main"><span>.</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> 
    </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>/</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>pmf_mono</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>Ï</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_25370..25374">t_le</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="skolem"><span>Ï</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23642..23648"><span>m_ge_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3633..3639"><span>p_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>divide_right_mono</span><span> </span><span>mult_left_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21674..21680"><span>u_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>+</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>distrib_left</span><span> </span><span>add_divide_distrib</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>+</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3633..3639"><span>p_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23642..23648"><span>m_ge_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>+</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23555..23561"><span>m_le_p</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3633..3639"><span>p_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>of_int</span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>of_int</span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â¤</span></span><span> 
      </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>+</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>+</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><span>mult_left_mono</span><span> </span><span>real_sqrt_le_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>+</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22652..22659"><span>Î´'_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3140..3146"><span>t_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><span>mult_left_mono</span><span> </span><span>real_sqrt_le_mono</span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>pos_divide_le_eq</span><span> </span><span>left_diff_distrib</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>+</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>46</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>/</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22652..22659"><span>Î´'_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3140..3146"><span>t_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22804..22811"><span>Î´'_lt_1</span></a><span> </span><span>add_pos_pos</span><span>  </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23064..23071"><span>t_le_Î´'</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><span>mult_left_mono</span><span> </span><span>real_sqrt_le_mono</span><span> </span><span>add_mono</span><span class="main"><span>)</span></span><span>
       </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>power_le_one</span><span> </span><span>pos_le_divide_eq</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>21</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>45</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22652..22659"><span>Î´'_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23347..23354"><span>t_ge_Î´'</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span class="main"><span>)</span></span><span>
         </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>real_sqrt_divide</span><span> </span><span>divide_le_cancel</span><span> </span><span>real_le_lsqrt</span><span> </span><span>pos_divide_le_eq</span><span> </span><span class="dynamic"><span class="dynamic"><span>ac_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22652..22659"><span>Î´'_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="skolem"><span>Ï</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_25370..25374"><span>t_le</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>of_int</span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>of_int</span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="skolem"><span>Ï</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>Â¦</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_24177..24183"><span>a_ge_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_25094..25100"><span>u_le_p</span></a><span>  </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21620..21624"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17473..17478"><span>exp_Q</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.abs_ge_iff|fact"><span>abs_ge_iff</span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>Sigma_Algebra.space</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M</span></a><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
      </span><span class="main"><span>Â¦</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>variance</span></a><span>  </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>of_int</span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_24053..24059"><span>a_ge_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3633..3639"><span>p_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23642..23648"><span>m_ge_0</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>Chebyshev_inequality</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span> 

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>of_int</span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_24177..24183"><span>a_ge_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_25094..25100"><span>u_le_p</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>divide_right_mono</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17545..17550"><span>var_Q</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>9</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_24177..24183"><span>a_ge_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27936..27942">case_1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>9</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27988..27994">case_2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>9</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_28057..28061">True</span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>Sigma_Algebra.space</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M</span></a><span class="main"><span>.</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>/</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>pmf_mono</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>Ï</span></span><span>
      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set_pmf</span><span> </span><span class="main"><span>(</span></span><span>pmf_of_set</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>space</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span class="main"><span>(</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span>  </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>/</span></span><span>  </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22804..22811"><span>Î´'_lt_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>real_sqrt_mult</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power2_eq_square</span><span> </span><span>distrib_left</span><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>45</span></span><span class="main"><span>/</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22652..22659"><span>Î´'_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23347..23354"><span>t_ge_Î´'</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22804..22811"><span>Î´'_lt_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><span>mult_left_mono</span><span> </span><span>real_sqrt_le_mono</span><span class="main"><span>)</span></span><span>
         </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>pos_divide_le_eq</span><span> </span><span class="dynamic"><span class="dynamic"><span>ac_simps</span></span></span><span> </span><span>left_diff_distrib</span><span> </span><span>power_le_one</span><span class="main"><span>)</span></span><span>

       </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>45</span></span><span class="main"><span>/</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span> </span><span class="numeral"><span>46</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
         </span><span class="keyword1"><span class="command"><span>using</span></span></span><span>  </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23064..23071"><span>t_le_Î´'</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22804..22811"><span>Î´'_lt_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22652..22659"><span>Î´'_gt_0</span></a><span>
         </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><span>mult_left_mono</span><span> </span><span>real_sqrt_le_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>pos_divide_le_eq</span><span> </span><span>power_le_one</span><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span class="main"><span>(</span></span><span class="numeral"><span>46</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>45</span></span><span class="main"><span>)</span></span><span class="main"><span>/</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22652..22659"><span>Î´'_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>real_sqrt_divide</span><span> </span><span>diff_divide_distrib</span><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22652..22659"><span>Î´'_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>pos_divide_le_eq</span><span> </span><span>real_le_lsqrt</span><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_29433..29436">aux</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>}</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span> 
        </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23555..23561"><span>m_le_p</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3633..3639"><span>p_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span> </span><span>add_divide_distrib</span><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><span>mult_left_mono</span><span> </span><span>real_sqrt_le_mono</span><span> </span><span>divide_right_mono</span><span class="main"><span>)</span></span><span>
         </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21725..21731"><span>v_def</span></a><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23642..23648"><span>m_ge_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3633..3639"><span>p_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22804..22811"><span>Î´'_lt_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_29433..29436"><span>aux</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>pos_le_divide_eq</span><span class="main"><span>)</span></span><span>   
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3633..3639"><span>p_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23642..23648"><span>m_ge_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23555..23561"><span>m_le_p</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3633..3639"><span>p_gt_0</span></a><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>diff_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>left_diff_distrib</span><span> </span><span>right_diff_distrib</span><span> </span><span>diff_divide_distrib</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span>  </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>      
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>divide_right_mono</span><span> </span><span>mult_left_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21725..21731"><span>v_def</span></a><span class="main"><span>)</span></span><span>

      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span> 
        </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>Â¦</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span>"</span></span></span><span>  
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_24470..24476"><span>v_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_28057..28061"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17473..17478"><span>exp_Q</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.abs_ge_iff|fact"><span>abs_ge_iff</span></a><span class="main"><span>)</span></span><span>

      </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span class="main"><span>â</span></span><span> </span><span>Sigma_Algebra.space</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M</span></a><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
        </span><span class="main"><span>Â¦</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_24470..24476"><span>v_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3633..3639"><span>p_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23642..23648"><span>m_ge_0</span></a><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>Chebyshev_inequality</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>sqrt</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span>  </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_24470..24476"><span>v_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_28057..28061"><span>True</span></a><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>divide_right_mono</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17545..17550"><span>var_Q</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>9</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3633..3639"><span>p_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_24470..24476"><span>v_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23642..23648"><span>m_ge_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power2_eq_square</span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_31819..31824">False</span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>False</span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>pmf_mono</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>Ï</span></span><span>
      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_31935..31936">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>}</span></span><span>"</span></span></span><span>
      </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set_pmf</span><span> </span><span class="main"><span>(</span></span><span>pmf_of_set</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>space</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_32016..32017">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash_range</span></a><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring_carr|fact"><span>mod_ring_carr</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span> </span><span>measure_pmf_inverse</span><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21620..21624"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="skolem"><span>Ï</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17295..17305"><span>Q_def</span></a><span>  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_32016..32017"><span>b</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_31819..31824"><span>False</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4143..4150"><span>as_lt_p</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_mono</span><span> </span><span>subsetI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>force</span></span><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_31935..31936"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>False</span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
      </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>False</span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¬</span></span><span class="skolem"><span>has_no_collision</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span>
    </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>pmf_mono</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21777..21783"><span>has_no_collision_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>force</span></span><span class="main"><span>)</span></span><span> 

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>5</span></span><span class="main"><span>/</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_int</span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_8840..8854"><span>collision_prob</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_24548..24554"><span>v_ge_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>5</span></span><span class="main"><span>/</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_int</span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>divide_right_mono</span><span> </span><span>add_mono</span><span> </span><span>mult_right_mono</span><span> </span><span>mult_mono</span><span> </span><span>power_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17371..17381"><span>m_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>5</span></span><span class="main"><span>/</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21725..21731"><span>v_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_24548..24554"><span>v_ge_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23972..23980"><span>v_ubound</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><span>divide_right_mono</span><span>  </span><span>mult_right_mono</span><span>  </span><span>mult_left_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>40</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3633..3639"><span>p_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23642..23648"><span>m_ge_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3140..3146"><span>t_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span> </span><span>power2_eq_square</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>18</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_20471..20480"><span>t_r_bound</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3487..3494"><span>p_ge_18</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>pos_le_divide_eq</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>9</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_33616..33622">case_3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¬</span></span><span class="skolem"><span>has_no_collision</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>9</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5906..5915"><span>estimate'</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
    </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>â¨</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>â¨</span></span><span> </span><span class="main"><span>Â¬</span></span><span class="main"><span>(</span></span><span class="skolem"><span>has_no_collision</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>pmf_mono</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><span>ccontr</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>Ï</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set_pmf</span><span> </span><span class="main"><span>(</span></span><span>pmf_of_set</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>space</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5906..5915"><span>estimate'</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_34054..34057">est</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5906..5915"><span>estimate'</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¨</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>â¨</span></span><span> </span><span class="main"><span>Â¬</span></span><span> </span><span class="skolem"><span>has_no_collision</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span class="main"><span>(</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â¨</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>â¨</span></span><span> </span><span class="main"><span>Â¬</span></span><span> </span><span class="skolem"><span>has_no_collision</span></span><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_34304..34306">lb</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_34324..34326">ub</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17306..17307"><span>Q</span></a><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_34344..34350">no_col</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>has_no_collision</span></span><span> </span><span class="skolem"><span>Ï</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>

    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_34387..34393">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset|const"><span>nth_mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{#</span></span><span>int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â#</span></span><span> </span><span>mset_set</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>#}</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_34471..34477">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>y'</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset|const"><span>nth_mset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{#</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â#</span></span><span> </span><span>mset_set</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>#}</span></span><span>"</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_34559..34568">rank_t_lb</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_34387..34393"><span>y_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21620..21624"><span>True</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3140..3146"><span>t_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_34304..34306"><span>lb</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset_bound_left|fact"><span>nth_mset_bound_left</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.count_less_def|fact"><span>count_less_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.swap_filter_image|fact"><span>swap_filter_image</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17295..17305"><span>Q_def</span></a><span class="main"><span>)</span></span><span>
  
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_34723..34732">rank_t_ub</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_34387..34393"><span>y_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21620..21624"><span>True</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3140..3146"><span>t_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_34324..34326"><span>ub</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset_bound_right|fact"><span>nth_mset_bound_right</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17295..17305"><span>Q_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.swap_filter_image|fact"><span>swap_filter_image</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.count_le_def|fact"><span>count_le_def</span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_34888..34894">y_ge_0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real_of_int</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_34559..34568"><span>rank_t_lb</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_24177..24183"><span>a_ge_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>mono</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>(</span></span><span>real_of_int</span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down_mono|fact"><span>truncate_down_mono</span></a><span> </span><span>mono_def</span><span> </span><span>of_int_le_iff</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_35076..35081">y'_eq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y'</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_34387..34393"><span>y_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_34471..34477"><span>y'_def</span></a><span>  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21620..21624"><span>True</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3140..3146"><span>t_gt_0</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset_commute_mono|fact"><span>nth_mset_commute_mono</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span class="main"><span class="main"><span class="main"><span>Î»</span></span></span></span><span class="bound"><span class="bound"><span class="bound"><span>x</span></span></span></span><span class="main"><span class="main"><span class="main"><span>.</span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a></a></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a></a></a><span> </span><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>of_int</span><span> </span><span class="bound"><span class="bound"><span class="bound"><span>x</span></span></span></span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>multiset.map_comp</span><span> </span><span>comp_def</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5487..5497"><span>tr_hash_def</span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real_of_int</span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_34559..34568"><span>rank_t_lb</span></a><span> </span><span>of_int_le_iff</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5060..5074"><span>two_pow_r_le_1</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_right_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>y'</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_35076..35081"><span>y'_eq</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.truncate_down_pos|fact"><span>truncate_down_pos</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_34888..34894"><span>y_ge_0</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_35580..35590">rank_t_lb'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>y'</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y'</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real_of_int</span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_35076..35081"><span>y'_eq</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down_le|fact"><span>truncate_down_le</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>v</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_34723..34732"><span>rank_t_ub</span></a><span> </span><span>of_int_le_iff</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_35817..35827">rank_t_ub'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y'</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_24053..24059"><span>a_ge_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5060..5074"><span>two_pow_r_le_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_pos_pos</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_35967..35973">y'_pos</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y'</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_35580..35590"><span>rank_t_lb'</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_36023..36030">no_col'</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="skolem"><span>y'</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>count</span><span> </span><span class="main"><span>{#</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â#</span></span><span> </span><span>mset_set</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>#}</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span>  </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_35817..35827"><span>rank_t_ub'</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_34344..34350"><span>no_col</span></a><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>vimage_def</span><span> </span><span>card_le_Suc0_iff_eq</span><span> </span><span>count_image_mset</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21777..21783"><span>has_no_collision_def</span></a><span class="main"><span>)</span></span><span> </span><span class="operator"><span>force</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_36236..36239">h_1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Max</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>y'</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21620..21624"><span>True</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3140..3146"><span>t_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_36023..36030"><span>no_col'</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5805..5815"><span>sketch_rv'_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_34471..34477"><span>y'_def</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset_max|fact"><span>nth_mset_max</span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least|const"><span>least</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set_mset</span><span> </span><span class="main"><span>{#</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â#</span></span><span> </span><span>mset_set</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>#}</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3140..3146"><span>t_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5805..5815"><span>sketch_rv'_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21620..21624"><span>True</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3140..3146"><span>t_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_36023..36030"><span>no_col'</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.nth_mset_max|fact"><span>nth_mset_max</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_34471..34477"><span>y'_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3140..3146"><span>t_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_36727..36730">h_3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5906..5915"><span>estimate'</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="skolem"><span>y'</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_36236..36239"><span>h_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5895..5905"><span>estimate'_def</span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â¤</span></span><span>  </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22804..22811"><span>Î´'_lt_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17371..17381"><span>m_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21620..21624"><span>True</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3140..3146"><span>t_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22652..22659"><span>Î´'_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>+</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>u</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22652..22659"><span>Î´'_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21674..21680"><span>u_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>/</span></span><span class="numeral"><span>8</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>u</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21620..21624"><span>True</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17371..17381"><span>m_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3140..3146"><span>t_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_24053..24059"><span>a_ge_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_strict_right_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21627..21633"><span>Î´'_def</span></a><span> </span><span>right_diff_distrib</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>u</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22585..22591"><span>r_le_Î´</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_24177..24183"><span>a_ge_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_right_mono</span><span> </span><span>mult_left_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>u</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>y'</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_35580..35590"><span>rank_t_lb'</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>y'</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_37713..37716">f_1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5906..5915"><span>estimate'</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_35967..35973"><span>y'_pos</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_36727..36730"><span>h_3</span></a><span> </span><span>pos_divide_less_eq</span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>y'</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>v</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_35817..35827"><span>rank_t_ub'</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_35967..35973"><span>y'_pos</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_mono</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_35817..35827"><span>rank_t_ub'</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23642..23648"><span>m_ge_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_24548..24554"><span>v_ge_1</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_strict_right_mono</span><span> </span><span>mult_pos_pos</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21627..21633"><span>Î´'_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="skolem"><span>Î´'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22652..22659"><span>Î´'_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22804..22811"><span>Î´'_lt_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21725..21731"><span>v_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22652..22659"><span>Î´'_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_22804..22811"><span>Î´'_lt_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3140..3146"><span>t_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3633..3639"><span>p_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_23642..23648"><span>m_ge_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>y'</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_38536..38539">f_2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5906..5915"><span>estimate'</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17382..17383"><span>m</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_35967..35973"><span>y'_pos</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_36727..36730"><span>h_3</span></a><span> </span><span>pos_less_divide_eq</span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>abs</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5906..5915"><span>estimate'</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_37713..37716"><span>f_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_38536..38539"><span>f_2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>abs_less_iff</span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21382..21390"><span>m_eq_F_0</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>False</span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_34054..34057"><span>est</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>9</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>9</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>9</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>pmf_add_2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_27936..27942"><span>case_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_27988..27994"><span>case_2</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_33616..33622"><span>case_3</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_39042..39047">False</span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5906..5915"><span>estimate'</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span>
    </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>pmf_mono</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>Ï</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_39301..39302">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5906..5915"><span>estimate'</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_39414..39415">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set_pmf</span><span> </span><span class="main"><span>(</span></span><span>pmf_of_set</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>space</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_39459..39460">c</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_39042..39047"><span>False</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>card_image_le</span><span> </span><span>order_le_less_trans</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_39617..39618">d</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5805..5815"><span>sketch_rv'_def</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.card_least|fact"><span>card_least</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>List.finite_set</span><span>  </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_39459..39460"><span>c</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_39617..39618"><span>d</span></a><span> </span><span>card_image_le</span><span>  </span><span>order_le_less_trans</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5906..5915"><span>estimate'</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5895..5905"><span>estimate'_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_39301..39302"><span>a</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2904..2911"><span>Î´_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> 
        </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>abs_zero</span><span> </span><span>cancel_comm_monoid_add_class.diff_cancel</span><span> </span><span>of_nat_less_0_iff</span><span> </span><a class="entity_ref" href="../../HOL/HOL-Decision_Procs/Dense_Linear_Order.html#Dense_Linear_Order.pos_prod_lt|fact"><span>pos_prod_lt</span></a><span> </span><span>zero_less_of_rat_iff</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_17371..17381"><span>m_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21382..21390"><span>m_eq_F_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¬</span></span><span>inj_on</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>card_image</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_39617..39618"><span>d</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_40334..40335">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash_range</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4143..4150"><span>as_lt_p</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_40334..40335"><span>a</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_39414..39415"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring_carr|fact"><span>mod_ring_carr</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down_le|fact"><span>truncate_down_le</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5487..5497"><span>tr_hash_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
   </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>â§</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5498..5505"><span>tr_hash</span></a><span> </span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
     </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>inj_on_def</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>5</span></span><span class="main"><span>/</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3633..3639"><span>p_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_8840..8854"><span>collision_prob</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>5</span></span><span class="main"><span>/</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3633..3639"><span>p_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>ac_simps</span></span></span><span> </span><span>power2_eq_square</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>5</span></span><span class="main"><span>/</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_39042..39047"><span>False</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><span>mult_right_mono</span><span> </span><span>mult_left_mono</span><span> </span><span>power_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>6</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>6</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_20471..20480"><span>t_r_bound</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3487..3494"><span>p_ge_18</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.median_bounds|fact"><span class="entity_def" id="Frequency_Moment_0.median_bounds|thm"><span class="entity_def" id="offset_41339..41352">median_bounds</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>ð«(</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span>measure_pmf</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6022..6025"><a class="entity_ref" href="Frequency_Moment_0.html#offset_6022..6025"><span>Î©<span class="hidden">â©</span><sub>0</sub></span></a></a><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../Median_Method/Median.html#Median.median|const"><span>median</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5677..5685"><span>estimate</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>strict_mono_on</span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.real_of_float|const"><span>real_of_float</span></a><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>A</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.less_float.rep_eq|fact"><span>less_float.rep_eq</span></a><span> </span><span>strict_mono_onI</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_41576..41584">real_g_2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span>  </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.real_of_float|const"><span>real_of_float</span></a><span> </span><span class="main"><span>`</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5805..5815"><span>sketch_rv'_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5564..5574"><span>sketch_rv_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5487..5497"><span>tr_hash_def</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_mono_commute|fact"><span>least_mono_commute</span></a><span> </span><span>image_comp</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.real_of_float|const"><span>real_of_float</span></a><span> </span><span class="skolem"><span>A</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>A</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span>  </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.real_of_float_inject|fact"><span>real_of_float_inject</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>inj_on_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_41850..41857">card_eq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_41576..41584"><span>real_g_2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>card_image</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Max</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.real_of_float|const"><span>real_of_float</span></a><span> </span><span class="main"><span>(</span></span><span>Max</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_42034..42035">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>Ï</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>mono</span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.real_of_float|const"><span>real_of_float</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.less_eq_float.rep_eq|fact"><span>less_eq_float.rep_eq</span></a><span> </span><span>mono_def</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="skolem"><span>Ï</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5564..5574"><span>sketch_rv_def</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_def|fact"><span>least_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="skolem"><span>Ï</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_41850..41857"><span>card_eq</span></a><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span> </span><span>card_gt_0_iff</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3140..3146"><span>t_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_42034..42035"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>force</span></span><span class="main"><span>)</span></span><span>  
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>mono_Max_commute</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.real_of_float|const"><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.real_of_float|const"><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.real_of_float|const"><span>real_of_float</span></a></a></a><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_41576..41584"><span>real_g_2</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_42480..42486">real_g</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5906..5915"><span>estimate'</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5677..5685"><span>estimate</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5666..5676"><span>estimate_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5895..5905"><span>estimate'_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_41850..41857"><span>card_eq</span></a><span> </span><span>of_rat_divide</span><span> </span><span>of_rat_mult</span><span> </span><span>of_rat_add</span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.real_of_rat_of_float|fact"><span>real_of_rat_of_float</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>indep</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>prob_space.indep_vars</span><span> </span><span class="main"><span>(</span></span><span>measure_pmf</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6022..6025"><span>Î©<span class="hidden">â©</span><sub>0</sub></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>borel</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5906..5915"><span>estimate'</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6011..6021"><span>Î©<span class="hidden">â©</span><sub>0</sub>_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.indep_vars_restrict_intro&apos;|fact"><span>indep_vars_restrict_intro'</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl_def|fact"><span>restrict_dfl_def</span></a><span> </span><span>lessThan_atLeast0</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>of_nat_ceiling</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3199..3209"><span>s_def</span></a><span class="main"><span>)</span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>â¹</span></span><span> </span><span>measure</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6022..6025"><span>Î©<span class="hidden">â©</span><sub>0</sub></span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>of_rat</span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5906..5915"><span>estimate'</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>i</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_21462..21478"><span>estimate'_bounds</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6011..6021"><span>Î©<span class="hidden">â©</span><sub>0</sub>_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>M_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prob_prod_pmf_slice|fact"><span>prob_prod_pmf_slice</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
 
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="keyword1"><span>ð«(</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span>measure_pmf</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6022..6025"><a class="entity_ref" href="Frequency_Moment_0.html#offset_6022..6025"><span>Î©<span class="hidden">â©</span><sub>0</sub></span></a></a><span class="main"><span>.</span></span><span>
      </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../Median_Method/Median.html#Median.median|const"><span>median</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5906..5915"><span>estimate'</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5816..5826"><span>sketch_rv'</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span>  </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2870..2877"><span>Îµ_range</span></a><span> </span><span>prob_space_measure_pmf</span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../Median_Method/Median.html#Median.prob_space.median_bound_2|fact"><span>prob_space.median_bound_2</span></a><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>ð«(</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span>measure_pmf</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6022..6025"><a class="entity_ref" href="Frequency_Moment_0.html#offset_6022..6025"><span>Î©<span class="hidden">â©</span><sub>0</sub></span></a></a><span class="main"><span>.</span></span><span> 
      </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../Median_Method/Median.html#Median.median|const"><span>median</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5677..5685"><span>estimate</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span>  </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3271..3277"><span>s_gt_0</span></a><span> </span><a class="entity_ref" href="../Median_Method/Median.html#Median.median_rat|fact"><span>median_rat</span></a><span class="main"><span>[</span></span><span class="operator"><span>symmetric</span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_42480..42486"><span>real_g</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>arg_cong2</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>measure</span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>of_rat_diff</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>of_rat_mult</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>of_rat_less_eq</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>ð«(</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span>measure_pmf</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6022..6025"><a class="entity_ref" href="Frequency_Moment_0.html#offset_6022..6025"><span>Î©<span class="hidden">â©</span><sub>0</sub></span></a></a><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../Median_Method/Median.html#Median.median|const"><span>median</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5677..5685"><span>estimate</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.f0_alg_correct&apos;|fact"><span class="entity_def" id="Frequency_Moment_0.f0_alg_correct&apos;|thm"><span>f0_alg_correct'</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>ð«(</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span>measure_pmf</span><span> </span><span class="free"><span class="free"><span>result</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_rat</span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_44047..44061">f0_result_elim</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_result|const"><span>f0_result</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>,</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Median_Method/Median.html#Median.median|const"><span>median</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5677..5685"><span>estimate</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5666..5676"><span>estimate_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../Median_Method/Median.html#Median.median_cong|fact"><span>median_cong</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
 
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>result</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>,</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6022..6025"><span>Î©<span class="hidden">â©</span><sub>0</sub></span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_result|const"><span>f0_result</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_2776..2783"><span>result_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6094..6107"><span>f0_alg_sketch</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6022..6025"><span>Î©<span class="hidden">â©</span><sub>0</sub></span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>,</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_result|const"><span>f0_result</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3072..3082"><span>t_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3330..3340"><span>p_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4366..4376"><span>r_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3199..3209"><span>s_def</span></a><span> </span><span>map_pmf_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6022..6025"><span>Î©<span class="hidden">â©</span><sub>0</sub></span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Median_Method/Median.html#Median.median|const"><span>median</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5677..5685"><span>estimate</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>bind_assoc_pmf</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><span>bind_return_pmf</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_44047..44061"><span>f0_result_elim</span></a><span class="main"><span>)</span></span><span>  </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_44722..44723">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>result</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6022..6025"><span>Î©<span class="hidden">â©</span><sub>0</sub></span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Median_Method/Median.html#Median.median|const"><span>median</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5677..5685"><span>estimate</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_41339..41352"><span>median_bounds</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_44722..44723"><span>a</span></a><span> </span><span>map_pmf_def</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_44908..44913">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.f_subset|fact"><span class="entity_def" id="Frequency_Moment_0.f_subset|thm"><span class="entity_def" id="offset_44914..44922">f_subset</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>g</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="free"><span>h</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>B</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>h</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="free"><span>B</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_44908..44913"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_45021..45026">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.f0_exact_space_usage&apos;|fact"><span class="entity_def" id="Frequency_Moment_0.f0_exact_space_usage&apos;|thm"><span>f0_exact_space_usage'</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Î©</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>state</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>state</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_update|const"><span>f0_update</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_init|const"><span>f0_init</span></a><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>AE</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>Î©</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.encode_f0_state|const"><span>encode_f0_state</span></a><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_space_usage|const"><span>f0_space_usage</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_45218..45225">log_2_4</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>log2_of_power_eq</span><span> </span><span>mult_2</span><span> </span><span>numeral_Bit0</span><span> </span><span>of_nat_numeral</span><span> </span><span>power2_eq_square</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_45334..45335">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e|const"><span>F<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.float_of|const"><span>float_of</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
    </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>12</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>+</span></span><span class="numeral"><span>13</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_45447..45450">a_1</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>y</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_45503..45507">True</span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_45518..45523">aux_1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_45503..45507"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_pos_nonneg</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_45610..45615">aux_2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3685..3691"><span>p_gt_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_pos_nonneg</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e|const"><span>F<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.float_of|const"><span>float_of</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
      </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>10</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>Â¦</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>Â¦</span></span><span>real</span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.truncate_float_bit_count|fact"><span>truncate_float_bit_count</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>10</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_45503..45507"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>10</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_45518..45523"><span>aux_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_45610..45615"><span>aux_2</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_45503..45507"><span>True</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3633..3639"><span>p_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_45447..45450"><span>a_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>10</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>40</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_45218..45225"><span>log_2_4</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3918..3924"><span>p_le_n</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3633..3639"><span>p_gt_0</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.ereal_mono|fact"><span>ereal_mono</span></a><span> </span><span>add_mono</span><span> </span><span>mult_left_mono</span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.log_mono|fact"><span>log_mono</span></a><span> </span><span>of_nat_mono</span><span> </span><span>add_pos_nonneg</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>10</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>8</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>160</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>log_mult</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>10</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>+</span></span><span class="numeral"><span>13</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.ereal_mono|fact"><span>ereal_mono</span></a><span> </span><span>add_mono</span><span> </span><span>mult_left_mono</span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.log_mono|fact"><span>log_mono</span></a><span> </span><span>of_nat_mono</span><span> </span><span>add_pos_nonneg</span><span class="main"><span>)</span></span><span>
       </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power2_eq_square</span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>10</span></span><span> </span><span class="main"><span>+</span></span><span>  </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>13</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>log_powr</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_45218..45225"><span>log_2_4</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>12</span></span><span> </span><span class="main"><span>+</span></span><span>  </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>13</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>log_mult</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_45218..45225"><span>log_2_4</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_45447..45450"><span>a_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.float_bit_count_zero|fact"><span>float_bit_count_zero</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.encode_f0_state|const"><span>encode_f0_state</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
        </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_space_usage|const"><span>f0_space_usage</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_47181..47182">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>}</span></span><span> </span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>E</sub></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>space</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_47232..47233">c</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>extensional</span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_47181..47182"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>PiE_def</span><span class="main"><span>)</span></span><span> 

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_47301..47302">d</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.float_of|const"><span>float_of</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>}</span></span><span> </span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_47378..47381">d_1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>y</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>xa</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.float_of|const"><span>float_of</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash</span></a><span> </span><span class="bound"><span>xa</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_subset|fact"><span>least_subset</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5564..5574"><span>sketch_rv_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5487..5497"><span>tr_hash_def</span></a><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.float_of|const"><span>float_of</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>}</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_47181..47182"><span>b</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>hash_range</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4143..4150"><span>as_lt_p</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_47378..47381"><span>d_1</span></a><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_44914..44922"><span>f_subset</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>Î»</span></span></span></span><span class="bound"><span class="bound"><span class="bound"><span>x</span></span></span></span><span class="main"><span class="main"><span class="main"><span>.</span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.float_of|const"><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.float_of|const"><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.float.float_of|const"><span>float_of</span></a></a></a><span> </span><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><a class="entity_ref" href="../../HOL/HOL-Library/Float.html#Float.truncate_down|const"><span>truncate_down</span></a></a></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a></a></a><span> </span><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>real</span><span> </span><span class="bound"><span class="bound"><span class="bound"><span>x</span></span></span></span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>image_subsetI</span><span class="main"><span>)</span></span><span>
         </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>PiE_iff</span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring_carr|fact"><span>mod_ring_carr</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>â¹</span></span><span> </span><span>finite</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5564..5574"><span>sketch_rv_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>finite_subset</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.least_subset|fact"><span>least_subset</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>card_sketch</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>â¹</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5564..5574"><span>sketch_rv_def</span></a><span> </span><a class="entity_ref" href="K_Smallest.html#K_Smallest.card_least|fact"><span>card_least</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span> 
      </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e|const"><span>F<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="bound"><span>z</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>12</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>13</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_45334..45335"><span>a</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_47301..47302"><span>d</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_48302..48303">e</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.S\&lt;^sub&gt;e|const"><span>S<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e|const"><span>F<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>12</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>13</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.float_encoding|fact"><span>float_encoding</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.set_bit_count_est|fact"><span>set_bit_count_est</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_48525..48526">f</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.P\&lt;^sub&gt;e|const"><span>P<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3685..3691"><span>p_gt_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_47181..47182"><span>b</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.bounded_degree_polynomial_bit_count|fact"><span>bounded_degree_polynomial_bit_count</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5252..5266"><span>space_def</span></a><span> </span><span>PiE_def</span><span> </span><span>Pi_def</span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.encode_f0_state|const"><span>encode_f0_state</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>  </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>
      </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.P\&lt;^sub&gt;e|const"><span>P<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>
      </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.S\&lt;^sub&gt;e|const"><span>S<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.F\&lt;^sub&gt;e|const"><span>F<span class="hidden">â©</span><sub>e</sub></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.encode_f0_state_def|fact"><span>encode_f0_state_def</span></a><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.dependent_bit_count|fact"><span>dependent_bit_count</span></a><span> </span><span>lessThan_atLeast0</span><span>
        </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3199..3209"><span>s_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3072..3082"><span>t_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3330..3340"><span>p_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4366..4376"><span>r_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>ac_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ereal</span><span>  </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>+</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
      </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> 
            </span><span class="main"><span>(</span></span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>12</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>13</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_47232..47233"><span>c</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_48302..48303"><span>e</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_48525..48526"><span>f</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.exp_golomb_bit_count|fact"><span>exp_golomb_bit_count</span></a><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.fun_bit_count_est|fact"><span>fun_bit_count_est</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> xs</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span><span class="main"><span class="main"><span class="main"><span>0</span></span></span></span><span class="main"><span class="main"><span class="main"><span>..&lt;</span></span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a></a></a><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
       </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>lessThan_atLeast0</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> 
      </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> 
      </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>13</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>13</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>  </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> 
      </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>21</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>21</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> 
      </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>13</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>13</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3918..3924"><span>p_le_n</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3633..3639"><span>p_gt_0</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.ereal_mono|fact"><span>ereal_mono</span></a><span> </span><span>add_mono</span><span> </span><span>mult_left_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>6</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> 
      </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>21</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>5</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>21</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> 
      </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>13</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>13</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>1 2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>log_mult</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_space_usage|const"><span>f0_space_usage</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3199..3209"><span>s_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4366..4376"><span>r_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3072..3082"><span>t_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>Let_def</span><span class="main"><span>)</span></span><span>
       </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.encode_f0_state|const"><span>encode_f0_state</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
        </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_space_usage|const"><span>f0_space_usage</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set_pmf</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6022..6025"><span>Î©<span class="hidden">â©</span><sub>0</sub></span></a><span> </span><span class="main"><span>â¹</span></span><span>
         </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.encode_f0_state|const"><span>encode_f0_state</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3083..3084"><span>t</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3341..3342"><span>p</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_4377..4378"><span>r</span></a><span class="main"><span>,</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_3210..3211"><span>s</span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_5575..5584"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>  </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_space_usage|const"><span>f0_space_usage</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6011..6021"><span>Î©<span class="hidden">â©</span><sub>0</sub>_def</span></a><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.set_prod_pmf|fact"><span>set_prod_pmf</span></a><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_space_usage.simps|fact"><span>f0_space_usage.simps</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set_pmf</span><span> </span><span class="free"><span>Î©</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.encode_f0_state|const"><span>encode_f0_state</span></a><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_space_usage|const"><span>f0_space_usage</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_45021..45026"><span>Î©_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_6094..6107"><span>f0_alg_sketch</span></a><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_space_usage.simps|fact"><span>f0_space_usage.simps</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_init.simps|fact"><span>f0_init.simps</span></a><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>image_iff</span><span> </span><span>pmf.set_map</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>AE_measure_pmf_iff</span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_space_usage.simps|fact"><span>f0_space_usage.simps</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Main results of this section:</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_51488..51495">theorem</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.f0_alg_correct|fact"><span class="entity_def" id="Frequency_Moment_0.f0_alg_correct|thm"><span>f0_alg_correct</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>&lt;..&lt;</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>&lt;..&lt;</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>set</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Î©</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>state</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>state</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_update|const"><span>f0_update</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_init|const"><span>f0_init</span></a><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_result|const"><span>f0_result</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>ð«(</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span>measure_pmf</span><span> </span><span class="free"><span class="free"><span>Î©</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>0</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_rat</span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_alg_correct&apos;|fact"><span>f0_alg_correct'</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_51488..51495"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1-3</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_51488..51495"><span>Î©_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_51813..51820">theorem</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.f0_exact_space_usage|fact"><span class="entity_def" id="Frequency_Moment_0.f0_exact_space_usage|thm"><span>f0_exact_space_usage</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>&lt;..&lt;</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>&lt;..&lt;</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>set</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Î©</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>state</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>state</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_update|const"><span>f0_update</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_init|const"><span>f0_init</span></a><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>AE</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>Î©</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.encode_f0_state|const"><span>encode_f0_state</span></a><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_space_usage|const"><span>f0_space_usage</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_exact_space_usage&apos;|fact"><span>f0_exact_space_usage'</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_51813..51820"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1-3</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_51813..51820"><span>Î©_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

</span><span class="keyword1"><span class="command"><span>theorem</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_0.f0_asympotic_space_complexity|fact"><span class="entity_def" id="Frequency_Moment_0.f0_asympotic_space_complexity|thm"><span>f0_asympotic_space_complexity</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_space_usage|const"><span>f0_space_usage</span></a><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span>at_top</span><span> </span><span class="keyword1"><span>Ã<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span>at_right</span><span> </span><span class="main"><span>0</span></span><span> </span><span class="keyword1"><span>Ã<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span>at_right</span><span> </span><span class="main"><span>0</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>of_rat</span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> 
  </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>of_rat</span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>of_rat</span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>_</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="var"><span>?rhs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_52387..52393">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>n_of</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>n_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_52459..52465">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>Îµ_of</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>rat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_52531..52537">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>Î´_of</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>rat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_52603..52609">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>t_of</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>t_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="numeral"><span>80</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_52674..52680">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>s_of</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>s_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_52749..52755">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>r_of</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>23</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_52835..52841">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>g</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> 
    </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_53004..53007">evt</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> 
    </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â§</span></span><span> 
    </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="skolem"><span>Î´</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="skolem"><span>Îµ</span></span><span> </span><span class="main"><span>â§</span></span><span>
    </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>eventually</span><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="var"><span>?F</span></span><span>"</span></span></span><span>  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="var"><span>?prem</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>_</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>Î´</span></span><span> </span><span class="skolem"><span>Îµ</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="skolem"><span>P</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>eventually_mono</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> P</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span class="var"><span>?prem</span></span></span><span>"</span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> Q</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span class="skolem"><span>P</span></span></span><span>"</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52459..52465"><span>Îµ_of_def</span></a><span> </span><span>case_prod_beta'</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52531..52537"><span>Î´_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52387..52393"><span>n_of_def</span></a><span class="main"><span>)</span></span><span>
     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>eventually_conj</span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.eventually_prod1&apos;|fact"><span>eventually_prod1'</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.eventually_prod2&apos;|fact"><span>eventually_prod2'</span></a><span> 
        </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.sequentially_inf|fact"><span>sequentially_inf</span></a><span> </span><span>eventually_at_right_less</span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.inv_at_right_0_inf|fact"><span>inv_at_right_0_inf</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>prod_filter_eq_bot</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_53546..53553">exp_pos</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>exp</span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>exp_gt_zero</span><span> </span><span>gr0I</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span> 

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_53633..53641">exp_gt_1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>exp</span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>::</span></span><span>real</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_53683..53684">1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> Îµ</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>exp</span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>iffD2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>ln_ge_iff</span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.abs_ge_iff|fact"><span>abs_ge_iff</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_53847..53848">2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> Î´</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>exp</span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>iffD2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>ln_ge_iff</span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.abs_ge_iff|fact"><span>abs_ge_iff</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_54012..54013">3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53546..53553"><span>exp_pos</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_sum_2|fact"><span>landau_sum_2</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53847..53848"><span>2</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>exp</span><span> </span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> Î´</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>ln_ge_zero</span><span>  </span><span>iffD2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>ln_ge_iff</span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_54219..54220">4</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>one_le_power</span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> Î´</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power_one_over</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>80</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big.cmult_in_iff|fact"><span>landau_o.big.cmult_in_iff</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_54538..54539">5</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>t_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span>  </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52603..52609"><span>t_of_def</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_real_nat|fact"><span>landau_real_nat</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ceil|fact"><span>landau_ceil</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_54219..54220"><span>4</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> Îµ</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>ln_div</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_54846..54847">6</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>s_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52674..52680"><span>s_of_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_nat_ceil|fact"><span>landau_nat_ceil</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53683..53684"><span>1</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_54980..54981">7</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53546..53553"><span>exp_pos</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>exp</span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>iffD2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>ln_ge_iff</span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.abs_ge_iff|fact"><span>abs_ge_iff</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_55146..55147">8</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> 
    </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>order_trans</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53633..53641"><span>exp_gt_1</span></a><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53546..53553"><span>exp_pos</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_sum_1|fact"><span>landau_sum_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_54980..54981"><span>7</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>exp</span><span> </span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> Î´</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>ln_ge_zero</span><span>  </span><span>iffD2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>ln_ge_iff</span><span class="main"><span class="main"><span>]</span></span></span><span> 
        </span><span>mult_nonneg_nonneg</span><span> </span><span>add_nonneg_nonneg</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>s_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ln_3|fact"><span>landau_ln_3</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_54846..54847"><span>6</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53683..53684"><span>1</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_55614..55615">9</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>s_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52835..52841"><span>g_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1|fact"><span>landau_o.big_mult_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_55146..55147"><span>8</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span>log_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_55741..55743">10</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52835..52841"><span>g_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1|fact"><span>landau_o.big_mult_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_55146..55147"><span>8</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53683..53684"><span>1</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>t_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> 
    </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_54538..54539"><span>5</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1|fact"><span>landau_o.big_mult_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_54012..54013"><span>3</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ln_3|fact"><span>landau_ln_3</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_54219..54220"><span>4</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>t_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> 
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>order_trans</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53633..53641"><span>exp_gt_1</span></a><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53546..53553"><span>exp_pos</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_sum_2|fact"><span>landau_sum_2</span></a><span>  </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>exp</span><span> </span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> Î´</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>ln_ge_zero</span><span>  </span><span>iffD2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>ln_ge_iff</span><span class="main"><span class="main"><span>]</span></span></span><span> 
        </span><span>mult_nonneg_nonneg</span><span> </span><span>add_nonneg_nonneg</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>log_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_56430..56432">11</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>t_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52835..52841"><span>g_def</span></a><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1&apos;|fact"><span>landau_o.big_mult_1'</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53683..53684"><span>1</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>21</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ln_2|fact"><span>landau_ln_2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> a</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span class="numeral"><span class="numeral"><span>2</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span class="numeral"><span class="numeral"><span>2</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_56799..56801">12</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>21</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52835..52841"><span>g_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53546..53553"><span>exp_pos</span></a><span> </span><span>order_trans</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53633..53641"><span>exp_gt_1</span></a><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1&apos;|fact"><span>landau_o.big_mult_1'</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53683..53684"><span>1</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_sum_1|fact"><span>landau_sum_1</span></a><span>  </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>exp</span><span> </span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> Î´</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> 
        </span><span>ln_ge_zero</span><span>  </span><span>iffD2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>ln_ge_iff</span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>mult_nonneg_nonneg</span><span> </span><span>add_nonneg_nonneg</span><span class="main"><span>)</span></span><span>  </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>log_def</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ln_3|fact"><span>landau_ln_3</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> Î´</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span class="main"><span>)</span></span><span> 
      </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power_one_over</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>self_le_power</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span class="main"><span>*</span></span><span class="main"><span>â</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span class="main"><span>+</span></span><span class="numeral"><span>23</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_54219..54220"><span>4</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_real_nat|fact"><span>landau_real_nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ceil|fact"><span>landau_ceil</span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span>log_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52749..52755"><span>r_of_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ln_3|fact"><span>landau_ln_3</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_54219..54220"><span>4</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> 
    </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1|fact"><span>landau_o.big_mult_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_54012..54013"><span>3</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>log_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> 
    </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53546..53553"><span>exp_pos</span></a><span> </span><span>order_trans</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53633..53641"><span>exp_gt_1</span></a><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_sum_2|fact"><span>landau_sum_2</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>exp</span><span> </span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> Î´</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>ln_ge_zero</span><span>  
        </span><span>iffD2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>ln_ge_iff</span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>add_nonneg_nonneg</span><span> </span><span>mult_nonneg_nonneg</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_58228..58230">13</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52835..52841"><span>g_def</span></a><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1&apos;|fact"><span>landau_o.big_mult_1'</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53683..53684"><span>1</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_58345..58347">14</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>13</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_58345..58347"><span>14</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ln_2|fact"><span>landau_ln_2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> a</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span class="numeral"><span class="numeral"><span>2</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span>  </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span class="numeral"><span class="numeral"><span>2</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>13</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53546..53553"><span>exp_pos</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ln_2|fact"><span>landau_ln_2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> a</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span class="numeral"><span class="numeral"><span>2</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>iffD2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>ln_ge_iff</span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>exp</span><span> </span><span class="numeral"><span class="numeral"><span class="numeral"><span>2</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>log_def</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>13</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53546..53553"><span>exp_pos</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_sum_1|fact"><span>landau_sum_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>exp</span><span> </span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> Î´</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>ln_ge_zero</span><span>  </span><span>iffD2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>ln_ge_iff</span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>log_def</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52749..52755"><span>r_of_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53847..53848"><span>2</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_real_nat|fact"><span>landau_real_nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ceil|fact"><span>landau_ceil</span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span>log_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53546..53553"><span>exp_pos</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_sum_2|fact"><span>landau_sum_2</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>exp</span><span> </span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> Î´</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>ln_ge_zero</span><span>  </span><span>iffD2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>ln_ge_iff</span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_59492..59494">15</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>t_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>13</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>13</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_54538..54539"><span>5</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_54012..54013"><span>3</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.mult|fact"><span>landau_o.mult</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>5</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>21</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>t_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>13</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>13</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="var"><span>?F</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>ln_ge_zero</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="var"><span>?F</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53546..53553"><span>exp_pos</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>exp</span><span> </span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> Î´</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>mult_nonneg_nonneg</span><span> </span><span>add_nonneg_nonneg</span><span> 
          </span><span>ln_ge_zero</span><span> </span><span>iffD2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>ln_ge_iff</span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>21</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_58345..58347"><span>14</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ln_2|fact"><span>landau_ln_2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> a</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span class="numeral"><span class="numeral"><span>2</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_53004..53007"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span class="numeral"><span class="numeral"><span>2</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>5</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>21</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_54980..54981"><span>7</span></a><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>log_def</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_59492..59494"><span>15</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_sum|fact"><span>landau_sum</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_60802..60804">16</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>s_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>5</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>21</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>t_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span>
    </span><span class="main"><span>(</span></span><span class="numeral"><span>13</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>13</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>  </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52835..52841"><span>g_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.mult|fact"><span>landau_o.mult</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_54846..54847"><span>6</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_space_usage|const"><span>f0_space_usage</span></a><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#Frequency_Moment_0.f0_space_usage|const"><span>f0_space_usage</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>case_prod_beta'</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52387..52393"><span>n_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52459..52465"><span>Îµ_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52531..52537"><span>Î´_of_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â</span></span><span>  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_55614..55615"><span>9</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_55741..55743"><span>10</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_56430..56432"><span>11</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_56799..56801"><span>12</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_58228..58230"><span>13</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_60802..60804"><span>16</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>fun_cong</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52674..52680"><span>s_of_def</span></a><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>fun_cong</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52603..52609"><span>t_of_def</span></a><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> 
        </span><span>fun_cong</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52749..52755"><span>r_of_def</span></a><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>Let_def</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="var"><span>?rhs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>case_prod_beta'</span><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52835..52841"><span>g_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52387..52393"><span>n_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52459..52465"><span>Îµ_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_0.html#offset_52531..52537"><span>Î´_of_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre></div><div id='Frequency_Moment_k'>


<body>
<div class="head">
<h1>Theory Frequency_Moment_2</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Frequency Moment $2$</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Frequency_Moment_2</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span>
    </span><a href="../Universal_Hash_Families/Carter_Wegman_Hash_Family.html"><span>Universal_Hash_Families.Carter_Wegman_Hash_Family</span></a><span>
    </span><a href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html"><span>Equivalence_Relation_Enumeration.Equivalence_Relation_Enumeration</span></a><span>
    </span><a href="Landau_Ext.html"><span>Landau_Ext</span></a><span>
    </span><a href="../Median_Method/Median.html"><span>Median_Method.Median</span></a><span>
    </span><a href="Product_PMF_Ext.html"><span>Product_PMF_Ext</span></a><span>
    </span><a href="../Universal_Hash_Families/Field.html"><span>Universal_Hash_Families.Field</span></a><span>
    </span><a href="Frequency_Moments.html"><span>Frequency_Moments</span></a><span> 
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>This section contains a formalization of the algorithm for the second frequency moment.
</span><span>It is based on the algorithm described in \cite[\textsection 2.2]{alon1999}.
</span><span>The only difference is that the algorithm is adapted to work with prime field of odd order, which
</span><span>greatly reduces the implementation complexity.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_2.f2_hash.elims|fact"><span class="entity_def" id="Frequency_Moment_2.f2_hash.induct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_hash.simps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_hash.pelims|fact"><span class="entity_def" id="Frequency_Moment_2.f2_hash.cases|fact"><span class="entity_def" id="Frequency_Moment_2.f2_hash.termination|fact"><span class="entity_def" id="Frequency_Moment_2.f2_hash.pinduct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_hash.psimps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_hash_rel.inducts|fact"><span class="entity_def" id="Frequency_Moment_2.f2_hash_rel.simps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_hash_rel.induct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_hash_rel.cases|fact"><span class="entity_def" id="Frequency_Moment_2.f2_hash_rel.intros|fact"><span class="entity_def" id="Frequency_Moment_2.f2_hash_graph.inducts|fact"><span class="entity_def" id="Frequency_Moment_2.f2_hash_graph.simps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_hash_graph.induct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_hash_graph.cases|fact"><span class="entity_def" id="Frequency_Moment_2.f2_hash_graph.intros|fact"><span class="entity_def" id="Frequency_Moment_2.f2_hash.elims|thm"><span class="entity_def" id="Frequency_Moment_2.f2_hash.induct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_hash.simps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_hash.pelims|thm"><span class="entity_def" id="Frequency_Moment_2.f2_hash.cases|thm"><span class="entity_def" id="Frequency_Moment_2.f2_hash.termination|thm"><span class="entity_def" id="Frequency_Moment_2.f2_hash.pinduct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_hash.psimps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_hash_rel.inducts|thm"><span class="entity_def" id="Frequency_Moment_2.f2_hash_rel.simps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_hash_rel.induct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_hash_rel.cases|thm"><span class="entity_def" id="Frequency_Moment_2.f2_hash_graph.inducts|thm"><span class="entity_def" id="Frequency_Moment_2.f2_hash_graph.simps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_hash_graph.induct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_hash_graph.cases|thm"><span class="entity_def" id="Frequency_Moment_2.f2_hash_graph.intros|thm"><span class="entity_def" id="Frequency_Moment_2.f2_hash_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_hash_rel_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_hash_sumC_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_hash_graph_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_hash_dom|const"><span class="entity_def" id="Frequency_Moment_2.f2_hash_rel|const"><span class="entity_def" id="Frequency_Moment_2.f2_hash_sumC|const"><span class="entity_def" id="Frequency_Moment_2.f2_hash_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f2_hash</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span>even</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Universal_Hash_Families/Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.ring.hash|const"><span>ring.hash</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span>int</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>int</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>type_synonym</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.f2_state|type"><span>f2_state</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span>list</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>int</span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_2.f2_init.elims|fact"><span class="entity_def" id="Frequency_Moment_2.f2_init.induct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_init.simps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_init.pelims|fact"><span class="entity_def" id="Frequency_Moment_2.f2_init.cases|fact"><span class="entity_def" id="Frequency_Moment_2.f2_init.termination|fact"><span class="entity_def" id="Frequency_Moment_2.f2_init.pinduct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_init.psimps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_init_rel.inducts|fact"><span class="entity_def" id="Frequency_Moment_2.f2_init_rel.simps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_init_rel.induct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_init_rel.cases|fact"><span class="entity_def" id="Frequency_Moment_2.f2_init_rel.intros|fact"><span class="entity_def" id="Frequency_Moment_2.f2_init_graph.inducts|fact"><span class="entity_def" id="Frequency_Moment_2.f2_init_graph.simps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_init_graph.induct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_init_graph.cases|fact"><span class="entity_def" id="Frequency_Moment_2.f2_init_graph.intros|fact"><span class="entity_def" id="Frequency_Moment_2.f2_init.elims|thm"><span class="entity_def" id="Frequency_Moment_2.f2_init.induct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_init.simps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_init.pelims|thm"><span class="entity_def" id="Frequency_Moment_2.f2_init.cases|thm"><span class="entity_def" id="Frequency_Moment_2.f2_init.termination|thm"><span class="entity_def" id="Frequency_Moment_2.f2_init.pinduct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_init.psimps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_init_rel.inducts|thm"><span class="entity_def" id="Frequency_Moment_2.f2_init_rel.simps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_init_rel.induct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_init_rel.cases|thm"><span class="entity_def" id="Frequency_Moment_2.f2_init_graph.inducts|thm"><span class="entity_def" id="Frequency_Moment_2.f2_init_graph.simps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_init_graph.induct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_init_graph.cases|thm"><span class="entity_def" id="Frequency_Moment_2.f2_init_graph.intros|thm"><span class="entity_def" id="Frequency_Moment_2.f2_init_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_init_rel_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_init_sumC_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_init_graph_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_init_dom|const"><span class="entity_def" id="Frequency_Moment_2.f2_init_rel|const"><span class="entity_def" id="Frequency_Moment_2.f2_init_sumC|const"><span class="entity_def" id="Frequency_Moment_2.f2_init_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_2.f2_init|const"><span>f2_init</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>rat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_state|type"><span>f2_state</span></a><span> </span><span>pmf</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f2_init</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Î´</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Îµ</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="numeral"><span>6</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Î´</span></span></span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>â</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Îµ</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>p</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above|const"><span>prime_above</span></a><span> </span><span class="main"><span>(</span></span><span>max</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="numeral"><span>3</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span class="bound"><span>h</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{..&lt;</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>pmf_of_set</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials|const"><span>bounded_degree_polynomials</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>p</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>h</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>int</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_2.f2_update.elims|fact"><span class="entity_def" id="Frequency_Moment_2.f2_update.induct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_update.simps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_update.pelims|fact"><span class="entity_def" id="Frequency_Moment_2.f2_update.cases|fact"><span class="entity_def" id="Frequency_Moment_2.f2_update.termination|fact"><span class="entity_def" id="Frequency_Moment_2.f2_update.pinduct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_update.psimps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_update_rel.inducts|fact"><span class="entity_def" id="Frequency_Moment_2.f2_update_rel.simps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_update_rel.induct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_update_rel.cases|fact"><span class="entity_def" id="Frequency_Moment_2.f2_update_rel.intros|fact"><span class="entity_def" id="Frequency_Moment_2.f2_update_graph.inducts|fact"><span class="entity_def" id="Frequency_Moment_2.f2_update_graph.simps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_update_graph.induct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_update_graph.cases|fact"><span class="entity_def" id="Frequency_Moment_2.f2_update_graph.intros|fact"><span class="entity_def" id="Frequency_Moment_2.f2_update.elims|thm"><span class="entity_def" id="Frequency_Moment_2.f2_update.induct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_update.simps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_update.pelims|thm"><span class="entity_def" id="Frequency_Moment_2.f2_update.cases|thm"><span class="entity_def" id="Frequency_Moment_2.f2_update.termination|thm"><span class="entity_def" id="Frequency_Moment_2.f2_update.pinduct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_update.psimps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_update_rel.inducts|thm"><span class="entity_def" id="Frequency_Moment_2.f2_update_rel.simps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_update_rel.induct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_update_rel.cases|thm"><span class="entity_def" id="Frequency_Moment_2.f2_update_graph.inducts|thm"><span class="entity_def" id="Frequency_Moment_2.f2_update_graph.simps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_update_graph.induct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_update_graph.cases|thm"><span class="entity_def" id="Frequency_Moment_2.f2_update_graph.intros|thm"><span class="entity_def" id="Frequency_Moment_2.f2_update_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_update_rel_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_update_sumC_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_update_graph_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_update_dom|const"><span class="entity_def" id="Frequency_Moment_2.f2_update_rel|const"><span class="entity_def" id="Frequency_Moment_2.f2_update_sumC|const"><span class="entity_def" id="Frequency_Moment_2.f2_update_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_2.f2_update|const"><span>f2_update</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_state|type"><span>f2_state</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_state|type"><span>f2_state</span></a><span> </span><span>pmf</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f2_update</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>1</sub></span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>2</sub></span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>sketch</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>1</sub></span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>2</sub></span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>1</sub></span></span></span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>2</sub></span></span></span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>sketch</span></span></span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_2.f2_result.elims|fact"><span class="entity_def" id="Frequency_Moment_2.f2_result.induct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_result.simps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_result.pelims|fact"><span class="entity_def" id="Frequency_Moment_2.f2_result.cases|fact"><span class="entity_def" id="Frequency_Moment_2.f2_result.termination|fact"><span class="entity_def" id="Frequency_Moment_2.f2_result.pinduct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_result.psimps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_result_rel.inducts|fact"><span class="entity_def" id="Frequency_Moment_2.f2_result_rel.simps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_result_rel.induct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_result_rel.cases|fact"><span class="entity_def" id="Frequency_Moment_2.f2_result_rel.intros|fact"><span class="entity_def" id="Frequency_Moment_2.f2_result_graph.inducts|fact"><span class="entity_def" id="Frequency_Moment_2.f2_result_graph.simps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_result_graph.induct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_result_graph.cases|fact"><span class="entity_def" id="Frequency_Moment_2.f2_result_graph.intros|fact"><span class="entity_def" id="Frequency_Moment_2.f2_result.elims|thm"><span class="entity_def" id="Frequency_Moment_2.f2_result.induct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_result.simps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_result.pelims|thm"><span class="entity_def" id="Frequency_Moment_2.f2_result.cases|thm"><span class="entity_def" id="Frequency_Moment_2.f2_result.termination|thm"><span class="entity_def" id="Frequency_Moment_2.f2_result.pinduct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_result.psimps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_result_rel.inducts|thm"><span class="entity_def" id="Frequency_Moment_2.f2_result_rel.simps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_result_rel.induct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_result_rel.cases|thm"><span class="entity_def" id="Frequency_Moment_2.f2_result_graph.inducts|thm"><span class="entity_def" id="Frequency_Moment_2.f2_result_graph.simps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_result_graph.induct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_result_graph.cases|thm"><span class="entity_def" id="Frequency_Moment_2.f2_result_graph.intros|thm"><span class="entity_def" id="Frequency_Moment_2.f2_result_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_result_rel_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_result_sumC_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_result_graph_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_result_dom|const"><span class="entity_def" id="Frequency_Moment_2.f2_result_rel|const"><span class="entity_def" id="Frequency_Moment_2.f2_result_sumC|const"><span class="entity_def" id="Frequency_Moment_2.f2_result_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_2.f2_result|const"><span>f2_result</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_state|type"><span>f2_state</span></a><span> </span><span class="main"><span>â</span></span><span> </span><span>rat</span><span> </span><span>pmf</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f2_result</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>1</sub></span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>2</sub></span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>h</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>sketch</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Median_Method/Median.html#Median.median|const"><span>median</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>2</sub></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>2</sub></span></span></span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> 
      </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>1</sub></span></span></span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span>rat_of_int</span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>sketch</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>rat_of_nat</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>p</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>rat_of_nat</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>1</sub></span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage.elims|fact"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage.induct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage.simps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage.pelims|fact"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage.cases|fact"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage.termination|fact"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage.pinduct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage.psimps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_rel.inducts|fact"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_rel.simps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_rel.induct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_rel.cases|fact"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_rel.intros|fact"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_graph.inducts|fact"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_graph.simps|fact"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_graph.induct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_graph.cases|fact"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_graph.intros|fact"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage.elims|thm"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage.induct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage.simps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage.pelims|thm"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage.cases|thm"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage.termination|thm"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage.pinduct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage.psimps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_rel.inducts|thm"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_rel.simps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_rel.induct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_rel.cases|thm"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_graph.inducts|thm"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_graph.simps|thm"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_graph.induct|thm"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_graph.cases|thm"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_graph.intros|thm"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_rel_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_sumC_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_graph_def|axiom"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_dom|const"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_rel|const"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_sumC|const"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_2.f2_space_usage|const"><span>f2_space_usage</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>f2_space_usage</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Îµ</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Î´</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>
    </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="numeral"><span>6</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Î´</span></span></span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><span>in</span></span><span>
    </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Îµ</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><span>in</span></span><span> 
    </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>+</span></span><span>
    </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>
    </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>
    </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>9</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>
    </span><span class="bound"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>5</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>*</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>8</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_2.encode_f2_state_def|fact"><span class="entity_def" id="Frequency_Moment_2.encode_f2_state_def|thm"><span class="entity_def" id="Frequency_Moment_2.encode_f2_state_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_2.encode_f2_state|const"><span>encode_f2_state</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_state|type"><span>f2_state</span></a><span> </span><span class="main"><span>â</span></span><span> </span><span>bool</span><span> </span><span>list</span><span> </span><span>option</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>encode_f2_state</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>.</span></span><span> 
    </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>.</span></span><span> 
    </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>p</span></span><span class="main"><span>.</span></span><span> 
    </span><span class="main"><span>(</span></span><span>List.product</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.P\&lt;^sub&gt;e|const"><span>P<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="bound"><span>p</span></span><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_prod|const"><span>Ã<span class="hidden">â©</span><sub>e</sub></span></a></span><span>
    </span><span class="main"><span>(</span></span><span>List.product</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e|const"><span>I<span class="hidden">â©</span><sub>e</sub></span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.encode_f2_state|const"><span>encode_f2_state</span></a><span> </span><span class="main"><span>(</span></span><span>dom</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.encode_f2_state|const"><span>encode_f2_state</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.encode_f2_state|const"><span>encode_f2_state</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.encode_f2_state_def|fact"><span>encode_f2_state_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.dependent_encoding|fact"><span>dependent_encoding</span></a><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.exp_golomb_encoding|fact"><span>exp_golomb_encoding</span></a><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.fun_encoding|fact"><span>fun_encoding</span></a><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.list_encoding|fact"><span>list_encoding</span></a><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.int_encoding|fact"><span>int_encoding</span></a><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.poly_encoding|fact"><span>poly_encoding</span></a><span class="main"><span>)</span></span><span>
      
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding_imp_inj|fact"><span>encoding_imp_inj</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2562..2569">context</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>rat</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span>list</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>result</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_2656..2663">Îµ_range</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>&lt;..&lt;</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_2690..2697">Î´_range</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_2717..2725">as_range</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>set</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>result</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>state</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>state</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_update|const"><span>f2_update</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_init|const"><span>f2_init</span></a><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_result|const"><span>f2_result</span></a><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>  

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_2.s\&lt;^sub&gt;1_def|fact"><span class="entity_def" id="Frequency_Moment_2.s\&lt;^sub&gt;1_def|thm"><span class="entity_def" id="Frequency_Moment_2.s\&lt;^sub&gt;1_def_raw|axiom"><span class="entity_def" id="offset_2851..2861">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_2.s\&lt;^sub&gt;1|const"><span class="entity_def" id="offset_2862..2865">s<span class="hidden">â©</span><sub>1</sub></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="numeral"><span>6</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>â</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.s1_gt_0|fact"><span class="entity_def" id="Frequency_Moment_2.s1_gt_0|thm"><span class="entity_def" id="offset_2901..2908">s1_gt_0</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2690..2697"><span>Î´_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2851..2861"><span>s<span class="hidden">â©</span><sub>1</sub>_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_2.s\&lt;^sub&gt;2_def|fact"><span class="entity_def" id="Frequency_Moment_2.s\&lt;^sub&gt;2_def|thm"><span class="entity_def" id="Frequency_Moment_2.s\&lt;^sub&gt;2_def_raw|axiom"><span class="entity_def" id="offset_2969..2979">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_2.s\&lt;^sub&gt;2|const"><span class="entity_def" id="offset_2980..2983">s<span class="hidden">â©</span><sub>2</sub></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.s2_gt_0|fact"><span class="entity_def" id="Frequency_Moment_2.s2_gt_0|thm"><span class="entity_def" id="offset_3037..3044">s2_gt_0</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2656..2663"><span>Îµ_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2969..2979"><span>s<span class="hidden">â©</span><sub>2</sub>_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_2.p_def|fact"><span class="entity_def" id="Frequency_Moment_2.p_def|thm"><span class="entity_def" id="Frequency_Moment_2.p_def_raw|axiom"><span class="entity_def" id="offset_3105..3115">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_2.p|const"><span class="entity_def" id="offset_3116..3117">p</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>p</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above|const"><span>prime_above</span></a><span> </span><span class="main"><span>(</span></span><span>max</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="numeral"><span>3</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
 
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.p_prime|fact"><span class="entity_def" id="Frequency_Moment_2.p_prime|thm"><span class="entity_def" id="offset_3160..3167">p_prime</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Factorial_Ring.prime</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3105..3115"><span>p_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above_prime|fact"><span>prime_above_prime</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.p_ge_3|fact"><span class="entity_def" id="Frequency_Moment_2.p_ge_3|thm"><span class="entity_def" id="offset_3253..3259">p_ge_3</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3105..3115"><span>p_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><span>max.boundedE</span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above_lower_bound|fact"><span>prime_above_lower_bound</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.p_gt_0|fact"><span class="entity_def" id="Frequency_Moment_2.p_gt_0|thm"><span class="entity_def" id="offset_3344..3350">p_gt_0</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3253..3259"><span>p_ge_3</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.p_gt_1|fact"><span class="entity_def" id="Frequency_Moment_2.p_gt_1|thm"><span class="entity_def" id="offset_3392..3398">p_gt_1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3253..3259"><span>p_ge_3</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.p_ge_n|fact"><span class="entity_def" id="Frequency_Moment_2.p_ge_n|thm"><span class="entity_def" id="offset_3436..3442">p_ge_n</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3105..3115"><span>p_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><span>max.boundedE</span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above_lower_bound|fact"><span>prime_above_lower_bound</span></a><span> </span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_3520..3534">interpretation</span></span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.carter_wegman_hash_family|locale"><span>carter_wegman_hash_family</span></a><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span>"</span></span></span><span> </span><span class="quoted"><span class="numeral"><span>4</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Carter_Wegman_Hash_Family.html#Carter_Wegman_Hash_Family.carter_wegman_hash_familyI|fact"><span>carter_wegman_hash_familyI</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring_is_field|fact"><span>mod_ring_is_field</span></a><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring_finite|fact"><span>mod_ring_finite</span></a><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3160..3167"><span>p_prime</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_2.sketch_def|fact"><span class="entity_def" id="Frequency_Moment_2.sketch_def|thm"><span class="entity_def" id="Frequency_Moment_2.sketch_def_raw|axiom"><span class="entity_def" id="offset_3674..3684">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_2.sketch|const"><span class="entity_def" id="offset_3685..3691">sketch</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>sketch</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>state</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>state</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_update|const"><span>f2_update</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_init|const"><span>f2_init</span></a><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_2.\&lt;Omega&gt;_def|fact"><span class="entity_def" id="Frequency_Moment_2.\&lt;Omega&gt;_def|thm"><span class="entity_def" id="Frequency_Moment_2.\&lt;Omega&gt;_def_raw|axiom"><span class="entity_def" id="offset_3773..3783">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_2.\&lt;Omega&gt;|const"><span class="entity_def" id="offset_3784..3785">Î©</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Î©</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>pmf_of_set</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>space</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> 
</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_2.\&lt;Omega&gt;\&lt;^sub&gt;p_def|fact"><span class="entity_def" id="Frequency_Moment_2.\&lt;Omega&gt;\&lt;^sub&gt;p_def|thm"><span class="entity_def" id="Frequency_Moment_2.\&lt;Omega&gt;\&lt;^sub&gt;p_def_raw|axiom"><span class="entity_def" id="offset_3860..3870">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_2.\&lt;Omega&gt;\&lt;^sub&gt;p|const"><span class="entity_def" id="offset_3871..3874">Î©<span class="hidden">â©</span><sub>p</sub></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Î©<span class="hidden">â©</span><sub>p</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure_pmf</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3784..3785"><span>Î©</span></a><span>"</span></span></span><span> 
</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_2.sketch_rv_def|fact"><span class="entity_def" id="Frequency_Moment_2.sketch_rv_def|thm"><span class="entity_def" id="Frequency_Moment_2.sketch_rv_def_raw|axiom"><span class="entity_def" id="offset_3911..3921">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_2.sketch_rv|const"><span class="entity_def" id="offset_3922..3931">sketch_rv</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>sketch_rv</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>of_int</span><span> </span><span class="main"><span>(</span></span><span>sum_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_2.mean_rv_def|fact"><span class="entity_def" id="Frequency_Moment_2.mean_rv_def|thm"><span class="entity_def" id="Frequency_Moment_2.mean_rv_def_raw|axiom"><span class="entity_def" id="offset_4005..4015">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_2.mean_rv|const"><span class="entity_def" id="offset_4016..4023">mean_rv</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>mean_rv</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3922..3931"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>of_nat</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>of_nat</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_2.result_rv_def|fact"><span class="entity_def" id="Frequency_Moment_2.result_rv_def|thm"><span class="entity_def" id="Frequency_Moment_2.result_rv_def_raw|axiom"><span class="entity_def" id="offset_4139..4149">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_2.result_rv|const"><span class="entity_def" id="offset_4150..4159">result_rv</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>result_rv</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Median_Method/Median.html#Median.median|const"><span>median</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4016..4023"><span>mean_rv</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span> </span><span class="bound"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.mean_rv_alg_sketch|fact"><span class="entity_def" id="Frequency_Moment_2.mean_rv_alg_sketch|thm"><span class="entity_def" id="offset_4231..4249">mean_rv_alg_sketch</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3685..3691"><span>sketch</span></a><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3784..3785"><span>Î©</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>sum_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3685..3691"><span>sketch</span></a><span> </span><span class="main"><span>=</span></span><span>  </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>state</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>state</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_update|const"><span>f2_update</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_init|const"><span>f2_init</span></a><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3674..3684"><span>sketch_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3784..3785"><span>Î©</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>,</span></span><span> 
      </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>sum_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>as</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span>rev_induct</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>Nil</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2851..2861"><span>s<span class="hidden">â©</span><sub>1</sub>_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2969..2979"><span>s<span class="hidden">â©</span><sub>2</sub>_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>space_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3105..3115"><span>p_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3773..3783"><span>Î©_def</span></a><span> </span><span>restrict_def</span><span> </span><span>Let_def</span><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_4786..4790">snoc</span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>as</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>state</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>state</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_update|const"><span>f2_update</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>as</span></span><span> </span><span class="main"><span>@</span></span><span> </span><span class="main"><span>[</span></span><span class="skolem"><span>a</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_init|const"><span>f2_init</span></a><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3784..3785"><span>Î©</span></a><span> </span><span class="main"><span>â¤</span></span><span> 
      </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>as</span></span><span class="main"><span>.</span></span><span>  </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_update|const"><span>f2_update</span></a><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4786..4790"><span>snoc</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>bind_assoc_pmf</span><span> </span><span>restrict_def</span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash.simps|fact"><span>f2_hash.simps</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_init.simps|fact"><span>f2_init.simps</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3784..3785"><span>Î©</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>as</span></span><span class="main"><span>@</span></span><span class="main"><span>[</span></span><span class="skolem"><span>a</span></span><span class="main"><span>]</span></span><span class="main"><span>.</span></span><span>  </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>bind_return_pmf</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>add.commute</span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash.simps|fact"><span>f2_hash.simps</span></a><span> </span><span class="quasi_keyword"><span>cong</span></span><span class="main"><span class="main"><span>:</span></span></span><span>restrict_cong</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.distr|fact"><span class="entity_def" id="Frequency_Moment_2.distr|thm"><span class="entity_def" id="offset_5378..5383">distr</span></span></span><span class="main"><span>:</span></span><span>  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>result</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map_pmf</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4150..4159"><span>result_rv</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3784..3785"><span>Î©</span></a><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>result</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3685..3691"><span>sketch</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_result|const"><span>f2_result</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2562..2569"><span>result_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3674..3684"><span>sketch_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3784..3785"><span>Î©</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_result|const"><span>f2_result</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>,</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>sum_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4231..4249"><span>mean_rv_alg_sketch</span></a><span>  </span><span>bind_assoc_pmf</span><span> </span><span>bind_return_pmf</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map_pmf</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4150..4159"><span>result_rv</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3784..3785"><span>Î©</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>map_pmf_def</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4139..4149"><span>result_rv_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4005..4015"><span>mean_rv_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3911..3921"><span>sketch_rv_def</span></a><span> </span><span>lessThan_atLeast0</span><span> </span><span class="quasi_keyword"><span>cong</span></span><span class="main"><span class="main"><span>:</span></span></span><span>restrict_cong</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>private</span></span></span><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_5881..5886">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.f2_hash_pow_exp|fact"><span class="entity_def" id="Frequency_Moment_2.f2_hash_pow_exp|thm"><span class="entity_def" id="offset_5887..5902">f2_hash_pow_exp</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
     </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>odd</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3160..3167"><span>p_prime</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3253..3259"><span>p_ge_3</span></a><span> </span><span>prime_odd_nat</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_5881..5886"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>t</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_6173..6178">t_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>=</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="skolem"><span>t</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>oddE</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Collect</span><span> </span><span>even</span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>t</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(*)</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="skolem"><span>t</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.in_image_by_witness|fact"><span>in_image_by_witness</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> g</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="keyword1"><span>div</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(*)</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="skolem"><span>t</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>Collect</span><span> </span><span>even</span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>t</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>image_subsetI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>even</span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="skolem"><span>t</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_6173..6178"><span>t_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>order_antisym</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{..&lt;</span></span><span class="skolem"><span>t</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>card_image</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>inj_on_mult</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span class="skolem"><span>t</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6712..6721">card_even</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>even</span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>t</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>even</span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_6173..6178"><span>t_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_6845..6854">prob_even</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>hash</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>Collect</span><span> </span><span>even</span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_5881..5886"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>prob_range</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span>frac_eq_eq</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3344..3350"><span>p_gt_0</span></a><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span class="main"><span>)</span></span><span> 

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>odd</span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>âª</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>even</span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>arg_cong</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>odd</span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>  </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>even</span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>card_Un_disjoint</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>odd</span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>t</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_6712..6721"><span>card_even</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>=</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>odd</span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="skolem"><span>t</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>odd</span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â©</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_6173..6178"><span>t_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_7510..7518">prob_odd</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>hash</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>Collect</span><span> </span><span>odd</span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_5881..5886"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>prob_range</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>frac_eq_eq</span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>indicator</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>even</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>hash</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="free"><span>m</span></span><span> </span><span class="main"><span>+</span></span><span> 
      </span><span>indicator</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>odd</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>hash</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>Bochner_Integration.integral_cong</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> 
     </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>hash</span></a><span>  </span><span class="free"><span>k</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>Collect</span><span> </span><span>even</span><span class="main"><span>}</span></span><span>  </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>m</span></span><span>  </span><span class="main"><span>+</span></span><span> 
     </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>hash</span></a><span>  </span><span class="free"><span>k</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>Collect</span><span> </span><span>odd</span><span class="main"><span>}</span></span><span>  </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>M_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_6845..6854"><span>prob_even</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_7510..7518"><span>prob_odd</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  
    </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>add_divide_distrib</span><span> </span><span class="dynamic"><span class="dynamic"><span>ac_simps</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>m</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.var_sketch_rv|fact"><span class="entity_def" id="Frequency_Moment_2.var_sketch_rv|thm"><span class="entity_def" id="offset_8598..8611">var_sketch_rv</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>variance</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3922..3931"><span>sketch_rv</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?A</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.exp_sketch_rv|fact"><span class="entity_def" id="Frequency_Moment_2.exp_sketch_rv|thm"><span class="entity_def" id="offset_8697..8710">exp_sketch_rv</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>expectation</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3922..3931"><span>sketch_rv</span></a><span> </span><span class="main"><span>=</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?B</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_8795..8801">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>h</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_8854..8860">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>c</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>c</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_8906..8912">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>r</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>m</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>m</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_9027..9033">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>h_prod</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>h_prod</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>as</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>prod_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 

  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_9096..9102">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>exp_h_prod</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span>list</span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>exp_h_prod</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="bound"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="bound"><span>as</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_9206..9210">f_eq</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3922..3931"><span>sketch_rv</span></a><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>ext</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3911..3921"><span>sketch_rv_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_8854..8860"><span>c_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_8795..8801"><span>h_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.sum_list_eval|fact"><span>sum_list_eval</span></a><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash.simps|fact"><span>f2_hash.simps</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_9355..9360">r_one</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_8906..8912"><span>r_def</span></a><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_9424..9429">r_two</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3344..3350"><span>p_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_8906..8912"><span>r_def</span></a><span> </span><span>power2_eq_square</span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>nonzero_divide_eq_eq</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>power_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>use</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3392..3398"><span>p_gt_1</span></a><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>in</span></span></span></span><span> </span><span class="operator"><span>linarith</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_9655..9668">p_square_ge_4</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>4</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>4</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>3</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3344..3350"><span>p_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_8906..8912"><span>r_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>nonzero_divide_eq_eq</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power4_eq_xxxx</span><span> </span><span>power2_eq_square</span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>4</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_9655..9668"><span>p_square_ge_4</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_9424..9429"><span>r_two</span></a><span> </span><span>power4_eq_xxxx</span><span> </span><span>power2_eq_square</span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span> </span><span>mult_left_mono</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10084..10094">r_four_est</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10135..10150">exp_h_prod_elim</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>exp_h_prod</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span>prod_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>count_list</span><span> </span><span class="bound"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>remdups</span><span> </span><span class="bound"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_9096..9102"><span>exp_h_prod_def</span></a><span> </span><span>prod.set_conv_list</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10295..10305">exp_h_prod</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>set</span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>length</span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h_prod</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>exp_h_prod</span></span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> 
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>set</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_10442..10449">x_sub_p</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>set</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2717..2725"><span>as_range</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3436..3442"><span>p_ge_n</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_10508..10514">x_le_p</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>length</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>4</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_10584..10590">card_x</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>4</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>card_length</span><span> </span><span>dual_order.trans</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>set</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Algebra/Congruence.html#Congruence.partial_object.carrier|const"><span>carrier</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_10442..10449"><span>x_sub_p</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring_def|fact"><span>mod_ring_def</span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_10755..10762">h_indep</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>indep_vars</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>borel</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span>count_list</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>k_wise_indep_vars_subset</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>k_wise_indep</span></a><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_10584..10590"><span>card_x</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2717..2725"><span>as_range</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_8795..8801"><span>h_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>indep_vars_compose2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> X</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>hash</span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> M'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Universal_Hash_Families/Preliminary_Results.html#Preliminary_Results.discrete|const"><span>discrete</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h_prod</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_9027..9033"><span>h_prod_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prod_list_eval|fact"><span>prod_list_eval</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>h</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>indep_vars_lebesgue_integral</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> _ </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_10755..10762"><span>h_indep</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_5887..5902"><span>f2_hash_pow_exp</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_10508..10514"><span>x_le_p</span></a><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_8795..8801"><span>h_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_8906..8912"><span>r_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>M_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash.simps|fact"><span>f2_hash.simps</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>exp_h_prod</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_9096..9102"><span>exp_h_prod_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h_prod</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>exp_h_prod</span></span><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of|const"><span>kernel_of</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of|const"><span>kernel_of</span></a><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>exp_h_prod</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>exp_h_prod</span></span><span> </span><span class="bound"><span>y</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span>list</span><span>"</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span>a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of|const"><span>kernel_of</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of|const"><span>kernel_of</span></a><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>f</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_11738..11739">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>bij_betw</span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_11773..11774">c</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>z</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>count_list</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="bound"><span>z</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>count_list</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="bound"><span>z</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of_eq_imp_bij|fact"><span>kernel_of_eq_imp_bij</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>exp_h_prod</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>prod</span><span> </span><span class="main"><span>(</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>r</span></span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>f</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_9096..9102"><span>exp_h_prod_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_11773..11774"><span>c</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>r</span></span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_11738..11739"><span>b</span></a><span> </span><span>bij_betw_def</span><span> </span><span>prod.reindex</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>exp_h_prod</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_9096..9102"><span>exp_h_prod_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>prod.cong</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_11738..11739"><span>b</span></a><span> </span><span>bij_betw_def</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>exp_h_prod</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>exp_h_prod</span></span><span> </span><span class="skolem"><span>y</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_12272..12287">exp_h_prod_cong</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of|const"><span>kernel_of</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of|const"><span>kernel_of</span></a><span> </span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>exp_h_prod</span></span><span> </span><span class="bound"><span>p</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of|const"><span>kernel_of</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of|const"><span>kernel_of</span></a><span> </span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>exp_h_prod</span></span><span> </span><span class="bound"><span>x</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>full_types</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>of_bool_eq_0_iff</span><span> </span><span>vector_space_over_itself.scale_zero_left</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_12501..12502">c</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>p</span></span><span class="main"><span>â</span></span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.enum_rgfs|const"><span>enum_rgfs</span></a><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of|const"><span>kernel_of</span></a><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of|const"><span>kernel_of</span></a><span> </span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>r</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_12575..12576">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>n</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span>list</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>real</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>p</span></span><span class="main"><span>â</span></span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.enum_rgfs|const"><span>enum_rgfs</span></a><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of|const"><span>kernel_of</span></a><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of|const"><span>kernel_of</span></a><span> </span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>::</span></span><span>real</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.equiv_rels_2|fact"><span>equiv_rels_2</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_12575..12576"><span>a</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.equiv_rels_def|fact"><span>equiv_rels_def</span></a><span> </span><span>comp_def</span><span class="main"><span>)</span></span><span> 
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>p</span></span><span class="main"><span>â</span></span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.enum_rgfs|const"><span>enum_rgfs</span></a><span> </span><span class="skolem"><span>n</span></span><span class="main"><span>.</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of|const"><span>kernel_of</span></a><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of|const"><span>kernel_of</span></a><span> </span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span class="main"><span>::</span></span><span>real</span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>sum_list_mult_const</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>expectation</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3922..3931"><span>sketch_rv</span></a><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>â</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h_prod</span></span><span> </span><span class="main"><span>[</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_9206..9210"><span>f_eq</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_9027..9033"><span>h_prod_def</span></a><span> </span><span>power2_eq_square</span><span> </span><span>sum_distrib_left</span><span> </span><span>sum_distrib_right</span><span> </span><span>Bochner_Integration.integral_sum</span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span class="main"><span>â</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>exp_h_prod</span></span><span> </span><span class="main"><span>[</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_10295..10305"><span>exp_h_prod</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span>  
    </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>sum_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>p</span></span><span class="main"><span>.</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of|const"><span>kernel_of</span></a><span> </span><span class="main"><span>[</span></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>j</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of|const"><span>kernel_of</span></a><span> </span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>exp_h_prod</span></span><span> </span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.enum_rgfs|const"><span>enum_rgfs</span></a><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_12272..12287"><span>exp_h_prod_cong</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_12501..12502"><span>c</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>numeral_eq_Suc</span><span> </span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of_eq|fact"><span>kernel_of_eq</span></a><span> </span><span>All_less_Suc</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_10135..10150"><span>exp_h_prod_elim</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_9355..9360"><span>r_one</span></a><span> </span><span>distrib_left</span><span> </span><span>sum.distrib</span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.sum_collapse|fact"><span>sum_collapse</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>sum_distrib_right</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_8854..8860"><span>c_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F_def|fact"><span>F_def</span></a><span> </span><span>power2_eq_square</span><span> </span><span>of_rat_sum</span><span> </span><span>of_rat_mult</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_9424..9429"><span>r_two</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="entity_def" id="offset_13823..13824">b</span><span class="main"><span>:</span></span><span class="var"><span class="quoted"><span class="var"><span>?B</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3922..3931"><span>sketch_rv</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i1</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i2</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i3</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i4</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span>
    </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i1</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>h_prod</span></span><span> </span><span class="main"><span>[</span></span><span class="bound"><span>i1</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>i2</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>i3</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>i4</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_9206..9210"><span>f_eq</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_9027..9033"><span>h_prod_def</span></a><span> </span><span>power4_eq_xxxx</span><span> </span><span>sum_distrib_left</span><span> </span><span>sum_distrib_right</span><span> </span><span>Bochner_Integration.integral_sum</span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i1</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i2</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i3</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i4</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> 
    </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i1</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>exp_h_prod</span></span><span> </span><span class="main"><span>[</span></span><span class="bound"><span>i1</span></span><span class="main"><span>,</span></span><span class="bound"><span>i2</span></span><span class="main"><span>,</span></span><span class="bound"><span>i3</span></span><span class="main"><span>,</span></span><span class="bound"><span>i4</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_10295..10305"><span>exp_h_prod</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i1</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i2</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i3</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i4</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> 
    </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i1</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i4</span></span><span> </span><span class="main"><span>*</span></span><span> 
    </span><span class="main"><span>(</span></span><span>sum_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>p</span></span><span class="main"><span>.</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of|const"><span>kernel_of</span></a><span> </span><span class="main"><span>[</span></span><span class="bound"><span>i1</span></span><span class="main"><span>,</span></span><span class="bound"><span>i2</span></span><span class="main"><span>,</span></span><span class="bound"><span>i3</span></span><span class="main"><span>,</span></span><span class="bound"><span>i4</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of|const"><span>kernel_of</span></a><span> </span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>exp_h_prod</span></span><span> </span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.enum_rgfs|const"><span>enum_rgfs</span></a><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_12272..12287"><span>exp_h_prod_cong</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_12501..12502"><span>c</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>j</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>^</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span>  </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>numeral_eq_Suc</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_10135..10150"><span>exp_h_prod_elim</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_9355..9360"><span>r_one</span></a><span class="main"><span>)</span></span><span> </span><span class="comment1"><span>(</span><span>*</span><span> large intermediate terms </span><span>*</span><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Equivalence_Relation_Enumeration/Equivalence_Relation_Enumeration.html#Equivalence_Relation_Enumeration.kernel_of_eq|fact"><span>kernel_of_eq</span></a><span> </span><span>All_less_Suc</span><span> </span><span>numeral_eq_Suc</span><span> </span><span>distrib_left</span><span> </span><span>sum.distrib</span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.sum_collapse|fact"><span>sum_collapse</span></a><span> </span><span>neq_commute</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span> </span><span>sum_subtractf</span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.sum_collapse|fact"><span>sum_collapse</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>sum_distrib_left</span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power2_eq_square</span><span> </span><span>sum_distrib_left</span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span> </span><span>sum_subtractf</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power_mult_distrib</span><span> </span><span>sum_distrib_right</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>r</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>c</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_10084..10094"><span>r_four_est</span></a><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>sum_nonpos</span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>mult_nonneg_nonpos</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_8854..8860"><span>c_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_9424..9429"><span>r_two</span></a><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F_def|fact"><span>F_def</span></a><span> </span><span>of_rat_sum</span><span> </span><span>of_rat_power</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3922..3931"><span>sketch_rv</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>variance</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3922..3931"><span>sketch_rv</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
     </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>variance_eq</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power_mult_distrib</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_13823..13824"><span>b</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.space_omega_1|fact"><span class="entity_def" id="Frequency_Moment_2.space_omega_1|thm"><span>space_omega_1</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>Sigma_Algebra.space</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3871..3874"><span>Î©<span class="hidden">â©</span><sub>p</sub></span></a><span> </span><span class="main"><span>=</span></span><span> </span><span>UNIV</span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3860..3870"><span>Î©<span class="hidden">â©</span><sub>p</sub>_def</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_16061..16075">interpretation</span></span></span><span> Î©</span><span class="main"><span>:</span></span><span> </span><span>prob_space</span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3871..3874"><span>Î©<span class="hidden">â©</span><sub>p</sub></span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3860..3870"><span>Î©<span class="hidden">â©</span><sub>p</sub>_def</span></a><span> </span><span>prob_space_measure_pmf</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.integrable_\&lt;Omega&gt;|fact"><span class="entity_def" id="Frequency_Moment_2.integrable_\&lt;Omega&gt;|thm"><span class="entity_def" id="offset_16150..16162">integrable_Î©</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span>list</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3871..3874"><span>Î©<span class="hidden">â©</span><sub>p</sub></span></a><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3860..3870"><span>Î©<span class="hidden">â©</span><sub>p</sub>_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3773..3783"><span>Î©_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>integrable_measure_pmf_finite</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span>finite_PiE</span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.set_prod_pmf|fact"><span>set_prod_pmf</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_16350..16355">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.sketch_rv_exp|fact"><span class="entity_def" id="Frequency_Moment_2.sketch_rv_exp|thm"><span class="entity_def" id="offset_16356..16369">sketch_rv_exp</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3922..3931"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span>  </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3922..3931"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>real</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>expectation</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3922..3931"><span>sketch_rv</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16150..16162"><span>integrable_Î©</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>integrable_M</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16350..16355"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3773..3783"><span>Î©_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3860..3870"><span>Î©<span class="hidden">â©</span><sub>p</sub>_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>M_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.expectation_Pi_pmf_slice|fact"><span>expectation_Pi_pmf_slice</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_8697..8710"><span>exp_sketch_rv</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_16867..16872">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.sketch_rv_var|fact"><span class="entity_def" id="Frequency_Moment_2.sketch_rv_var|thm"><span class="entity_def" id="offset_16873..16886">sketch_rv_var</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3922..3931"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3922..3931"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>real</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>variance</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3922..3931"><span>sketch_rv</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16150..16162"><span>integrable_Î©</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>integrable_M</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16867..16872"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3773..3783"><span>Î©_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3860..3870"><span>Î©<span class="hidden">â©</span><sub>p</sub>_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>M_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.variance_prod_pmf_slice|fact"><span>variance_prod_pmf_slice</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span>  </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_8598..8611"><span>var_sketch_rv</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_17392..17397">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.mean_rv_exp|fact"><span class="entity_def" id="Frequency_Moment_2.mean_rv_exp|thm"><span class="entity_def" id="offset_17398..17409">mean_rv_exp</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4016..4023"><span>mean_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17511..17512">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3392..3398"><span>p_gt_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4016..4023"><span>mean_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3922..3931"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_17392..17397"><span>assms</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16150..16162"><span>integrable_Î©</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4005..4015"><span>mean_rv_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16356..16369"><span>sketch_rv_exp</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_17392..17397"><span>assms</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2901..2908"><span>s1_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_17511..17512"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_18001..18006">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.mean_rv_var|fact"><span class="entity_def" id="Frequency_Moment_2.mean_rv_var|thm"><span class="entity_def" id="offset_18007..18018">mean_rv_var</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4016..4023"><span>mean_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_18129..18130">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.indep_vars</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>borel</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3922..3931"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_18001..18006"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3860..3870"><span>Î©<span class="hidden">â©</span><sub>p</sub>_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3773..3783"><span>Î©_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.indep_vars_restrict_intro&apos;|fact"><span>indep_vars_restrict_intro'</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>fst</span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl_def|fact"><span>restrict_dfl_def</span></a><span> </span><span>case_prod_beta</span><span> </span><span>lessThan_atLeast0</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_18383..18392">p_sq_ne_1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3392..3398"><span>p_gt_1</span></a><span> </span><span>less_numeral_extra</span><span class="main"><span class="main"><span>(</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>of_nat_power</span><span> </span><span>one_less_power</span><span> </span><span>pos2</span><span> </span><span>semiring_char_0_class.of_nat_eq_1_iff</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_18535..18543">s1_bound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="numeral"><span>6</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2851..2861"><span>s<span class="hidden">â©</span><sub>1</sub>_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span>  </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>mono_tags</span><span class="main"><span class="main"><span>,</span></span></span><span> opaque_lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span>of_rat_ceiling</span><span> </span><span>of_rat_divide</span><span> </span><span>of_rat_numeral_eq</span><span> </span><span>of_rat_power</span><span> </span><span>real_nat_ceiling_ge</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4016..4023"><span>mean_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3922..3931"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4005..4015"><span>mean_rv_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.variance_divide</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16150..16162"><span>integrable_Î©</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3922..3931"><span>sketch_rv</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.var_sum_all_indep</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> _ _ </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16150..16162"><span>integrable_Î©</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_18129..18130"><span>a</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3773..3783"><span>Î©_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3860..3870"><span>Î©<span class="hidden">â©</span><sub>p</sub>_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span>  </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span>  </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>divide_right_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><span>sum_mono</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16873..16886"><span>sketch_rv_var</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_18001..18006"><span>assms</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_18383..18392"><span>p_sq_ne_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2901..2908"><span>s1_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>frac_eq_eq</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power2_eq_square</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>6</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span>  </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2901..2908"><span>s1_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2690..2697"><span>Î´_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>divide_left_mono</span><span> </span><span>mult_pos_pos</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_18535..18543"><span>s1_bound</span></a><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>of_rat_mult</span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_19762..19767">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.mean_rv_bounds|fact"><span class="entity_def" id="Frequency_Moment_2.mean_rv_bounds|thm"><span class="entity_def" id="offset_19768..19782">mean_rv_bounds</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4016..4023"><span>mean_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>as</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[]</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_19762..19767"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4005..4015"><span>mean_rv_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3911..3921"><span>sketch_rv_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F_def|fact"><span>F_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F_gr_0|fact"><span>F_gr_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_20109..20110">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2690..2697"><span>Î´_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4016..4023"><span>mean_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>borel_measurable</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3871..3874"><span>Î©<span class="hidden">â©</span><sub>p</sub></span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3773..3783"><span>Î©_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3860..3870"><span>Î©<span class="hidden">â©</span><sub>p</sub>_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4016..4023"><span>mean_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
      </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4016..4023"><span>mean_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.pmf_mono</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3860..3870"><span>Î©<span class="hidden">â©</span><sub>p</sub>_def</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>of_rat_mult</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span>  </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4016..4023"><span>mean_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="free"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.Chebyshev_inequality</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> a</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> f</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4016..4023"><span>mean_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="free"><span>i</span></span><span>"</span></span></span><span class="main"><span>,</span></span><span class="operator"><span>simplified</span></span><span class="main"><span>]</span></span><span> 
      </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_20109..20110"><span>a</span></a><span> </span><span>prob_space_measure_pmf</span><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> p</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3784..3785"><span>Î©</span></a><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_17398..17409"><span>mean_rv_exp</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_19762..19767"><span>assms</span></a><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16150..16162"><span>integrable_Î©</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>/</span></span><span class="numeral"><span>3</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>divide_right_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_18007..18018"><span>mean_rv_var</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_19762..19767"><span>assms</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span>  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_20109..20110"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.f2_alg_correct&apos;|fact"><span class="entity_def" id="Frequency_Moment_2.f2_alg_correct&apos;|thm"><span>f2_alg_correct'</span></span></span><span class="main"><span>:</span></span><span>
   </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>ð«(</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span>measure_pmf</span><span> </span><span class="free"><span class="free"><span>result</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span>of_rat</span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_21112..21113">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.indep_vars</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>borel</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4016..4023"><span>mean_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2901..2908"><span>s1_gt_0</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3860..3870"><span>Î©<span class="hidden">â©</span><sub>p</sub>_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3773..3783"><span>Î©_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.indep_vars_restrict_intro&apos;|fact"><span>indep_vars_restrict_intro'</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>snd</span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3860..3870"><span>Î©<span class="hidden">â©</span><sub>p</sub>_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3773..3783"><span>Î©_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4005..4015"><span>mean_rv_def</span></a><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl_def|fact"><span>restrict_dfl_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_21342..21343">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>-</span></span><span> </span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span>  </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2969..2979"><span>s<span class="hidden">â©</span><sub>2</sub>_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>of_nat_ceiling</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_rat</span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span>  </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../Median_Method/Median.html#Median.median|const"><span>median</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4016..4023"><span>mean_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span>  </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>of_rat</span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2656..2663"><span>Îµ_range</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.median_bound_2</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> _ </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_21112..21113"><span>a</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_21342..21343"><span>b</span></a><span class="main"><span>,</span></span><span> </span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> Î´</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> Î¼</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_19768..19782"><span>mean_rv_bounds</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span>  </span><span class="main"><span>Â¦</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4150..4159"><span>result_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>of_rat</span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4139..4149"><span>result_rv_def</span></a><span> </span><a class="entity_ref" href="../Median_Method/Median.html#Median.median_restrict|fact"><span>median_restrict</span></a><span> </span><span>lessThan_atLeast0</span><span> </span><a class="entity_ref" href="../Median_Method/Median.html#Median.median_rat|fact"><span>median_rat</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3037..3044"><span>s2_gt_0</span></a><span class="main"><span class="main"><span>]</span></span></span><span>
         </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4005..4015"><span>mean_rv_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3911..3921"><span>sketch_rv_def</span></a><span> </span><span>of_rat_divide</span><span> </span><span>of_rat_sum</span><span> </span><span>of_rat_mult</span><span> </span><span>of_rat_diff</span><span> </span><span>of_rat_power</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4150..4159"><span>result_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>}</span></span><span> </span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>of_rat_less_eq</span><span> </span><span>of_rat_mult</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span>  </span><span>of_rat_diff</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>set_eq_iff</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_16061..16075"><span>Î©.prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4150..4159"><span>result_rv</span></a><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span>of_rat</span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_5378..5383"><span>distr</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3860..3870"><span>Î©<span class="hidden">â©</span><sub>p</sub>_def</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.f2_exact_space_usage&apos;|fact"><span class="entity_def" id="Frequency_Moment_2.f2_exact_space_usage&apos;|thm"><span>f2_exact_space_usage'</span></span></span><span class="main"><span>:</span></span><span>
   </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>AE</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3685..3691"><span>sketch</span></a><span> </span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.encode_f2_state|const"><span>encode_f2_state</span></a><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_space_usage|const"><span>f2_space_usage</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>max</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3105..3115"><span>p_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.prime_above_upper_bound|fact"><span>prime_above_upper_bound</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>8</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_22588..22595">p_bound</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>8</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.exp_golomb_bit_count|fact"><span>exp_golomb_bit_count</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>9</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_22588..22595"><span>p_bound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_22825..22836">p_bit_count</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>9</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_22919..22920">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.encode_f2_state|const"><span>encode_f2_state</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> 
      </span><span>sum_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_space_usage|const"><span>f2_space_usage</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_23090..23091">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>E</sub></span></span><span> </span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials|const"><span>bounded_degree_polynomials</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>mod_ring</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="numeral"><span>4</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>y</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>extensional</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_23090..23091"><span>a</span></a><span> </span><span>PiE_iff</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_23262..23267">y_ext</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>extensional</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="main"><span>(</span></span><span>List.product</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>lessThan_atLeast0</span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_23376..23391">h_bit_count_aux</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.P\&lt;^sub&gt;e|const"><span>P<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>8</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_23471..23472">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span>  </span><span>set</span><span> </span><span class="main"><span>(</span></span><span>List.product</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials|const"><span>bounded_degree_polynomials</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>Field.mod_ring</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="numeral"><span>4</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_23471..23472"><span>b</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_23090..23091"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.P\&lt;^sub&gt;e|const"><span>P<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span> </span><span>real</span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.bounded_degree_polynomial_bit_count|fact"><span>bounded_degree_polynomial_bit_count</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3392..3398"><span>p_gt_1</span></a><span class="main"><span class="main"><span>]</span></span></span><span> </span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>8</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3344..3350"><span>p_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_22588..22595"><span>p_bound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>8</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_24027..24038">h_bit_count</span><span class="main"><span>:</span></span><span> 
      </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>List.product</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.P\&lt;^sub&gt;e|const"><span>P<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>8</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.fun_bit_count_est|fact"><span>fun_bit_count_est</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> e</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.P\&lt;^sub&gt;e|const"><span>P<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="numeral"><span>4</span></span><span>"</span></span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_23262..23267"><span>y_ext</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_23376..23391"><span>h_bit_count_aux</span></a><span class="main"><span>]</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_24274..24294">sketch_bit_count_aux</span><span class="main"><span>:</span></span><span>
      </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e|const"><span>I<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="main"><span>(</span></span><span>sum_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¦</span></span><span>sum_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>sum_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span>abs</span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>map_map</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>  </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>sum_list_abs</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span>  </span><span>sum_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>sum_list_mono</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3344..3350"><span>p_gt_0</span></a><span class="main"><span>)</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>int</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>sum_list_triv</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>int</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>9</span></span><span class="main"><span>+</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_22588..22595"><span>p_bound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span>  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¦</span></span><span>sum_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>int</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>9</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_int</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>int</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>9</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>int</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.int_bit_count_est|fact"><span>int_bit_count_est</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?thesis</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> 
      </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>List.product</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e|const"><span>I<span class="hidden">â©</span><sub>e</sub></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>sum_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="main"><span>(</span></span><span>List.product</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.fun_bit_count_est|fact"><span>fun_bit_count_est</span></a><span class="main"><span>)</span></span><span>  
       </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>extensional_def</span><span> </span><span>lessThan_atLeast0</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_24274..24294"><span>sketch_bit_count_aux</span></a><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash.simps|fact"><span>f2_hash.simps</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_25849..25865">sketch_bit_count</span><span class="main"><span>:</span></span><span> 
       </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>List.product</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e|const"><span>I<span class="hidden">â©</span><sub>e</sub></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>sum_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>
      </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.encode_f2_state|const"><span>encode_f2_state</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>sum_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
      </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>
      </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>List.product</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.P\&lt;^sub&gt;e|const"><span>P<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="numeral"><span>4</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>
      </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>List.product</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.I\&lt;^sub&gt;e|const"><span>I<span class="hidden">â©</span><sub>e</sub></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>sum_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>   
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>Let_def</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2851..2861"><span>s<span class="hidden">â©</span><sub>1</sub>_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2969..2979"><span>s<span class="hidden">â©</span><sub>2</sub>_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.encode_f2_state_def|fact"><span>encode_f2_state_def</span></a><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.dependent_bit_count|fact"><span>dependent_bit_count</span></a><span> </span><span>add.assoc</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>9</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> 
      </span><span class="main"><span>(</span></span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>8</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> 
      </span><span class="main"><span>(</span></span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.exp_golomb_bit_count|fact"><span>exp_golomb_bit_count</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_22825..22836"><span>p_bit_count</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_24027..24038"><span>h_bit_count</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_25849..25865"><span>sketch_bit_count</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_space_usage|const"><span>f2_space_usage</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>distrib_left</span><span> </span><span>add.commute</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2851..2861"><span>s<span class="hidden">â©</span><sub>1</sub>_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2969..2979"><span>s<span class="hidden">â©</span><sub>2</sub>_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>Let_def</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.encode_f2_state|const"><span>encode_f2_state</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>sum_list</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_hash|const"><span>f2_hash</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>  
      </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_space_usage|const"><span>f2_space_usage</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>set_pmf</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3784..3785"><span>Î©</span></a><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2862..2865"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_2980..2983"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>E</sub></span></span><span> </span><a class="entity_ref" href="../Interpolation_Polynomials_HOL_Algebra/Bounded_Degree_Polynomials.html#Bounded_Degree_Polynomials.bounded_degree_polynomials|const"><span>bounded_degree_polynomials</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Universal_Hash_Families/Field.html#Field.mod_ring|const"><span>Field.mod_ring</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3116..3117"><span>p</span></a><span class="main"><span>)</span></span><span> </span><span class="numeral"><span>4</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3773..3783"><span>Î©_def</span></a><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.set_prod_pmf|fact"><span>set_prod_pmf</span></a><span class="main"><span>)</span></span><span>  </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_3520..3534"><span>space_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span>  </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_4231..4249"><span>mean_rv_alg_sketch</span></a><span> </span><span>AE_measure_pmf_iff</span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_space_usage.simps|fact"><span>f2_space_usage.simps</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_22919..22920"><span>a</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Main results of this section:</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_27660..27667">theorem</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.f2_alg_correct|fact"><span class="entity_def" id="Frequency_Moment_2.f2_alg_correct|thm"><span>f2_alg_correct</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>&lt;..&lt;</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>set</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Î©</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>state</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>state</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_update|const"><span>f2_update</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_init|const"><span>f2_init</span></a><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_result|const"><span>f2_result</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>ð«(</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span>measure_pmf</span><span> </span><span class="free"><span class="free"><span>Î©</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span>of_rat</span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_alg_correct&apos;|fact"><span>f2_alg_correct'</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_27660..27667"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>,</span></span></span><span>2</span><span class="main"><span class="main"><span>,</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_27660..27667"><span>Î©_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_27967..27974">theorem</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.f2_exact_space_usage|fact"><span class="entity_def" id="Frequency_Moment_2.f2_exact_space_usage|thm"><span>f2_exact_space_usage</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>&lt;..&lt;</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>set</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>state</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>state</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_update|const"><span>f2_update</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_init|const"><span>f2_init</span></a><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>AE</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.encode_f2_state|const"><span>encode_f2_state</span></a><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_space_usage|const"><span>f2_space_usage</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_exact_space_usage&apos;|fact"><span>f2_exact_space_usage'</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_27967..27974"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>,</span></span></span><span>2</span><span class="main"><span class="main"><span>,</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span class="quasi_keyword"><span>asm</span></span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.sketch_def|fact"><span>sketch_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_27967..27974"><span>assms</span></a><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>1</span><span class="main"><span class="main"><span class="main"><span>,</span></span></span></span><span>2</span><span class="main"><span class="main"><span class="main"><span>,</span></span></span></span><span>3</span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_27967..27974"><span>M_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>theorem</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_2.f2_asympotic_space_complexity|fact"><span class="entity_def" id="Frequency_Moment_2.f2_asympotic_space_complexity|thm"><span>f2_asympotic_space_complexity</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_space_usage|const"><span>f2_space_usage</span></a><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span>at_top</span><span> </span><span class="keyword1"><span>Ã<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span>at_top</span><span> </span><span class="keyword1"><span>Ã<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span>at_right</span><span> </span><span class="main"><span>0</span></span><span> </span><span class="keyword1"><span>Ã<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span>at_right</span><span> </span><span class="main"><span>0</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> 
  </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>of_rat</span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>of_rat</span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>_</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="var"><span>?rhs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_28574..28580">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>n_of</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>n_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_28655..28661">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>m_of</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>m_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_28736..28742">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>Îµ_of</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>rat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_28817..28823">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>Î´_of</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>rat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_28899..28905">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>g</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_29032..29035">evt</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> 
    </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â§</span></span><span> 
    </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="skolem"><span>Î´</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="skolem"><span>Îµ</span></span><span> </span><span class="main"><span>â§</span></span><span>
    </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="skolem"><span>m</span></span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><span>â¹</span></span><span> </span><span>eventually</span><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="var"><span>?F</span></span><span>"</span></span></span><span>  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="var"><span>?prem</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>_</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>Î´</span></span><span> </span><span class="skolem"><span>Îµ</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="skolem"><span>P</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>eventually_mono</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> P</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?prem</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> Q</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>P</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_28736..28742"><span>Îµ_of_def</span></a><span> </span><span>case_prod_beta'</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_28817..28823"><span>Î´_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_28574..28580"><span>n_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_28655..28661"><span>m_of_def</span></a><span class="main"><span>)</span></span><span>
     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>eventually_conj</span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.eventually_prod1&apos;|fact"><span>eventually_prod1'</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.eventually_prod2&apos;|fact"><span>eventually_prod2'</span></a><span> 
        </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.sequentially_inf|fact"><span>sequentially_inf</span></a><span> </span><span>eventually_at_right_less</span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.inv_at_right_0_inf|fact"><span>inv_at_right_0_inf</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>prod_filter_eq_bot</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_29609..29615">unit_1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>one_le_power</span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29032..29035"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> Î´</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power_one_over</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_29791..29797">unit_2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span>  </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29032..29035"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> Îµ</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>exp</span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span>iffD2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>ln_ge_iff</span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.abs_ge_iff|fact"><span>abs_ge_iff</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_29974..29980">unit_3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29032..29035"><span>evt</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_30070..30076">unit_4</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29032..29035"><span>evt</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_30166..30172">unit_5</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29032..29035"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>exp</span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>abs_ge_self</span><span> </span><span>linorder_not_le</span><span> </span><span>ln_ge_iff</span><span> </span><span>not_exp_le_zero</span><span> </span><span>order.trans</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_30365..30371">unit_6</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_sum_1|fact"><span>landau_sum_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29032..29035"><span>evt</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_30166..30172"><span>unit_5</span></a><span> </span><span>iffD2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>ln_ge_iff</span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>unit_7</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span>  </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29032..29035"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> Îµ</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
 
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_30631..30637">unit_8</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_28899..28905"><span>g_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1|fact"><span>landau_o.big_mult_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29609..29615"><span>unit_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29791..29797"><span>unit_2</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_30365..30371"><span>unit_6</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_30741..30747">unit_9</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1|fact"><span>landau_o.big_mult_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29974..29980"><span>unit_3</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_30070..30076"><span>unit_4</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>6</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big.cmult_in_iff|fact"><span>landau_o.big.cmult_in_iff</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_31004..31006">l1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="numeral"><span>6</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_real_nat|fact"><span>landau_real_nat</span></a><span>  </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_rat_ceil|fact"><span>landau_rat_ceil</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29609..29615"><span>unit_1</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>of_rat_divide</span><span> </span><span>of_rat_power</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29032..29035"><span>evt</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>ln_div</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_31343..31345">l2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_real_nat|fact"><span>landau_real_nat</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ceil|fact"><span>landau_ceil</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29791..29797"><span>unit_2</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_31514..31520">l3_aux</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> _</span><a class="entity_ref" href="Frequency_Moment_2.html#offset_30741..30747"><a class="entity_ref" href="Frequency_Moment_2.html#offset_30741..30747"><span>unit_9</span></a></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><span>mult.commute</span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.mult|fact"><span>landau_o.mult</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29974..29980"><span>unit_3</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ln_2|fact"><span>landau_ln_2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> a</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29032..29035"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> m</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>dual_order.trans</span><span> </span><span>mult_left_mono</span><span> </span><span>mult_of_nat_commute</span><span> </span><span>of_nat_0_le_iff</span><span> </span><span>verit_prod_simplify</span><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_31514..31520"><span>l3_aux</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29032..29035"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> m</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>ln_mult</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_32290..32292">l3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span>  </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_trans|fact"><span>landau_o.big_trans</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_32451..32453">l4</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>8</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_sum_1|fact"><span>landau_sum_1</span></a><span>  </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29032..29035"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ln_2|fact"><span>landau_ln_2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> a</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>iffD2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>ln_ge_iff</span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29974..29980"><span>unit_3</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_32690..32692">l5</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>9</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_sum_1|fact"><span>landau_sum_1</span></a><span>  </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29032..29035"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ln_2|fact"><span>landau_ln_2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> a</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>iffD2</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><span>ln_ge_iff</span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29974..29980"><span>unit_3</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_32929..32931">l6</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="numeral"><span>6</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_28899..28905"><span>g_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1|fact"><span>landau_o.big_mult_1</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ln_3|fact"><span>landau_ln_3</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_30365..30371"><span>unit_6</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29791..29797"><span>unit_2</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_31004..31006"><span>l1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29609..29615"><span>unit_1</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_33106..33108">l7</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>9</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_28899..28905"><span>g_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1&apos;|fact"><span>landau_o.big_mult_1'</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29609..29615"><span>unit_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29791..29797"><span>unit_2</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_32690..32692"><span>l5</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_33237..33239">l8</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_28899..28905"><span>g_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1|fact"><span>landau_o.big_mult_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_30365..30371"><span>unit_6</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1&apos;|fact"><span>landau_o.big_mult_1'</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29609..29615"><span>unit_1</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ln_3|fact"><span>landau_ln_3</span></a><span>  </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_31343..31345"><span>l2</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_29791..29797"><span>unit_2</span></a><span class="main"><span>)</span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_33456..33458">l9</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>5</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>8</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>ln</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>ln</span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_32290..32292"><span>l3</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_32451..32453"><span>l4</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_30365..30371"><span>unit_6</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_33692..33695">l10</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="numeral"><span>6</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> 
      </span><span class="main"><span>(</span></span><span class="numeral"><span>5</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>8</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>ln</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>ln</span><span> </span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_28899..28905"><span>g_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.mult|fact"><span>landau_o.mult</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_31004..31006"><span>l1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_31343..31345"><span>l2</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_33456..33458"><span>l9</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_space_usage|const"><span>f2_space_usage</span></a><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#Frequency_Moment_2.f2_space_usage|const"><span>f2_space_usage</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>case_prod_beta'</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_28574..28580"><span>n_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_28736..28742"><span>Îµ_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_28817..28823"><span>Î´_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_28655..28661"><span>m_of_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>!</span></span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span>Let_def</span><span> </span><span>log_def</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_32929..32931"><span>l6</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_33106..33108"><span>l7</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_33237..33239"><span>l8</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_33692..33695"><span>l10</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_30631..30637"><span>unit_8</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="var"><span>?rhs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>case_prod_beta'</span><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_28899..28905"><span>g_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_28574..28580"><span>n_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_28736..28742"><span>Îµ_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_28817..28823"><span>Î´_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_2.html#offset_28655..28661"><span>m_of_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre></div><div id='Frequency_Moment_k'>


<body>
<div class="head">
<h1>Theory Frequency_Moment_k</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Frequency Moment $k$</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><span>Frequency_Moment_k</span><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> 
    </span><a href="Frequency_Moments.html"><span>Frequency_Moments</span></a><span>
    </span><a href="Landau_Ext.html"><span>Landau_Ext</span></a><span> 
    </span><a href="../Lp/Lp.html"><span>Lp.Lp</span></a><span>
    </span><a href="../Median_Method/Median.html"><span>Median_Method.Median</span></a><span>
    </span><a href="Product_PMF_Ext.html"><span>Product_PMF_Ext</span></a><span> 
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>This section contains a formalization of the algorithm for the $k$-th frequency moment.
</span><span>It is based on the algorithm described in \cite[\textsection 2.1]{alon1999}.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>type_synonym</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.fk_state|type"><span>fk_state</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_k.fk_init.elims|fact"><span class="entity_def" id="Frequency_Moment_k.fk_init.induct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_init.simps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_init.pelims|fact"><span class="entity_def" id="Frequency_Moment_k.fk_init.cases|fact"><span class="entity_def" id="Frequency_Moment_k.fk_init.termination|fact"><span class="entity_def" id="Frequency_Moment_k.fk_init.pinduct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_init.psimps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_init_rel.inducts|fact"><span class="entity_def" id="Frequency_Moment_k.fk_init_rel.simps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_init_rel.induct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_init_rel.cases|fact"><span class="entity_def" id="Frequency_Moment_k.fk_init_rel.intros|fact"><span class="entity_def" id="Frequency_Moment_k.fk_init_graph.inducts|fact"><span class="entity_def" id="Frequency_Moment_k.fk_init_graph.simps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_init_graph.induct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_init_graph.cases|fact"><span class="entity_def" id="Frequency_Moment_k.fk_init_graph.intros|fact"><span class="entity_def" id="Frequency_Moment_k.fk_init.elims|thm"><span class="entity_def" id="Frequency_Moment_k.fk_init.induct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_init.simps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_init.pelims|thm"><span class="entity_def" id="Frequency_Moment_k.fk_init.cases|thm"><span class="entity_def" id="Frequency_Moment_k.fk_init.termination|thm"><span class="entity_def" id="Frequency_Moment_k.fk_init.pinduct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_init.psimps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_init_rel.inducts|thm"><span class="entity_def" id="Frequency_Moment_k.fk_init_rel.simps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_init_rel.induct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_init_rel.cases|thm"><span class="entity_def" id="Frequency_Moment_k.fk_init_graph.inducts|thm"><span class="entity_def" id="Frequency_Moment_k.fk_init_graph.simps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_init_graph.induct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_init_graph.cases|thm"><span class="entity_def" id="Frequency_Moment_k.fk_init_graph.intros|thm"><span class="entity_def" id="Frequency_Moment_k.fk_init_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_init_rel_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_init_sumC_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_init_graph_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_init_dom|const"><span class="entity_def" id="Frequency_Moment_k.fk_init_rel|const"><span class="entity_def" id="Frequency_Moment_k.fk_init_sumC|const"><span class="entity_def" id="Frequency_Moment_k.fk_init_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_k.fk_init|const"><span>fk_init</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_state|type"><span>fk_state</span></a><span> </span><span>pmf</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>fk_init</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Î´</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Îµ</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span>real</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Î´</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>â</span></span><span class="main"><span>;</span></span><span>
      </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="main"><span>-</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Îµ</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span class="main"><span>;</span></span><span>
      </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_k.fk_update.elims|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update.induct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update.simps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update.pelims|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update.cases|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update.termination|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update.pinduct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update.psimps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_rel.inducts|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_rel.simps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_rel.induct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_rel.cases|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_rel.intros|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_graph.inducts|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_graph.simps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_graph.induct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_graph.cases|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_graph.intros|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update.elims|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update.induct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update.simps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update.pelims|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update.cases|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update.termination|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update.pinduct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update.psimps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_rel.inducts|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_rel.simps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_rel.induct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_rel.cases|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_graph.inducts|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_graph.simps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_graph.induct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_graph.cases|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_graph.intros|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_update_rel_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_update_sumC_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_update_graph_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_update_dom|const"><span class="entity_def" id="Frequency_Moment_k.fk_update_rel|const"><span class="entity_def" id="Frequency_Moment_k.fk_update_sumC|const"><span class="entity_def" id="Frequency_Moment_k.fk_update_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_k.fk_update|const"><span>fk_update</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_state|type"><span>fk_state</span></a><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_state|type"><span>fk_state</span></a><span> </span><span>pmf</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>fk_update</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>1</sub></span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>2</sub></span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>r</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="bound"><span>coins</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>1</sub></span></span></span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>2</sub></span></span></span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>bernoulli_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>1</sub></span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>2</sub></span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>1</sub></span></span></span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>2</sub></span></span></span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> 
        </span><span class="keyword1"><span>if</span></span><span> </span><span class="bound"><span>coins</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="keyword1"><span>then</span></span><span> 
          </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span class="main"><span>,</span></span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> 
        </span><span class="keyword1"><span>else</span></span><span> </span><span class="main"><span>(</span></span><span>
          </span><span class="keyword1"><span>let</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>l</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>r</span></span></span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>l</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>=</span></span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_k.fk_result.elims|fact"><span class="entity_def" id="Frequency_Moment_k.fk_result.induct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_result.simps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_result.pelims|fact"><span class="entity_def" id="Frequency_Moment_k.fk_result.cases|fact"><span class="entity_def" id="Frequency_Moment_k.fk_result.termination|fact"><span class="entity_def" id="Frequency_Moment_k.fk_result.pinduct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_result.psimps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_result_rel.inducts|fact"><span class="entity_def" id="Frequency_Moment_k.fk_result_rel.simps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_result_rel.induct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_result_rel.cases|fact"><span class="entity_def" id="Frequency_Moment_k.fk_result_rel.intros|fact"><span class="entity_def" id="Frequency_Moment_k.fk_result_graph.inducts|fact"><span class="entity_def" id="Frequency_Moment_k.fk_result_graph.simps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_result_graph.induct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_result_graph.cases|fact"><span class="entity_def" id="Frequency_Moment_k.fk_result_graph.intros|fact"><span class="entity_def" id="Frequency_Moment_k.fk_result.elims|thm"><span class="entity_def" id="Frequency_Moment_k.fk_result.induct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_result.simps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_result.pelims|thm"><span class="entity_def" id="Frequency_Moment_k.fk_result.cases|thm"><span class="entity_def" id="Frequency_Moment_k.fk_result.termination|thm"><span class="entity_def" id="Frequency_Moment_k.fk_result.pinduct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_result.psimps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_result_rel.inducts|thm"><span class="entity_def" id="Frequency_Moment_k.fk_result_rel.simps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_result_rel.induct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_result_rel.cases|thm"><span class="entity_def" id="Frequency_Moment_k.fk_result_graph.inducts|thm"><span class="entity_def" id="Frequency_Moment_k.fk_result_graph.simps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_result_graph.induct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_result_graph.cases|thm"><span class="entity_def" id="Frequency_Moment_k.fk_result_graph.intros|thm"><span class="entity_def" id="Frequency_Moment_k.fk_result_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_result_rel_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_result_sumC_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_result_graph_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_result_dom|const"><span class="entity_def" id="Frequency_Moment_k.fk_result_rel|const"><span class="entity_def" id="Frequency_Moment_k.fk_result_sumC|const"><span class="entity_def" id="Frequency_Moment_k.fk_result_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_k.fk_result|const"><span>fk_result</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_state|type"><span>fk_state</span></a><span> </span><span class="main"><span>â</span></span><span> </span><span>rat</span><span> </span><span>pmf</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>fk_result</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>1</sub></span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>2</sub></span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>r</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Median_Method/Median.html#Median.median|const"><span>median</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>2</sub></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>2</sub></span></span></span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>1</sub></span></span></span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>rat_of_nat</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>t</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>snd</span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>r</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>t</span></span><span class="main"><span>^</span></span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>t</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>rat_of_nat</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>s<span class="hidden">â©</span><sub>1</sub></span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.bernoulli_pmf_1|fact"><span class="entity_def" id="Frequency_Moment_k.bernoulli_pmf_1|thm"><span>bernoulli_pmf_1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>bernoulli_pmf</span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>return_pmf</span><span> </span><span>True</span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>pmf_eqI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>indicator_def</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage.elims|fact"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage.induct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage.simps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage.pelims|fact"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage.cases|fact"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage.termination|fact"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage.pinduct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage.psimps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_rel.inducts|fact"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_rel.simps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_rel.induct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_rel.cases|fact"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_rel.intros|fact"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_graph.inducts|fact"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_graph.simps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_graph.induct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_graph.cases|fact"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_graph.intros|fact"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage.elims|thm"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage.induct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage.simps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage.pelims|thm"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage.cases|thm"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage.termination|thm"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage.pinduct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage.psimps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_rel.inducts|thm"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_rel.simps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_rel.induct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_rel.cases|thm"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_graph.inducts|thm"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_graph.simps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_graph.induct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_graph.cases|thm"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_graph.intros|thm"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_rel_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_sumC_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_graph_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_dom|const"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_rel|const"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_sumC|const"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_k.fk_space_usage|const"><span>fk_space_usage</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>fk_space_usage</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Îµ</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Î´</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>
    </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="numeral"><span>3</span></span><span class="main"><span>*</span></span><span>real</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Î´</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><span>in</span></span><span>
    </span><span class="keyword1"><span>let</span></span><span> </span><span class="bound"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Îµ</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><span>in</span></span><span> 
    </span><span class="numeral"><span>4</span></span><span> </span><span class="main"><span>+</span></span><span>
    </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>
    </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>
    </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>k</span></span></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>
    </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>
    </span><span class="bound"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="bound"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>n</span></span></span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_k.encode_fk_state_def|fact"><span class="entity_def" id="Frequency_Moment_k.encode_fk_state_def|thm"><span class="entity_def" id="Frequency_Moment_k.encode_fk_state_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_k.encode_fk_state|const"><span>encode_fk_state</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_state|type"><span>fk_state</span></a><span> </span><span class="main"><span>â</span></span><span> </span><span>bool</span><span> </span><span>list</span><span> </span><span>option</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>encode_fk_state</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>.</span></span><span> 
    </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_dependent_prod|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>.</span></span><span> 
    </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_prod|const"><span>Ã<span class="hidden">â©</span><sub>e</sub></span></a></span><span>  
    </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_prod|const"><span>Ã<span class="hidden">â©</span><sub>e</sub></span></a></span><span>  
    </span><span class="main"><span>(</span></span><span>List.product</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="bound"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_prod|const"><span>Ã<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.encode_fk_state|const"><span>encode_fk_state</span></a><span> </span><span class="main"><span>(</span></span><span>dom</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.encode_fk_state|const"><span>encode_fk_state</span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.is_encoding|const"><span>is_encoding</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.encode_fk_state|const"><span>encode_fk_state</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.encode_fk_state_def|fact"><span>encode_fk_state_def</span></a><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.dependent_encoding|fact"><span>dependent_encoding</span></a><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.exp_golomb_encoding|fact"><span>exp_golomb_encoding</span></a><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.fun_encoding|fact"><span>fun_encoding</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encoding_imp_inj|fact"><span>encoding_imp_inj</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>This is an intermediate non-parallel form </span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update|const"><span>fk_update</span></a><span>"</span></span><span class="antiquote"><span>}</span></span></span><span> used only in the correctness proof.</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_k.fk_update_2.elims|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_2.induct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_2.simps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_2.pelims|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_2.cases|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_2.termination|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_2.pinduct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_2.psimps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_rel.inducts|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_rel.simps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_rel.induct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_rel.cases|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_rel.intros|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_graph.inducts|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_graph.simps|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_graph.induct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_graph.cases|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_graph.intros|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_2.elims|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_2.induct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_2.simps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_2.pelims|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_2.cases|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_2.termination|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_2.pinduct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_2.psimps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_rel.inducts|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_rel.simps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_rel.induct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_rel.cases|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_graph.inducts|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_graph.simps|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_graph.induct|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_graph.cases|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_graph.intros|thm"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_rel_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_sumC_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_graph_def|axiom"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_dom|const"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_rel|const"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_sumC|const"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_graph|const"><span>fun</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_k.fk_update_2|const"><span>fk_update_2</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span class="main"><span>)</span></span><span> </span><span>pmf</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>fk_update_2</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>,</span></span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span class="keyword1"><span>do</span></span><span> </span><span class="main"><span>{</span></span><span>
      </span><span class="bound"><span>coin</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>bernoulli_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>;</span></span><span>
      </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>m</span></span></span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>,</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="bound"><span>coin</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span class="main"><span>,</span></span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>l</span></span></span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>x</span></span></span></span><span class="main"><span>=</span></span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>}</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_k.sketch_def|fact"><span class="entity_def" id="Frequency_Moment_k.sketch_def|thm"><span class="entity_def" id="Frequency_Moment_k.sketch_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_k.sketch|const"><span>sketch</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>sketch</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>as</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>as</span></span></span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><span>,</span></span><span> </span><span>count_list</span><span> </span><span class="main"><span>(</span></span><span>drop</span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>as</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>as</span></span></span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_2764..2769">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.fk_update_2_distr|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_2_distr|thm"><span>fk_update_2_distr</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>[]</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2|const"><span>fk_update_2</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span>pmf_of_set</span><span> </span><span class="main"><span>{..&lt;</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch|const"><span>sketch</span></a><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_2764..2769"><span>assms</span></a><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>as</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span>rev_nonempty_induct</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_3016..3022">single</span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_3016..3022"><span>single</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>bind_return_pmf</span><span> </span><span>pmf_of_set_singleton</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.bernoulli_pmf_1|fact"><span>bernoulli_pmf_1</span></a><span> </span><span>lessThan_def</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch_def|fact"><span>sketch_def</span></a><span class="main"><span>)</span></span><span> 
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_3162..3166">snoc</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?h</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>count_list</span><span> </span><span class="main"><span>(</span></span><span>drop</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?q</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="bound"><span>xs</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch|const"><span>sketch</span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_3288..3297">non_empty</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>{..&lt;</span></span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>{..&lt;</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_3162..3166"><span>snoc</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_3378..3393">fk_update_2_eta</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2|const"><span>fk_update_2</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2|const"><span>fk_update_2</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span>fst</span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span>snd</span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>pmf_of_set</span><span> </span><span class="main"><span>{..&lt;</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>bernoulli_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>coin</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="bound"><span>coin</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span>bernoulli_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span>pmf_of_set</span><span> </span><span class="main"><span>{..&lt;</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span>
      </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="bound"><span>y</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>bind_commute_pmf</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>pmf_of_set</span><span> </span><span class="main"><span>{..&lt;</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_3162..3166"><span>snoc</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_3288..3297"><span>non_empty</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>pmf_eqI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>pmf_bind</span><span> </span><span>measure_pmf_of_set</span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>indicator_def</span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span> </span><span>frac_eq_eq</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_4010..4011">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>pmf_of_set</span><span> </span><span class="main"><span>{..&lt;</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>bernoulli_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>coin</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="bound"><span>coin</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>pmf_of_set</span><span> </span><span class="main"><span>{..&lt;</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
   
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2|const"><span>fk_update_2</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span class="main"><span>@</span></span><span class="main"><span>[</span></span><span class="skolem"><span>x</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span class="main"><span>(</span></span><span>pmf_of_set</span><span> </span><span class="main"><span>{..&lt;</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch|const"><span>sketch</span></a><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2|const"><span>fk_update_2</span></a><span> </span><span class="skolem"><span>x</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_3162..3166"><span>snoc</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>case_prod_beta'</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>pmf_of_set</span><span> </span><span class="main"><span>{..&lt;</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch|const"><span>sketch</span></a><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span class="bound"><span>a</span></span><span class="main"><span>,</span></span><span class="bound"><span>l</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span>bernoulli_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>m</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>coin</span></span><span class="main"><span>.</span></span><span> 
    </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>m</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>,</span></span><span> </span><span class="keyword1"><span>if</span></span><span> </span><span class="bound"><span>coin</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>l</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_3378..3393"><span>fk_update_2_eta</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2.simps|fact"><span>fk_update_2.simps</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>case_prod_beta'</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>pmf_of_set</span><span> </span><span class="main"><span>{..&lt;</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>bernoulli_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>coin</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>,</span></span><span> </span><span class="keyword1"><span>if</span></span><span> </span><span class="bound"><span>coin</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span class="var"><span>?h</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>of_bool</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>bind_assoc_pmf</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>bind_return_pmf</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch_def|fact"><span>sketch_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>pmf_of_set</span><span> </span><span class="main"><span>{..&lt;</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>bernoulli_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>coin</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="bound"><span>coin</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k'</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?q</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span class="main"><span>@</span></span><span class="main"><span>[</span></span><span class="skolem"><span>x</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>k'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_3288..3297"><span>non_empty</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>bind_pmf_cong</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>bind_return_pmf</span><span> </span><span>nth_append</span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.count_list_append|fact"><span>count_list_append</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch_def|fact"><span>sketch_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>pmf_of_set</span><span> </span><span class="main"><span>{..&lt;</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>bernoulli_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>coin</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="bound"><span>coin</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k'</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?q</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span class="main"><span>@</span></span><span class="main"><span>[</span></span><span class="skolem"><span>x</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>k'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>bind_assoc_pmf</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><span>bind_assoc_pmf</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>pmf_of_set</span><span> </span><span class="main"><span>{..&lt;</span></span><span>length</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span class="main"><span>@</span></span><span class="main"><span>[</span></span><span class="skolem"><span>x</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k'</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?q</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span class="main"><span>@</span></span><span class="main"><span>[</span></span><span class="skolem"><span>x</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>k'</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_4010..4011"><span>b</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>context</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>rat</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>as</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_5767..5773">k_ge_1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_5793..5800">Îµ_range</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>&lt;..&lt;</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_5827..5834">Î´_range</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_5854..5862">as_range</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>set</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_k.s\&lt;^sub&gt;1_def|fact"><span class="entity_def" id="Frequency_Moment_k.s\&lt;^sub&gt;1_def|thm"><span class="entity_def" id="Frequency_Moment_k.s\&lt;^sub&gt;1_def_raw|axiom"><span class="entity_def" id="offset_5889..5899">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_k.s\&lt;^sub&gt;1|const"><span class="entity_def" id="offset_5900..5903">s<span class="hidden">â©</span><sub>1</sub></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>s<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span>real</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>â</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_k.s\&lt;^sub&gt;2_def|fact"><span class="entity_def" id="Frequency_Moment_k.s\&lt;^sub&gt;2_def|thm"><span class="entity_def" id="Frequency_Moment_k.s\&lt;^sub&gt;2_def_raw|axiom"><span class="entity_def" id="offset_5984..5994">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_k.s\&lt;^sub&gt;2|const"><span class="entity_def" id="offset_5995..5998">s<span class="hidden">â©</span><sub>2</sub></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>s<span class="hidden">â©</span><sub>2</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="main"><span>-</span></span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_k.M\&lt;^sub&gt;1_def|fact"><span class="entity_def" id="Frequency_Moment_k.M\&lt;^sub&gt;1_def|thm"><span class="entity_def" id="Frequency_Moment_k.M\&lt;^sub&gt;1_def_raw|axiom"><span class="entity_def" id="offset_6047..6057">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Frequency_Moment_k.M\&lt;^sub&gt;1|const"><span class="entity_def" id="offset_6059..6062">M<span class="hidden">â©</span><sub>1</sub></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>u</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>u</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_k.\&lt;Omega&gt;\&lt;^sub&gt;1_def|fact"><span class="entity_def" id="Frequency_Moment_k.\&lt;Omega&gt;\&lt;^sub&gt;1_def|thm"><span class="entity_def" id="Frequency_Moment_k.\&lt;Omega&gt;\&lt;^sub&gt;1_def_raw|axiom"><span class="entity_def" id="offset_6096..6106">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Frequency_Moment_k.\&lt;Omega&gt;\&lt;^sub&gt;1|const"><span class="entity_def" id="offset_6108..6111">Î©<span class="hidden">â©</span><sub>1</sub></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure_pmf</span><span> </span><span class="main"><span>(</span></span><span>pmf_of_set</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_k.M\&lt;^sub&gt;2_def|fact"><span class="entity_def" id="Frequency_Moment_k.M\&lt;^sub&gt;2_def|thm"><span class="entity_def" id="Frequency_Moment_k.M\&lt;^sub&gt;2_def_raw|axiom"><span class="entity_def" id="offset_6145..6155">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Frequency_Moment_k.M\&lt;^sub&gt;2|const"><span class="entity_def" id="offset_6157..6160">M<span class="hidden">â©</span><sub>2</sub></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>pmf_of_set</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_k.\&lt;Omega&gt;\&lt;^sub&gt;2_def|fact"><span class="entity_def" id="Frequency_Moment_k.\&lt;Omega&gt;\&lt;^sub&gt;2_def|thm"><span class="entity_def" id="Frequency_Moment_k.\&lt;Omega&gt;\&lt;^sub&gt;2_def_raw|axiom"><span class="entity_def" id="offset_6218..6228">definition</span></span></span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="entity_def" id="Frequency_Moment_k.\&lt;Omega&gt;\&lt;^sub&gt;2|const"><span class="entity_def" id="offset_6230..6233">Î©<span class="hidden">â©</span><sub>2</sub></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>measure_pmf</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6157..6160"><span>M<span class="hidden">â©</span><sub>2</sub></span></a><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6254..6268">interpretation</span></span></span><span> </span><span>prob_space</span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6108..6111"><span>Î©<span class="hidden">â©</span><sub>1</sub></span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6096..6106"><span>Î©<span class="hidden">â©</span><sub>1</sub>_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>prob_space_measure_pmf</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_6344..6358">interpretation</span></span></span><span> Î©<span class="hidden">â©</span><sub>2</sub></span><span class="main"><span>:</span></span><span>prob_space</span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6230..6233"><span>Î©<span class="hidden">â©</span><sub>2</sub></span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6218..6228"><span>Î©<span class="hidden">â©</span><sub>2</sub>_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>prob_space_measure_pmf</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.split_space|fact"><span class="entity_def" id="Frequency_Moment_k.split_space|thm"><span class="entity_def" id="offset_6444..6455">split_space</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>a</span></span><span class="main"><span>â</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>u</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_6539..6545">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>A</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>A</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>u</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>v</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>u</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_6605..6606">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><span>snd</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>A</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6539..6545"><span>A_def</span></a><span> </span><span>inj_on_def</span><span class="main"><span>)</span></span><span> 

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>u</span></span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.count_list_gr_1|fact"><span>count_list_gr_1</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>force</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>A</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>set_eq_iff</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6539..6545"><span>A_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6047..6057"><span>M<span class="hidden">â©</span><sub>1</sub>_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>a</span></span><span class="main"><span>â</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>sum</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>snd</span><span class="main"><span>)</span></span><span>  </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>A</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>sum.cong</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>sum</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>sum</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>snd</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>A</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>sum.UNION_disjoint</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6539..6545"><span>A_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6539..6545"><span>A_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>sum</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>sum</span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="main"><span>`</span></span><span> </span><span class="skolem"><span>A</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>sum.cong</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>sum.reindex</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6605..6606"><span>a</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>u</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6539..6545"><span>A_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>sum.cong</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_7333..7338">lemma</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>[]</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.fin_space|fact"><span class="entity_def" id="Frequency_Moment_k.fin_space|thm"><span class="entity_def" id="offset_7367..7376">fin_space</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.non_empty_space|fact"><span class="entity_def" id="Frequency_Moment_k.non_empty_space|thm"><span class="entity_def" id="offset_7400..7415">non_empty_space</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.card_space|fact"><span class="entity_def" id="Frequency_Moment_k.card_space|thm"><span class="entity_def" id="offset_7436..7446">card_space</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>=</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>subsetI</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword3"><span class="command"><span>assume</span></span></span><span> </span><span class="entity_def" id="offset_7566..7567">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>fst</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7566..7567"><span>a</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>case_prod_beta</span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.count_list_gr_1|fact"><span>count_list_gr_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6047..6057"><span>M<span class="hidden">â©</span><sub>1</sub>_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>snd</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7566..7567"><span>a</span></a><span> </span><span>count_le_length</span><span> </span><span>order_less_le_trans</span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>case_prod_beta</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6047..6057"><span>M<span class="hidden">â©</span><sub>1</sub>_def</span></a><span class="main"><span>)</span></span><span> </span><span class="operator"><span>fast</span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>mem_Times_iff</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="entity_def" id="offset_7908..7917">fin_space</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>finite_subset</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>as</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7333..7338"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6047..6057"><span>M<span class="hidden">â©</span><sub>1</sub>_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>metis</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.count_list_gr_1|fact"><span>count_list_gr_1</span></a><span> </span><span>gr0I</span><span> </span><span>length_greater_0_conv</span><span> </span><span>not_one_le_zero</span><span> </span><span>nth_mem</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>=</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7908..7917"><span>fin_space</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6444..6455"><span>split_space</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>::</span></span><span>nat</span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>sum_count_set</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> X</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>set</span><span> </span><span class="free"><span>as</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> xs</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>as</span></span><span>"</span></span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8312..8317">lemma</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>[]</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.integrable_1|fact"><span class="entity_def" id="Frequency_Moment_k.integrable_1|thm"><span class="entity_def" id="offset_8346..8358">integrable_1</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6108..6111"><span>Î©<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>
    </span><span class="entity_def" id="Frequency_Moment_k.integrable_2|fact"><span class="entity_def" id="Frequency_Moment_k.integrable_2|thm"><span class="entity_def" id="offset_8401..8413">integrable_2</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6230..6233"><span>Î©<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>g</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>real</span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_8463..8472">fin_omega</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="main"><span>(</span></span><span>set_pmf</span><span> </span><span class="main"><span>(</span></span><span>pmf_of_set</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7367..7376"><span>fin_space</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_8312..8317"><span>assms</span></a><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7400..7415"><span>non_empty_space</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_8312..8317"><span>assms</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6108..6111"><span>Î©<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="free"><span>f</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6096..6106"><span>Î©<span class="hidden">â©</span><sub>1</sub>_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>integrable_measure_pmf_finite</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="main"><span>(</span></span><span>set_pmf</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6157..6160"><span>M<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6145..6155"><span>M<span class="hidden">â©</span><sub>2</sub>_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_8463..8472"><span>fin_omega</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.set_prod_pmf|fact"><span>set_prod_pmf</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>intro</span></span><span class="main"><span class="main"><span>:</span></span></span><span>finite_PiE</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>integrable</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6230..6233"><span>Î©<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="free"><span>g</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6218..6228"><span>Î©<span class="hidden">â©</span><sub>2</sub>_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>integrable_measure_pmf_finite</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_8882..8887">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.sketch_distr|fact"><span class="entity_def" id="Frequency_Moment_k.sketch_distr|thm"><span class="entity_def" id="offset_8888..8900">sketch_distr</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>[]</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>pmf_of_set</span><span> </span><span class="main"><span>{..&lt;</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch|const"><span>sketch</span></a><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>pmf_of_set</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â¹</span></span><span> 
    </span><span>count_list</span><span> </span><span class="main"><span>(</span></span><span>drop</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>as</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>count_list</span><span> </span><span class="main"><span>(</span></span><span>drop</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>as</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>y</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.count_list_lt_suffix|fact"><span>count_list_lt_suffix</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.suffix_drop_drop|fact"><span>suffix_drop_drop</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Suc_diff_Suc</span><span> </span><span>diff_Suc_Suc</span><span> </span><span>diff_add_inverse</span><span> </span><span>lessI</span><span> </span><span>less_natE</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_9279..9281">a1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>inj_on</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch|const"><span>sketch</span></a><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch_def|fact"><span>sketch_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>inj_onI</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>Pair_inject</span><span> </span><span>mem_Collect_eq</span><span> </span><span>nat_neq_iff</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>count_list</span><span> </span><span class="main"><span>(</span></span><span>drop</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>x</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>as</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>as</span></span><span> </span><span class="main"><span>!</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.count_list_lt_suffix|fact"><span>count_list_lt_suffix</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>suffix_drop</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch|const"><span>sketch</span></a><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>image_subsetI</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch_def|fact"><span>sketch_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6047..6057"><span>M<span class="hidden">â©</span><sub>1</sub>_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch|const"><span>sketch</span></a><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7436..7446"><span>card_space</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_8882..8887"><span>assms</span></a><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>1</span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>card_image</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_9279..9281"><span>a1</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch|const"><span>sketch</span></a><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7367..7376"><span>fin_space</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_8882..8887"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>card_seteq</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>bij_betw</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch|const"><span>sketch</span></a><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>}</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_9279..9281"><span>a1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>bij_betw_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>map_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch|const"><span>sketch</span></a><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>pmf_of_set</span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>pmf_of_set</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_8882..8887"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>map_pmf_of_set_bij_betw</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch_def|fact"><span>sketch_def</span></a><span> </span><span>map_pmf_def</span><span> </span><span>lessThan_def</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.fk_update_distr|fact"><span class="entity_def" id="Frequency_Moment_k.fk_update_distr|thm"><span class="entity_def" id="offset_10231..10246">fk_update_distr</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update|const"><span>fk_update</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_init|const"><span>fk_init</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
  </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2|const"><span>fk_update_2</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>Ã</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>snd</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>induction</span></span><span> </span><span class="quoted"><span class="free"><span>as</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span>rev_induct</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>Nil</span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span>Let_def</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5889..5899"><span>s<span class="hidden">â©</span><sub>1</sub>_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5984..5994"><span>s<span class="hidden">â©</span><sub>2</sub>_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>bind_return_pmf</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="main"><span>(</span></span><span class="entity_def" id="offset_10644..10648">snoc</span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10663..10678">fk_update_2_eta</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2|const"><span>fk_update_2</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2|const"><span>fk_update_2</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span>fst</span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span>snd</span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_10772..10773">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update|const"><span>fk_update</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>snd</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2|const"><span>fk_update_2</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>snd</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_11014..11015">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>f</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> 
                  </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2|const"><span>fk_update_2</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>f</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_11173..11174">c</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>fst</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>f</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_11202..11203">d</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>i</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[]</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
      </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_11014..11015"><span>b</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_11202..11203"><span>d</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>set_Pi_pmf</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>  
      </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_11363..11368">False</span><span>
      </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>{..&lt;</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
      </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_11014..11015"><span>b</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_11202..11203"><span>d</span></a><span> 
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>set_Pi_pmf</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2_distr|fact"><span>fk_update_2_distr</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_11363..11368"><span>False</span></a><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>PiE_dflt_def</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>force</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_10663..10678"><span>fk_update_2_eta</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2.simps|fact"><span>fk_update_2.simps</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.Pi_pmf_bind_return|fact"><span>Pi_pmf_bind_return</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> d'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>undefined</span><span>"</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>bind_assoc_pmf</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>bind_pmf_cong</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_11173..11174"><span>c</span></a><span> </span><span class="quasi_keyword"><span>cong</span></span><span class="main"><span class="main"><span>:</span></span></span><span>Pi_pmf_cong</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>bind_return_pmf</span><span> </span><span>case_prod_beta</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
 
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update|const"><span>fk_update</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>@</span></span><span> </span><span class="main"><span>[</span></span><span class="skolem"><span>x</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_init|const"><span>fk_init</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
     </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2|const"><span>fk_update_2</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>Ã</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>snd</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update|const"><span>fk_update</span></a><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_10644..10648"><span>snoc</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>restrict_def</span><span> </span><span>bind_assoc_pmf</span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_init.simps|fact"><span>fk_init.simps</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2|const"><span>fk_update_2</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>f</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2|const"><span>fk_update_2</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>snd</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_10772..10773"><span>a</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>bind_pmf_cong</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>bind_return_pmf</span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update.simps|fact"><span>fk_update.simps</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2|const"><span>fk_update_2</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><span>(</span></span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>f</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2|const"><span>fk_update_2</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>f</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>snd</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>bind_assoc_pmf</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2|const"><span>fk_update_2</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span class="main"><span>@</span></span><span class="main"><span>[</span></span><span class="skolem"><span>x</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span class="main"><span>@</span></span><span class="main"><span>[</span></span><span class="skolem"><span>x</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>Ã</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>snd</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><span>Pi_pmf_bind</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?case</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_13146..13151">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.power_diff_sum|fact"><span class="entity_def" id="Frequency_Moment_k.power_diff_sum|thm"><span class="entity_def" id="offset_13152..13166">power_diff_sum</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>fixes</span></span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="main"><span>{</span></span><span>comm_ring_1</span><span class="main"><span>,</span></span><span>power</span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>-</span></span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_13331..13340">insert_lb</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>m</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>insert</span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="main"><span>{</span></span><span>Suc</span><span> </span><span class="skolem"><span>m</span></span><span class="main"><span>..&lt;</span></span><span class="skolem"><span>n</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>{</span></span><span class="skolem"><span>m</span></span><span class="main"><span>..&lt;</span></span><span class="skolem"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span>nat</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?rhs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>sum</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>^</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>-</span></span><span> 
    </span><span>sum</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>^</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>sum_distrib_left</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>sum</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>^</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>-</span></span><span> 
    </span><span>sum</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>^</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>+</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>sum</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>^</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>-</span></span><span> 
    </span><span>sum</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>^</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>arg_cong2</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>(-)</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>sum.cong</span><span> </span><span>arg_cong2</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>(*)</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> 
        </span><span>arg_cong2</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span class="main"><span class="main"><span class="main"><span>Î»</span></span></span></span><span class="bound"><span class="bound"><span class="bound"><span>x</span></span></span></span><span> </span><span class="bound"><span class="bound"><span class="bound"><span>y</span></span></span></span><span class="main"><span class="main"><span class="main"><span>.</span></span></span></span><span> </span><span class="bound"><span class="bound"><span class="bound"><span>x</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>^</span></span></span></span><span> </span><span class="bound"><span class="bound"><span class="bound"><span>y</span></span></span></span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>sum</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>^</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>insert</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>1</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> 
    </span><span>sum</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>^</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>insert</span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>{</span></span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_13146..13151"><span>assms</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>sum.reindex</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_13331..13340"><span>insert_lb</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="var"><span>?lhs</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>presburger</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_14239..14244">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.power_diff_est|fact"><span class="entity_def" id="Frequency_Moment_k.power_diff_est|thm"><span class="entity_def" id="offset_14245..14259">power_diff_est</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>real</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="free"><span>b</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>b</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>-</span></span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_14239..14244"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span> </span><span>power_mono</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_14239..14244"><span>assms</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>power_add</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_14640..14641">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>a</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>-</span></span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_13152..13166"><span>power_diff_sum</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_14239..14244"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>-</span></span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span class="free"><span>k</span></span><span class="main"><span>.</span></span><span>  </span><span class="free"><span>a</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_14640..14641"><span>a</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_14239..14244"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span> </span><span>sum_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>a</span></span><span class="main"><span>-</span></span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>^</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Specialization of the Hoelder inquality for sums.</span><span>âº</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_15082..15087">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.Holder_inequality_sum|fact"><span class="entity_def" id="Frequency_Moment_k.Holder_inequality_sum|thm"><span class="entity_def" id="offset_15088..15109">Holder_inequality_sum</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>p</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>real</span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>q</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="free"><span>p</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="free"><span>q</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>finite</span><span> </span><span class="free"><span>A</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¦</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="free"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="free"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span class="free"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="free"><span>q</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="free"><span>q</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>Â¦</span></span><span class="keyword1"><span>LINT</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>|</span></span><span>count_space</span><span> </span><span class="free"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="keyword1"><span>LINT</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>|</span></span><span>count_space</span><span> </span><span class="free"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>f</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="keyword1"><span>LINT</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>|</span></span><span>count_space</span><span> </span><span class="free"><span>A</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="free"><span>g</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="free"><span>q</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="free"><span>q</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_15082..15087"><span>assms</span></a><span> </span><span>integrable_count_space</span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../Lp/Lp.html#Lp.Holder_inequality|fact"><span>Lp.Holder_inequality</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_15082..15087"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>lebesgue_integral_count_space_finite</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_15623..15628">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.real_count_list_pos|fact"><span class="entity_def" id="Frequency_Moment_k.real_count_list_pos|thm"><span class="entity_def" id="offset_15629..15648">real_count_list_pos</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.count_list_gr_1|fact"><span>count_list_gr_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_15623..15628"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_15750..15755">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.fk_estimate|fact"><span class="entity_def" id="Frequency_Moment_k.fk_estimate|thm"><span class="entity_def" id="offset_15756..15767">fk_estimate</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>[]</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>length</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_15931..15935">True</span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_15938..15944">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>M</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Max</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>`</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_15938..15944"><span>M_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_15750..15755"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>Max_in</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>m</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_16103..16107">m_in</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>m</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_16126..16131">m_def</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="skolem"><span>m</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_16176..16177">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_16103..16107"><span>m_in</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.count_list_gr_1|fact"><span>count_list_gr_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_16126..16131"><span>m_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>force</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_16253..16254">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="skolem"><span>m</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_16103..16107"><span>m_in</span></a><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.count_list_gr_1|fact"><span>count_list_gr_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>force</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="skolem"><span>m</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>powr_realpow</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_16126..16131"><span>m_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_16103..16107"><span>m_in</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>member_le_sum</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F_def|fact"><span>F_def</span></a><span> </span><span>of_rat_sum</span><span> </span><span>of_rat_power</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_16663..16664">d</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>M</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_16716..16717">e</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F_gr_0|fact"><span>F_gr_0</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_15750..15755"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>order_le_less</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_15750..15755"><span>assms</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_15931..15935"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_16253..16254"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>add_divide_distrib</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>force</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_17035..17036">f</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_16253..16254"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F_def|fact"><span>F_def</span></a><span> </span><span>of_rat_sum</span><span> </span><span>sum_distrib_left</span><span> </span><span>of_rat_mult</span><span> </span><span>power_add</span><span> </span><span>of_rat_power</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>â</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>sum_mono</span><span> </span><span>mult_right_mono</span><span> </span><span>power_mono</span><span> </span><span>of_nat_mono</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_15938..15944"><span>M_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="skolem"><span>M</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_16176..16177"><span>a</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>sum_distrib_left</span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F_def|fact"><span>F_def</span></a><span> </span><span>of_rat_mult</span><span> </span><span>of_rat_sum</span><span> </span><span>of_rat_power</span><span> </span><span>powr_realpow</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>M</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_16716..16717"><span>e</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>powr_powr</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span>  </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>/</span></span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_16663..16664"><span>d</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_right_mono</span><span> </span><span>powr_mono2</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>powr_add</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_17035..17036"><span>f</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_18026..18027">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_18123..18124">g</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>card_mono</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> _ </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5854..5862"><span>as_range</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>length</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>abs</span><span> </span><span class="main"><span>(</span></span><span>sum</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>of_nat_sum</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>sum_count_set</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>/</span></span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> 
    </span><span class="main"><span>(</span></span><span>sum</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_15750..15755"><span>assms</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_15931..15935"><span>True</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_15088..15109"><span>Holder_inequality_sum</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> p</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="free"><span class="free"><span>k</span></span></span></span><span class="main"><span class="main"><span class="main"><span>/</span></span></span></span><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span class="free"><span class="free"><span class="free"><span>k</span></span></span></span><span class="main"><span class="main"><span class="main"><span>-</span></span></span></span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> q</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="free"><span class="free"><span>k</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>Î»</span></span></span></span><span class="main"><span class="bound"><span class="main"><span class="bound"><span class="main"><span class="bound"><span>_</span></span></span></span></span></span></span><span class="main"><span class="main"><span class="main"><span>.</span></span></span></span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span> </span><span>add_divide_distrib</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_15629..15648"><span>real_count_list_pos</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F_def|fact"><span>F_def</span></a><span> </span><span>of_rat_sum</span><span> </span><span>of_rat_power</span><span> </span><span>powr_realpow</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span>card</span><span> </span><span class="main"><span>(</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5767..5773"><span>k_ge_1</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>of_nat_diff</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5767..5773"><span>k_ge_1</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><span>diff_divide_distrib</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5767..5773"><span>k_ge_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_18123..18124"><span>g</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_right_mono</span><span> </span><span>powr_mono2</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_19133..19134">h</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>length</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span>real</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_19229..19230">i</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real</span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_15931..15935"><span>True</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>add_divide_distrib</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>of_nat_diff</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_18026..18027"><span>a</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_19133..19134"><span>h</span></a><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F_ge_0|fact"><span>F_ge_0</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_mono</span><span> </span><span>mult_nonneg_nonneg</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_19229..19230"><span>i</span></a><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F_gr_0|fact"><span>F_gr_0</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_15750..15755"><span>assms</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>powr_add</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>powr_realpow</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_19692..19697">False</span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span>False</span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5854..5862"><span>as_range</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_15750..15755"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_15750..15755"><span>assms</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5767..5773"><span>k_ge_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_19692..19697"><span>False</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>length</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F_def|fact"><span>F_def</span></a><span> </span><span>sum_count_set</span><span> </span><span>of_nat_sum</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span>of_nat_sum</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power2_eq_square</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_k.result_def|fact"><span class="entity_def" id="Frequency_Moment_k.result_def|thm"><span class="entity_def" id="Frequency_Moment_k.result_def_raw|axiom"><span class="entity_def" id="offset_20046..20056">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_k.result|const"><span class="entity_def" id="offset_20057..20063">result</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>result</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>of_nat</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>snd</span><span> </span><span class="free"><span class="bound"><span class="entity"><span>a</span></span></span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_20144..20149">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.result_exp_1|fact"><span class="entity_def" id="Frequency_Moment_k.result_exp_1|thm"><span class="entity_def" id="offset_20150..20162">result_exp_1</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>[]</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6254..6268"><span>expectation</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span> </span><span class="main"><span>=</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6254..6268"><span>expectation</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>a</span></span><span class="main"><span>â</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>pmf</span><span> </span><span class="main"><span>(</span></span><span>pmf_of_set</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>)</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6096..6106"><span>Î©<span class="hidden">â©</span><sub>1</sub>_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7400..7415"><span>non_empty_space</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20144..20149"><span>assms</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7367..7376"><span>fin_space</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>integral_measure_pmf_real</span><span class="main"><span>)</span></span><span> </span><span class="operator"><span>auto</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>a</span></span><span class="main"><span>â</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
   </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7400..7415"><span>non_empty_space</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20144..20149"><span>assms</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7367..7376"><span>fin_space</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7436..7446"><span>card_space</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>a</span></span><span class="main"><span>â</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>snd</span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20144..20149"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20046..20056"><span>result_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>u</span></span><span class="main"><span>â</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5767..5773"><span>k_ge_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6444..6455"><span>split_space</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>of_nat_diff</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>u</span></span><span class="main"><span>â</span></span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>u</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5767..5773"><span>k_ge_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>sum_Suc_diff'</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>zero_power</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F_def|fact"><span>F_def</span></a><span> </span><span>of_rat_sum</span><span> </span><span>of_rat_power</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_21048..21053">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.result_var_1|fact"><span class="entity_def" id="Frequency_Moment_k.result_var_1|thm"><span class="entity_def" id="offset_21054..21066">result_var_1</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>[]</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6254..6268"><span>variance</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>  
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_21183..21189">k_gt_0</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5767..5773"><span>k_ge_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_21232..21233">c</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_21318..21321">c_1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>v</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>v</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_21183..21189"><span>k_gt_0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_14245..14259"><span>power_diff_est</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> a</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span>Suc</span><span> </span><span class="skolem"><span>v</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> b</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>v</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>v</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>v</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>real</span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="skolem"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span> </span><span>Suc</span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_21318..21321"><span>c_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span> </span><span>power_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>length</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>a</span></span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span>  </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
    </span><span>length</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>a</span></span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> 
    </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="bound"><span>v</span></span><span class="main"><span>^</span></span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6444..6455"><span>split_space</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power2_eq_square</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>a</span></span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> 
    </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_21232..21233"><span>c</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span> </span><span>sum_mono</span><span> </span><span>mult_right_mono</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power_mono</span><span> </span><span>of_nat_diff</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>a</span></span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>v</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>sum_distrib_left</span><span> </span><span class="dynamic"><span class="dynamic"><span>ac_simps</span></span></span><span> </span><span>of_nat_diff</span><span> </span><span>power_mono</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>a</span></span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_21048..21053"><span>assms</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5767..5773"><span>k_ge_1</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>sum_Suc_diff'</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>zero_power</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_21183..21189"><span>k_gt_0</span></a><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>mult_2</span><span> </span><span>power_add</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span class="main"><span>*</span></span><span class="free"><span>k</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>sum_distrib_left</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F_def|fact"><span>F_def</span></a><span> </span><span>of_rat_sum</span><span> </span><span>of_rat_power</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_15756..15767"><span>fk_estimate</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_21048..21053"><span>assms</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>mult.commute</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_23060..23061">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>a</span></span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
    </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6254..6268"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>real</span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6254..6268"><span>expectation</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6254..6268"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>a</span></span><span class="main"><span>â</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>snd</span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>pmf</span><span> </span><span class="main"><span>(</span></span><span>pmf_of_set</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>)</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7367..7376"><span>fin_space</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7400..7415"><span>non_empty_space</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_21048..21053"><span>assms</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6096..6106"><span>Î©<span class="hidden">â©</span><sub>1</sub>_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20046..20056"><span>result_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>integral_measure_pmf_real</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> A</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a></a></a><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>a</span></span><span class="main"><span>â</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>Suc</span><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>snd</span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><span>^</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_21048..21053"><span>assms</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7400..7415"><span>non_empty_space</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7367..7376"><span>fin_space</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>pmf_of_set</span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7436..7446"><span>card_space</span></a><span> </span><span>power_mult_distrib</span><span> </span><span>power2_eq_square</span><span> </span><span class="dynamic"><span class="dynamic"><span>ac_simps</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_23060..23061"><span>b</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>sum_distrib_left</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>ac_simps</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6254..6268"><span>expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6254..6268"><span>expectation</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
    </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_8346..8358"><span>integrable_1</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_21048..21053"><span>assms</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6254..6268"><span>variance_eq</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_24225..24232">theorem</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.fk_alg_sketch|fact"><span class="entity_def" id="Frequency_Moment_k.fk_alg_sketch|thm"><span class="entity_def" id="offset_24233..24246">fk_alg_sketch</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>[]</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>state</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>state</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update|const"><span>fk_update</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_init|const"><span>fk_init</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span>map_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6157..6160"><span>M<span class="hidden">â©</span><sub>2</sub></span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>s</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2|const"><span>fk_update_2</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>snd</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_10231..10246"><span>fk_update_distr</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>pmf_of_set</span><span> </span><span class="main"><span>{..&lt;</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch|const"><span>sketch</span></a><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>snd</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update_2_distr|fact"><span>fk_update_2_distr</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_24225..24232"><span>assms</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>pmf_of_set</span><span> </span><span class="main"><span>{..&lt;</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch|const"><span>sketch</span></a><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>s</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>s</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>snd</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>bind_assoc_pmf</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><span>bind_return_pmf</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>pmf_of_set</span><span> </span><span class="main"><span>{..&lt;</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch|const"><span>sketch</span></a><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span>snd</span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.Pi_pmf_bind_return|fact"><span>Pi_pmf_bind_return</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> d'</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>undefined</span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>restrict_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.prod_pmf|const"><span>prod_pmf</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>pmf_of_set</span><span> </span><span class="main"><span>{..&lt;</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>k</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.sketch|const"><span>sketch</span></a><span> </span><span class="free"><span>as</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span>restrict</span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>bind_assoc_pmf</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>bind_return_pmf</span><span> </span><span class="quasi_keyword"><span>cong</span></span><span class="main"><span class="main"><span>:</span></span></span><span>restrict_cong</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6157..6160"><span>M<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="main"><span>â¤</span></span><span>
    </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span>restrict</span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_8888..8900"><span>sketch_distr</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_24225..24232"><span>assms</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6145..6155"><span>M<span class="hidden">â©</span><sub>2</sub>_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6157..6160"><span>M<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>bind_pmf_cong</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>PiE_dflt_def</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6145..6155"><span>M<span class="hidden">â©</span><sub>2</sub>_def</span></a><span> </span><span>set_Pi_pmf</span><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>map_pmf_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_k.mean_rv_def|fact"><span class="entity_def" id="Frequency_Moment_k.mean_rv_def|thm"><span class="entity_def" id="Frequency_Moment_k.mean_rv_def_raw|axiom"><span class="entity_def" id="offset_26268..26278">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_k.mean_rv|const"><span class="entity_def" id="offset_26279..26286">mean_rv</span></span></span><span> 
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>mean_rv</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i<span class="hidden">â©</span><sub>2</sub></span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i<span class="hidden">â©</span><sub>2</sub></span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>of_nat</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Frequency_Moment_k.median_rv_def|fact"><span class="entity_def" id="Frequency_Moment_k.median_rv_def|thm"><span class="entity_def" id="Frequency_Moment_k.median_rv_def_raw|axiom"><span class="entity_def" id="offset_26368..26378">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Frequency_Moment_k.median_rv|const"><span class="entity_def" id="offset_26379..26388">median_rv</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>median_rv</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="../Median_Method/Median.html#Median.median|const"><span>median</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26279..26286"><span>mean_rv</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>Ï</span></span></span></span><span> </span><span class="bound"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_26450..26455">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.fk_alg_correct&apos;|fact"><span class="entity_def" id="Frequency_Moment_k.fk_alg_correct&apos;|thm"><span>fk_alg_correct'</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>state</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>state</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update|const"><span>fk_update</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_init|const"><span>fk_init</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_result|const"><span>fk_result</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>ð«(</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span>measure_pmf</span><span> </span><span class="free"><span class="free"><span>M</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_rat</span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>as</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[]</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_26664..26668">True</span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_26676..26677">a</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5793..5800"><span>Îµ_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> 
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26664..26668"><span>True</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5793..5800"><span>Îµ_range</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F_def|fact"><span>F_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26450..26455"><span>M_def</span></a><span> </span><span>bind_return_pmf</span><span> </span><a class="entity_ref" href="../Median_Method/Median.html#Median.median_const|fact"><span>median_const</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26676..26677"><span>a</span></a><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>Let_def</span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_26863..26868">False</span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>set</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>{}</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26450..26455"><span>assms</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26863..26868"><span>False</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_26926..26935">n_nonzero</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>n</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5854..5862"><span>as_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_26981..26991">fk_nonzero</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F_gr_0|fact"><span>F_gr_0</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26863..26868"><span>False</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27049..27059">s1_nonzero</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5827..5834"><span>Î´_range</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5767..5773"><span>k_ge_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26926..26935"><span>n_nonzero</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5889..5899"><span>s<span class="hidden">â©</span><sub>1</sub>_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27135..27145">s2_nonzero</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5793..5800"><span>Îµ_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5984..5994"><span>s<span class="hidden">â©</span><sub>2</sub>_def</span></a><span class="main"><span>)</span></span><span> 

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27206..27225">real_of_rat_mean_rv</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26279..26286"><span>mean_rv</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>.</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26279..26286"><span>mean_rv</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>ext</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>of_rat_divide</span><span> </span><span>of_rat_sum</span><span> </span><span>of_rat_mult</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20046..20056"><span>result_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26268..26278"><span>mean_rv_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27374..27395">real_of_rat_median_rv</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26379..26388"><span>median_rv</span></a><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26379..26388"><span>median_rv</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26368..26378"><span>median_rv_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_27135..27145"><span>s2_nonzero</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_27206..27225"><span>real_of_rat_mean_rv</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Median_Method/Median.html#Median.median_rat|fact"><span>median_rat</span></a><span> </span><a class="entity_ref" href="../Median_Method/Median.html#Median.median_restrict|fact"><span>median_restrict</span></a><span class="main"><span>)</span></span><span>


  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27570..27579">space_Î©<span class="hidden">â©</span><sub>2</sub></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>space</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6230..6233"><span>Î©<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="main"><span>=</span></span><span> </span><span>UNIV</span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6218..6228"><span>Î©<span class="hidden">â©</span><sub>2</sub>_def</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27630..27643">fk_result_eta</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_result|const"><span>fk_result</span></a><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span class="bound"><span>z</span></span><span class="main"><span>,</span></span><span class="bound"><span>u</span></span><span class="main"><span>,</span></span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_result|const"><span>fk_result</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span class="bound"><span>y</span></span><span class="main"><span>,</span></span><span class="bound"><span>z</span></span><span class="main"><span>,</span></span><span class="bound"><span>u</span></span><span class="main"><span>,</span></span><span class="bound"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> 

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_27719..27720">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span> </span><span class="bound"><span>state</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>state</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update|const"><span>fk_update</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_init|const"><span>fk_init</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> 
    </span><span>map_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6157..6160"><span>M<span class="hidden">â©</span><sub>2</sub></span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_24233..24246"><span>fk_alg_sketch</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26863..26868"><span>False</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5889..5899"><span>s<span class="hidden">â©</span><sub>1</sub>_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5984..5994"><span>s<span class="hidden">â©</span><sub>2</sub>_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><span>map_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6157..6160"><span>M<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_result|const"><span>fk_result</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26450..26455"><span>M_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_27719..27720"><span>a</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6157..6160"><span>M<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26379..26388"><span>median_rv</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_27630..27643"><span>fk_result_eta</span></a><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>map_pmf_def</span><span> </span><span>bind_assoc_pmf</span><span> </span><span>bind_return_pmf</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26368..26378"><span>median_rv_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26268..26278"><span>mean_rv_def</span></a><span> </span><span>comp_def</span><span> 
       </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6047..6057"><span>M<span class="hidden">â©</span><sub>1</sub>_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20046..20056"><span>result_def</span></a><span> </span><a class="entity_ref" href="../Median_Method/Median.html#Median.median_restrict|fact"><span>median_restrict</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_28263..28264">b</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6157..6160"><span>M<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="main"><span>â¤</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26379..26388"><span>median_rv</span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_28321..28331">result_exp</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="main"><span>â¹</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="skolem"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6218..6228"><span>Î©<span class="hidden">â©</span><sub>2</sub>_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6145..6155"><span>M<span class="hidden">â©</span><sub>2</sub>_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_8346..8358"><span>integrable_1</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26863..26868"><span>False</span></a><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20150..20162"><span>result_exp_1</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26863..26868"><span>False</span></a><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.expectation_Pi_pmf_slice|fact"><span>expectation_Pi_pmf_slice</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6096..6106"><span>Î©<span class="hidden">â©</span><sub>1</sub>_def</span></a><span class="main"><span>)</span></span><span>


  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_28601..28611">result_var</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>3</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_28703..28719">result_var_assms</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span> </span><span class="skolem"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span class="main"><span>(</span></span><span>of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5827..5834"><span>Î´_range</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span>  </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5889..5899"><span>s<span class="hidden">â©</span><sub>1</sub>_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_mono</span><span> </span><span>of_nat_ceiling</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_29067..29075">f2_var_2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span>of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>i<span class="hidden">â©</span><sub>1</sub></span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>i<span class="hidden">â©</span><sub>2</sub></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span>real</span><span class="main"><span>)</span></span><span>  </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6254..6268"><span>variance</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_28703..28719"><span>result_var_assms</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_8346..8358"><span>integrable_1</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26863..26868"><span>False</span></a><span class="main"><span>]</span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6218..6228"><span>Î©<span class="hidden">â©</span><sub>2</sub>_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6145..6155"><span>M<span class="hidden">â©</span><sub>2</sub>_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6096..6106"><span>Î©<span class="hidden">â©</span><sub>1</sub>_def</span></a><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.variance_prod_pmf_slice|fact"><span>variance_prod_pmf_slice</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26450..26455"><span>assms</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26863..26868"><span>False</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_21054..21066"><span>result_var_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6096..6106"><span>Î©<span class="hidden">â©</span><sub>1</sub>_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>
      </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="free"><span>k</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>ac_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>of_rat</span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>3</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_29067..29075"><span>f2_var_2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>mult_left_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>3</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>of_rat_mult</span><span> </span><span>power_mult_distrib</span><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>ac_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_30000..30011">mean_rv_exp</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26279..26286"><span>mean_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_30079..30096">mean_rv_exp_assms</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>i</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26279..26286"><span>mean_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26268..26278"><span>mean_rv_def</span></a><span> </span><span>sum_divide_distrib</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>n</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_8401..8413"><span>integrable_2</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26863..26868"><span>False</span></a><span class="main"><span>]</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><span>Bochner_Integration.integral_sum</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_27049..27059"><span>s1_nonzero</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_30079..30096"><span>mean_rv_exp_assms</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_28321..28331"><span>result_exp</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_30624..30635">mean_rv_var</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26279..26286"><span>mean_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>/</span></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_30709..30726">mean_rv_var_assms</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>i</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_30763..30764">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.indep_vars</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>borel</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>n</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6218..6228"><span>Î©<span class="hidden">â©</span><sub>2</sub>_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6145..6155"><span>M<span class="hidden">â©</span><sub>2</sub>_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_30709..30726"><span>mean_rv_var_assms</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.indep_vars_restrict_intro&apos;|fact"><span>indep_vars_restrict_intro'</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>fst</span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl_def|fact"><span>restrict_dfl_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26279..26286"><span>mean_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>j</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26268..26278"><span>mean_rv_def</span></a><span> </span><span>sum_divide_distrib</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>j</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_30763..30764"><span>a</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_8401..8413"><span>integrable_2</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26863..26868"><span>False</span></a><span class="main"><span>]</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.var_sum_all_indep</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6218..6228"><span>Î©<span class="hidden">â©</span><sub>2</sub>_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_20057..20063"><span>result</span></a><span> </span><span class="main"><span>(</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>j</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_8401..8413"><span>integrable_2</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26863..26868"><span>False</span></a><span class="main"><span>]</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.variance_divide</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>j</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>/</span></span><span> </span><span class="numeral"><span>3</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_28601..28611"><span>result_var</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> _ </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_30709..30726"><span>mean_rv_var_assms</span></a><span class="main"><span>]</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>sum_mono</span><span> </span><span>divide_right_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>/</span></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_27049..27059"><span>s1_nonzero</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span> </span><span>power2_eq_square</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26279..26286"><span>mean_rv</span></a><span> </span><span class="bound"><span>y</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span> 
    </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>_</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span> </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_31982..31989">c_assms</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>i</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_32021..32027">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>a</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>a</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_32076..32077">c</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span class="skolem"><span>a</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span>  </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_32021..32027"><span>a_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26450..26455"><span>assms</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5827..5834"><span>Î´_range</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26981..26991"><span>fk_nonzero</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>zero_less_of_rat_iff</span><span> </span><span>mult_pos_pos</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span>?lhs</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>space</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6230..6233"><span>Î©<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26279..26286"><span>mean_rv</span></a><span> </span><span class="bound"><span>y</span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="main"><span>-</span></span><span>  </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.expectation</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26279..26286"><span>mean_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.pmf_mono</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6218..6228"><span>Î©<span class="hidden">â©</span><sub>2</sub>_def</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_32021..32027"><span>a_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_30000..30011"><span>mean_rv_exp</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_31982..31989"><span>c_assms</span></a><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_27570..27579"><span>space_Î©<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>)</span></span><span> 
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.variance</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26279..26286"><span>mean_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>/</span></span><span class="skolem"><span>a</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.Chebyshev_inequality</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_8401..8413"><span>integrable_2</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_32076..32077"><span>c</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26863..26868"><span>False</span></a><span class="main"><span>)</span></span><span>  </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6218..6228"><span>Î©<span class="hidden">â©</span><sub>2</sub>_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span class="numeral"><span>3</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_32076..32077"><span>c</span></a><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_30624..30635"><span>mean_rv_var</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_31982..31989"><span>c_assms</span></a><span class="main"><span>]</span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>algebra_simps</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_32021..32027"><span>a_def</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.indep_vars</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span>borel</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26279..26286"><span>mean_rv</span></a><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_27049..27059"><span>s1_nonzero</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6218..6228"><span>Î©<span class="hidden">â©</span><sub>2</sub>_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6145..6155"><span>M<span class="hidden">â©</span><sub>2</sub>_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.indep_vars_restrict_intro&apos;|fact"><span>indep_vars_restrict_intro'</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>snd</span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>finite_cartesian_product</span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26268..26278"><span>mean_rv_def</span></a><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.restrict_dfl_def|fact"><span>restrict_dfl_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_27570..27579"><span>space_Î©<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5984..5994"><span>s<span class="hidden">â©</span><sub>2</sub>_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>linarith</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_rat</span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
    </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span class="bound"><span>y</span></span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>space</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6230..6233"><span>Î©<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="../Median_Method/Median.html#Median.median|const"><span>median</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26279..26286"><span>mean_rv</span></a><span> </span><span class="bound"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5793..5800"><span>Îµ_range</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.median_bound_2</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_27570..27579"><span>space_Î©<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26379..26388"><span>median_rv</span></a><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26368..26378"><span>median_rv_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_27570..27579"><span>space_Î©<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span>  </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6344..6358"><span>Î©<span class="hidden">â©</span><sub>2</sub>.prob</span></a><span> </span><span class="main"><span>{</span></span><span class="bound"><span>y</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_26379..26388"><span>median_rv</span></a><span> </span><span class="bound"><span>y</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_27374..27395"><span>real_of_rat_median_rv</span></a><span> </span><span>of_rat_less_eq</span><span> </span><span class="quasi_keyword"><span>flip</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>of_rat_diff</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><span>ð«(</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span>measure_pmf</span><span> </span><span class="free"><span class="free"><span>M</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_28263..28264"><span>b</span></a><span> </span><span>comp_def</span><span> </span><span>map_pmf_def</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6218..6228"><span>Î©<span class="hidden">â©</span><sub>2</sub>_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_33713..33718">lemma</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.fk_exact_space_usage&apos;|fact"><span class="entity_def" id="Frequency_Moment_k.fk_exact_space_usage&apos;|thm"><span>fk_exact_space_usage'</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>state</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>state</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update|const"><span>fk_update</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_init|const"><span>fk_init</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>AE</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.encode_fk_state|const"><span>encode_fk_state</span></a><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_space_usage|const"><span>fk_space_usage</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>AE</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>_</span></span><span>  </span><span class="main"><span>â¤</span></span><span> </span><span class="var"><span>?rhs</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_33952..33958">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>H</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>H</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>if</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[]</span></span><span> </span><span class="keyword1"><span>then</span></span><span> </span><span>return_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>i</span></span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>Ã</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>,</span></span><span class="main"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>else</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6157..6160"><span>M<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_34052..34053">a</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>map_pmf</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>H</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>[]</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span class="entity_def" id="offset_34135..34139">True</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_33713..33718"><span>M_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_24233..24246"><span>fk_alg_sketch</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_34135..34139"><span>True</span></a><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_33952..33958"><span>H_def</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6145..6155"><span>M<span class="hidden">â©</span><sub>2</sub>_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
    </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_33952..33958"><span>H_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_33713..33718"><span>M_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5889..5899"><span>s<span class="hidden">â©</span><sub>1</sub>_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>Let_def</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5984..5994"><span>s<span class="hidden">â©</span><sub>2</sub>_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>map_pmf_def</span><span> </span><span>bind_return_pmf</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.encode_fk_state|const"><span>encode_fk_state</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_34478..34479">b</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set_pmf</span><span> </span><span class="skolem"><span>H</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>y</span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_34521..34523">b0</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â </span></span><span> </span><span class="main"><span>[]</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="keyword1"><span>â<span class="hidden">â©</span><sub>E</sub></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_34478..34479"><span>b</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7400..7415"><span>non_empty_space</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_7367..7376"><span>fin_space</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_33952..33958"><span>H_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6145..6155"><span>M<span class="hidden">â©</span><sub>2</sub>_def</span></a><span> </span><a class="entity_ref" href="Product_PMF_Ext.html#Product_PMF_Ext.set_prod_pmf|fact"><span>set_prod_pmf</span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_prod|const"><span>Ã<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
      </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>_</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="var"><span>?rhs1</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity_def" id="offset_34819..34827">b1_assms</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>x</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>Ã</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
    </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
      </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>fst</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>n</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>as</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[]</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_34478..34479"><span>b</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_34819..34827"><span>b1_assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_33952..33958"><span>H_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
        </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
        </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>1</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_34521..34523"><span>b0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_34819..34827"><span>b1_assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>PiE_iff</span><span> </span><span>case_prod_beta</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6047..6057"><span>M<span class="hidden">â©</span><sub>1</sub>_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>fastforce</span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>fst</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>set</span><span> </span><span class="free"><span>as</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.count_list_gr_1|fact"><span>count_list_gr_1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>metis</span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>meson</span></span><span> </span><span>lessThan_iff</span><span> </span><span>less_imp_le_nat</span><span> </span><span>subsetD</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5854..5862"><span>as_range</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>snd</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>as</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[]</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>True</span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_34478..34479"><span>b</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_34819..34827"><span>b1_assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_33952..33958"><span>H_def</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>next</span></span></span><span>
        </span><span class="keyword3"><span class="command"><span>case</span></span></span><span> </span><span>False</span><span>
        </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6059..6062"><span>M<span class="hidden">â©</span><sub>1</sub></span></a><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_34521..34523"><span>b0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_34819..34827"><span>b1_assms</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>auto</span></span><span>
        </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>snd</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span>count_list</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
          </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_6047..6057"><span>M<span class="hidden">â©</span><sub>1</sub>_def</span></a><span> </span><span>case_prod_beta</span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>count_le_length</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>metis</span></span><span> </span><span>order_trans</span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="main"><span>(</span></span><span>fst</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="main"><span>(</span></span><span>snd</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>y</span></span><span> </span><span class="skolem"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="var"><span>?rhs1</span></span><span>"</span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.exp_golomb_bit_count_est|fact"><span>exp_golomb_bit_count_est</span></a><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.dependent_bit_count_2|fact"><span>dependent_bit_count_2</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>moreover</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>y</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span>extensional</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>}</span></span><span> </span><span class="main"><span>Ã</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>}</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_34521..34523"><span>b0</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_34478..34479"><span>b</span></a><span> </span><span>PiE_iff</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>cases</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>as</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>[]</span></span><span>"</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_33952..33958"><span>H_def</span></a><span> </span><span>PiE_iff</span><span class="main"><span>)</span></span><span>

    </span><span class="keyword1"><span class="command"><span>ultimately</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><span>List.product</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>0</span></span><span class="main"><span>..&lt;</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_fun|const"><span>â<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.encode_prod|const"><span>Ã<span class="hidden">â©</span><sub>e</sub></span></a></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.N\&lt;^sub&gt;e|const"><span>N<span class="hidden">â©</span><sub>e</sub></span></a><span class="main"><span>)</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
      </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>
      </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.fun_bit_count_est|fact"><span>fun_bit_count_est</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> xs</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>(</span></span></span></span><span>List.product</span><span> </span><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span><span class="main"><span class="main"><span class="main"><span>0</span></span></span></span><span class="main"><span class="main"><span class="main"><span>..&lt;</span></span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a></a></a><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span><span> </span><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span><span class="main"><span class="main"><span class="main"><span>0</span></span></span></span><span class="main"><span class="main"><span class="main"><span>..&lt;</span></span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a></a></a><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span><span class="main"><span class="main"><span class="main"><span>)</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.encode_fk_state|const"><span>encode_fk_state</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> 
       </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> 
      </span><span class="main"><span>(</span></span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>  
      </span><span class="main"><span>(</span></span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>k</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> 
      </span><span class="main"><span>(</span></span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span>  
      </span><span class="main"><span>(</span></span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="free"><span>n</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> 
       </span><span>ereal</span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span class="main"><span>+</span></span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.encode_fk_state_def|fact"><span>encode_fk_state_def</span></a><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.dependent_bit_count|fact"><span>dependent_bit_count</span></a><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>add_mono</span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.exp_golomb_bit_count|fact"><span>exp_golomb_bit_count</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5889..5899"><span>s<span class="hidden">â©</span><sub>1</sub>_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5984..5994"><span>s<span class="hidden">â©</span><sub>2</sub>_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>Let_def</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>ac_simps</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.encode_fk_state|const"><span>encode_fk_state</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5900..5903"><span>s<span class="hidden">â©</span><sub>1</sub></span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_5995..5998"><span>s<span class="hidden">â©</span><sub>2</sub></span></a><span class="main"><span>,</span></span><span> </span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>y</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="var"><span>?rhs</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_34052..34053"><span>a</span></a><span> </span><span>AE_measure_pmf_iff</span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_space_usage.simps|fact"><span>fk_space_usage.simps</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>â¹</span><span>Main results of this section:</span><span>âº</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_37313..37320">theorem</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.fk_alg_correct|fact"><span class="entity_def" id="Frequency_Moment_k.fk_alg_correct|thm"><span>fk_alg_correct</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>&lt;..&lt;</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>set</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>state</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>state</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update|const"><span>fk_update</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_init|const"><span>fk_init</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_result|const"><span>fk_result</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>ð«(</span></span><span class="bound"><span class="bound"><span>Ï</span></span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span>measure_pmf</span><span> </span><span class="free"><span class="free"><span>M</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>Â¦</span></span><span class="bound"><span>Ï</span></span><span> </span><span class="main"><span>-</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>Â¦</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>*</span></span><span> </span><a class="entity_ref" href="Frequency_Moments.html#Frequency_Moments.F|const"><span>F</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>as</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span>of_rat</span><span> </span><span class="free"><span>Îµ</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_37313..37320"><span>M_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_alg_correct&apos;|fact"><span>fk_alg_correct'</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_37313..37320"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1-4</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_37651..37658">theorem</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.fk_exact_space_usage|fact"><span class="entity_def" id="Frequency_Moment_k.fk_exact_space_usage|thm"><span>fk_exact_space_usage</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>k</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="main"><span>1</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Îµ</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>0</span></span><span class="main"><span>&lt;..&lt;</span></span><span class="main"><span>1</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>Î´</span></span><span> </span><span class="main"><span>&gt;</span></span><span> </span><span class="main"><span>0</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>set</span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="main"><span>{..&lt;</span></span><span class="free"><span>n</span></span><span class="main"><span>}</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>defines</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>M</span></span><span> </span><span class="main"><span>â¡</span></span><span> </span><span>fold</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>a</span></span><span> </span><span class="bound"><span>state</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>state</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_update|const"><span>fk_update</span></a><span> </span><span class="bound"><span>a</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>as</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_init|const"><span>fk_init</span></a><span> </span><span class="free"><span>k</span></span><span> </span><span class="free"><span>Î´</span></span><span> </span><span class="free"><span>Îµ</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="keyword1"><span>AE</span></span><span> </span><span class="bound"><span>Ï</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>M</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Prefix_Free_Code_Combinators/Prefix_Free_Code_Combinators.html#Prefix_Free_Code_Combinators.bit_count|const"><span>bit_count</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.encode_fk_state|const"><span>encode_fk_state</span></a><span> </span><span class="bound"><span>Ï</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¤</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_space_usage|const"><span>fk_space_usage</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span>length</span><span> </span><span class="free"><span>as</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="free"><span>Î´</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_37651..37658"><span>M_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_exact_space_usage&apos;|fact"><span>fk_exact_space_usage'</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_37651..37658"><span>assms</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1-4</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>blast</span></span><span>

</span><span class="keyword1"><span class="command"><span>theorem</span></span></span><span> </span><span class="entity_def" id="Frequency_Moment_k.fk_asympotic_space_complexity|fact"><span class="entity_def" id="Frequency_Moment_k.fk_asympotic_space_complexity|thm"><span>fk_asympotic_space_complexity</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_space_usage|const"><span>fk_space_usage</span></a><span> </span><span class="main"><span>â</span></span><span> 
  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span>at_top</span><span> </span><span class="keyword1"><span>Ã<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span>at_top</span><span> </span><span class="keyword1"><span>Ã<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span>at_top</span><span> </span><span class="keyword1"><span>Ã<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span>at_right</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>rat</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>Ã<span class="hidden">â©</span><sub>F</sub></span></span><span> </span><span>at_right</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>0</span></span><span class="main"><span>::</span></span><span>rat</span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span>
  </span><span>real</span><span> </span><span class="bound"><span>k</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>n</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>of_rat</span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>of_rat</span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>_</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="var"><span>?rhs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_38305..38311">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>k_of</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>k_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>k</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_38395..38401">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>n_of</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>n_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_38485..38491">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>m_of</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>nat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>m_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_38575..38581">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>Îµ_of</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>rat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_38665..38671">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>Î´_of</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>Ã</span></span><span> </span><span>rat</span><span> </span><span class="main"><span>â</span></span><span> </span><span>rat</span><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span>(</span></span><span class="bound"><span>k</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>n</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>m</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Îµ</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>Î´</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_38756..38762">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>g1</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>g1</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>k_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>*</span></span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span class="main"><span>-</span></span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>k_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>^</span></span><span class="numeral"><span>2</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_38875..38881">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>g</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>g</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>g1</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_38988..38994">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>s1_of</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>s1_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> 
    </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>k_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>k_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span class="entity_def" id="offset_39126..39132">define</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>s2_of</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>s2_of</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>nat</span><span> </span><span class="main"><span>â</span></span><span class="main"><span>-</span></span><span> </span><span class="main"><span>(</span></span><span class="numeral"><span>18</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>â</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_39210..39213">evt</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> 
    </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>0</span></span><span> </span><span class="main"><span>&lt;</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â§</span></span><span> 
    </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="skolem"><span>Î´</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>/</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="skolem"><span>Îµ</span></span><span> </span><span class="main"><span>â§</span></span><span>
    </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>k_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="main"><span>â§</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¥</span></span><span> </span><span class="skolem"><span>m</span></span><span class="main"><span>â¹</span></span><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> 
    </span><span class="main"><span>â¹</span></span><span> </span><span>eventually</span><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="var"><span>?F</span></span><span>"</span></span></span><span>  </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>is</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>â</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="var"><span>?prem</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â¹</span></span><span> </span><span class="main"><span>_</span></span><span>"</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>Î´</span></span><span> </span><span class="skolem"><span>Îµ</span></span><span> </span><span class="skolem"><span>n</span></span><span> </span><span class="skolem"><span>k</span></span><span> </span><span class="skolem"><span>m</span></span><span> </span><span class="skolem"><span>P</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><span>eventually_mono</span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> P</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="var"><span class="var"><span>?prem</span></span></span><span>"</span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> Q</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span class="skolem"><span>P</span></span></span><span>"</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38575..38581"><span>Îµ_of_def</span></a><span> </span><span>case_prod_beta'</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38665..38671"><span>Î´_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38395..38401"><span>n_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38305..38311"><span>k_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38485..38491"><span>m_of_def</span></a><span class="main"><span>)</span></span><span>
     </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><span>eventually_conj</span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.eventually_prod1&apos;|fact"><span>eventually_prod1'</span></a><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.eventually_prod2&apos;|fact"><span>eventually_prod2'</span></a><span>
        </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.sequentially_inf|fact"><span>sequentially_inf</span></a><span> </span><span>eventually_at_right_less</span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.inv_at_right_0_inf|fact"><span>inv_at_right_0_inf</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>prod_filter_eq_bot</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_39817..39818">1</span><span class="main"><span>:</span></span><span> 
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>k_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><span>eventually_mono</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_39210..39213"><span>evt</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>


  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ln_2|fact"><span>landau_ln_2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> a</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span class="numeral"><span class="numeral"><span>2</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_39210..39213"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> m</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span class="numeral"><span class="numeral"><span>2</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_39817..39818"><span>1</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_40165..40166">2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_sum_2|fact"><span>landau_sum_2</span></a><span>  </span><span>eventually_mono</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_39210..39213"><span>evt</span></a><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span></span><span> m</span><span class="main"><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>log_def</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_40369..40370">3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>order_less_le_trans</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><span>exp_gt_zero</span><span class="main"><span>]</span></span><span> </span><span>ln_ge_iff</span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span>  </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_39210..39213"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> Îµ</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>exp</span><span> </span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.abs_ge_iff|fact"><span>abs_ge_iff</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_40580..40581">4</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>one_le_power</span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_39210..39213"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> Î´</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>power_one_over</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>order_less_le_trans</span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><span>exp_gt_zero</span><span class="main"><span>]</span></span><span> </span><span>ln_ge_iff</span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span>  </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_39210..39213"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span>exp</span><span> </span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moments_Preliminary_Results.html#Frequency_Moments_Preliminary_Results.abs_ge_iff|fact"><span>abs_ge_iff</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>blast</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_40962..40963">5</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_sum_1|fact"><span>landau_sum_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_39210..39213"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> m</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>-</span></span><span>ln</span><span class="main"><span>(</span></span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_39210..39213"><span>evt</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>ln_div</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_41238..41239">6</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>s2_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_39126..39132"><span>s2_of_def</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_nat_ceil|fact"><span>landau_nat_ceil</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_40369..40370"><span>3</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_41378..41379">7</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>k_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mono|fact"><span>landau_o.big_mono</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_39210..39213"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> k</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>ge_one_powr_ge_zero</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_41557..41558">8</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g1</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38756..38762"><span>g1_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1|fact"><span>landau_o.big_mult_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_39817..39818"><span>1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_41378..41379"><span>7</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_40580..40581"><span>4</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="numeral"><span>3</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>k_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>powr</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>-</span></span><span> </span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>k_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span class="main"><span>(</span></span><span>of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span><span class="hidden">â§</span><sup>2</sup></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g1</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>subst</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big.cmult_in_iff|fact"><span>landau_o.big.cmult_in_iff</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38756..38762"><span>g1_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_41826..41827">9</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>s1_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g1</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38988..38994"><span>s1_of_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_nat_ceil|fact"><span>landau_nat_ceil</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_41557..41558"><span>8</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span class="main"><span class="main"><span>:</span></span></span><span class="dynamic"><span class="dynamic"><span>ac_simps</span></span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_41945..41947">10</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38875..38881"><span>g_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1|fact"><span>landau_o.big_mult_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_41557..41558"><span>8</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_40369..40370"><span>3</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_40962..40963"><span>5</span></a><span class="main"><span>)</span></span><span>
  
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>s1_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38875..38881"><span>g_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1|fact"><span>landau_o.big_mult_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_40962..40963"><span>5</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_40369..40370"><span>3</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_41826..41827"><span>9</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>s1_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_41945..41947"><span>10</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ln_3|fact"><span>landau_ln_3</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_42242..42244">11</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>s1_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>log_def</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_42326..42328">12</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>s2_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>1</span></span><span> </span><span class="main"><span>/</span></span><span> </span><span>real_of_rat</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_39210..39213"><span>evt</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> Îµ</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span>2</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_41238..41239"><span>6</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_40369..40370"><span>3</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ln_3|fact"><span>landau_ln_3</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_42490..42492">13</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>s2_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38875..38881"><span>g_def</span></a><span> 
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1|fact"><span>landau_o.big_mult_1</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>rule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1&apos;|fact"><span>landau_o.big_mult_1'</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_41557..41558"><span>8</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_40962..40963"><span>5</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_42326..42328"><span>12</span></a><span> </span><span>log_def</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>k_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g1</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38756..38762"><span>g1_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_41378..41379"><span>7</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_40580..40581"><span>4</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1|fact"><span>landau_o.big_mult_1</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>k_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g1</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>log_def</span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ln_3|fact"><span>landau_ln_3</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_41557..41558"><span>8</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_42900..42902">14</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>k_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38875..38881"><span>g_def</span></a><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1|fact"><span>landau_o.big_mult_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_40369..40370"><span>3</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_40962..40963"><span>5</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_43013..43015">15</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38875..38881"><span>g_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_40165..40166"><span>2</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_41557..41558"><span>8</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_40369..40370"><span>3</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.big_mult_1&apos;|fact"><span>landau_o.big_mult_1'</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp_all</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_ln_2|fact"><span>landau_ln_2</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> a</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span class="numeral"><span class="numeral"><span>2</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>eventually_mono</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_39210..39213"><span>evt</span></a><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="numeral"><span class="numeral"><span class="numeral"><span>2</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_39817..39818"><span>1</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span>ln</span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="Landau_Ext.html#Landau_Ext.landau_sum_1|fact"><span>landau_sum_1</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_39210..39213"><span>evt</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><span class="operator"><span>where</span></span></span></span><span> n</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> m</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span class="main"><span>1</span></span></span></span><span>"</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>auto</span></span><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>log_def</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>hence</span></span></span><span> </span><span class="entity_def" id="offset_43496..43498">16</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>s1_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>s2_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>*</span></span><span>
    </span><span class="main"><span>(</span></span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>*</span></span><span> </span><span>log</span><span> </span><span class="numeral"><span>2</span></span><span> </span><span class="main"><span>(</span></span><span>real</span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>+</span></span><span> </span><span class="main"><span>1</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38875..38881"><span>g_def</span></a><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_41826..41827"><span>9</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_41238..41239"><span>6</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_40962..40963"><span>5</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_40165..40166"><span>2</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.landau_o.mult|fact"><span>landau_o.mult</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_space_usage|const"><span>fk_space_usage</span></a><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>Î»</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#Frequency_Moment_k.fk_space_usage|const"><span>fk_space_usage</span></a><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>k_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>n_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>m_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>Îµ_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>Î´_of</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>case_prod_beta'</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38305..38311"><span>k_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38395..38401"><span>n_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38575..38581"><span>Îµ_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38665..38671"><span>Î´_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38485..38491"><span>m_of_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>â</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="skolem"><span>g</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_41945..41947"><span>10</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_42242..42244"><span>11</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_42490..42492"><span>13</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_42900..42902"><span>14</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_43013..43015"><span>15</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_43496..43498"><span>16</span></a><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>fun_cong</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38988..38994"><span>s1_of_def</span></a><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>fun_cong</span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_39126..39132"><span>s2_of_def</span></a><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><span>Let_def</span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.sum_in_bigo|fact"><span>sum_in_bigo</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>auto</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>also</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>...</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>O[</span></a></span><span class="var"><span>?F</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>](</span></a></span><span class="var"><span>?rhs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL-Library/Landau_Symbols.html#Landau_Symbols.bigo|const"><span>)</span></a></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span>case_prod_beta'</span><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38756..38762"><span>g1_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38875..38881"><span>g_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38395..38401"><span>n_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38575..38581"><span>Îµ_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38665..38671"><span>Î´_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38485..38491"><span>m_of_def</span></a><span> </span><a class="entity_ref" href="Frequency_Moment_k.html#offset_38305..38311"><span>k_of_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>finally</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre></div>
<div id="Chord_Segments">
<div class="head">
<h1>Theory Chord_Segments</h1>
</div>
<pre class="source"><span class="comment1">(*  Author: Lukas Bulwahn &lt;lukas.bulwahn-at-gmail.com&gt; *)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Intersecting Chord Theorem›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Chord_Segments
<span class="keyword2"><span class="keyword">imports</span></span> <a href="../../triangle/theories/#Triangle">Triangle.Triangle</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Preliminaries›</span></span>

<span class="keyword1" id="Chord_Segments-betweenE_if_dist_leq"><span class="command">lemma</span></span> betweenE_if_dist_leq<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="free">B</span> <span class="free">X</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>euclidean_space"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"between <span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">B</span><span class="main">)</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">A</span> <span class="free">X</span> <span class="main">≤</span> dist <span class="free">B</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">obtains</span></span> <span class="free">u</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span> <span class="main">≤</span> <span class="free">u</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">u</span> <span class="main">≤</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">=</span> <span class="free">u</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">A</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="free">u</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">B</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="free">B</span>"</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">B</span><span class="main">)</span> <span class="free">X</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> u<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">≤</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> X<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">=</span> <span class="skolem">u</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">A</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">u</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">B</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add.commute betweenE between_commute<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> X <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">=</span> <span class="free">B</span> <span class="main">+</span> <span class="skolem">u</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">=</span> <span class="free">A</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">u</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> scaleR_diff_left real_vector.scale_right_diff_distrib<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">X</span> <span class="main">=</span> <span class="free">B</span> <span class="main">+</span> <span class="skolem">u</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> dist_B<span class="main">:</span> <span class="quoted"><span class="quoted">"dist <span class="free">B</span> <span class="free">X</span> <span class="main">=</span> norm <span class="main">(</span><span class="skolem">u</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_norm<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">X</span> <span class="main">=</span> <span class="free">A</span> <span class="main">+</span> <span class="main">(</span><span class="skolem">u</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> dist_A<span class="main">:</span> <span class="quoted"><span class="quoted">"dist <span class="free">A</span> <span class="free">X</span> <span class="main">=</span> norm <span class="main">(</span><span class="main">(</span><span class="skolem">u</span> <span class="main">-</span> <span class="main">1</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_norm<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">≠</span> <span class="free">B</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"norm <span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="free">B</span><span class="main">)</span> <span class="main">&gt;</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="quoted"><span class="quoted">‹dist <span class="free">A</span> <span class="free">X</span> <span class="main">≤</span> dist <span class="free">B</span> <span class="free">X</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">≥</span> <span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> dist_A dist_B <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> this <span class="quoted"><span class="quoted">‹<span class="skolem">u</span> <span class="main">≤</span> <span class="main">1</span>›</span></span> X that <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="free">thesis</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="free">B</span>"</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="main">::</span> <span class="quoted">real</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">=</span> <span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">B</span><span class="main">)</span> <span class="free">X</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">=</span> <span class="free">B</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span> <span class="main">≤</span> <span class="skolem">u</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">≤</span> <span class="main">1</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">=</span> <span class="skolem">u</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">A</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">u</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">B</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> u_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> that <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="free">thesis</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="Chord_Segments-dist_geq_iff_midpoint_in_between"><span class="command">lemma</span></span> dist_geq_iff_midpoint_in_between<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">A</span> <span class="free">B</span> <span class="free">X</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">::</span>euclidean_space"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"between <span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">B</span><span class="main">)</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">A</span> <span class="free">X</span> <span class="main">≤</span> dist <span class="free">B</span> <span class="free">X</span> <span class="main">⟷</span> between <span class="main">(</span><span class="free">X</span><span class="main">,</span> <span class="free">B</span><span class="main">)</span> <span class="main">(</span>midpoint <span class="free">A</span> <span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">A</span> <span class="free">X</span> <span class="main">≤</span> dist <span class="free">B</span> <span class="free">X</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">B</span><span class="main">)</span> <span class="free">X</span>›</span></span> this <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span>
    <span class="keyword2"><span class="keyword">where</span></span> u<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span> <span class="main">≤</span> <span class="skolem">u</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span> <span class="main">≤</span> <span class="main">1</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> X<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">=</span> <span class="skolem">u</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">A</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="skolem">u</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">B</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> betweenE_if_dist_leq <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> M<span class="main">:</span> <span class="quoted"><span class="quoted">"midpoint <span class="free">A</span> <span class="free">B</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">A</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">B</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> midpoint_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> scaleR_add_right<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span> <span class="main">≤</span> <span class="skolem">u</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">"midpoint <span class="free">A</span> <span class="free">B</span> <span class="main">=</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">u</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">X</span> <span class="main">+</span> <span class="main">(</span><span class="main">1</span> <span class="main">-</span> <span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">u</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="free">B</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span> <span class="main">-</span> <span class="skolem">u</span> <span class="main">*</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">u</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span> <span class="main">/</span> <span class="skolem">u</span> <span class="main">-</span> <span class="skolem">u</span> <span class="main">/</span> <span class="skolem">u</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> u<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> diff_divide_distrib<span class="main">)</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">1</span> <span class="main">/</span> <span class="skolem">u</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> u<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="numeral">2</span> <span class="main">-</span> <span class="skolem">u</span> <span class="main">*</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">u</span><span class="main">)</span> <span class="main">=</span> <span class="main">1</span> <span class="main">/</span> <span class="skolem">u</span> <span class="main">-</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">1</span> <span class="main">/</span> <span class="numeral">2</span> <span class="main">≤</span> <span class="skolem">u</span>›</span></span> this <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> X M <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> scaleR_add_right scaleR_add_left<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> u <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">u</span><span class="main">)</span><span class="main">)</span> <span class="main">≥</span> <span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">1</span> <span class="main">/</span> <span class="main">(</span><span class="numeral">2</span> <span class="main">*</span> <span class="skolem">u</span><span class="main">)</span><span class="main">)</span> <span class="main">≤</span> <span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"between <span class="main">(</span><span class="free">X</span><span class="main">,</span> <span class="free">B</span><span class="main">)</span> <span class="main">(</span>midpoint <span class="free">A</span> <span class="free">B</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> betweenI <span class="main">[</span><span class="operator">of</span> <span class="quasi_keyword">concl</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">B</span></span> <span class="quoted"><span class="free">X</span></span><span class="main">]</span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add.commute between_commute<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"between <span class="main">(</span><span class="free">X</span><span class="main">,</span> <span class="free">B</span><span class="main">)</span> <span class="main">(</span>midpoint <span class="free">A</span> <span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"between <span class="main">(</span><span class="free">A</span><span class="main">,</span> midpoint <span class="free">A</span> <span class="free">B</span><span class="main">)</span> <span class="free">X</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">A</span><span class="main">,</span> <span class="free">B</span><span class="main">)</span> <span class="free">X</span>›</span></span> between_midpoint<span class="main">(</span>1<span class="main">)</span> between_swap <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">A</span> <span class="free">X</span> <span class="main">≤</span> dist <span class="free">A</span> <span class="main">(</span>midpoint <span class="free">A</span> <span class="free">B</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> between zero_le_dist <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">A</span> <span class="main">(</span>midpoint <span class="free">A</span> <span class="free">B</span><span class="main">)</span> <span class="main">≤</span> dist <span class="free">B</span> <span class="main">(</span>midpoint <span class="free">A</span> <span class="free">B</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_midpoint<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">X</span><span class="main">,</span> <span class="free">B</span><span class="main">)</span> <span class="main">(</span>midpoint <span class="free">A</span> <span class="free">B</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">B</span> <span class="main">(</span>midpoint <span class="free">A</span> <span class="free">B</span><span class="main">)</span> <span class="main">≤</span> dist <span class="free">B</span> <span class="free">X</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> between zero_le_dist <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> add.commute dist_commute le_add_same_cancel1<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">A</span> <span class="free">X</span> <span class="main">≤</span> dist <span class="free">B</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Properties of Chord Segments›</span></span>

<span class="keyword1" id="Chord_Segments-chord_property"><span class="command">lemma</span></span> chord_property<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">S</span> <span class="free">C</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">::</span> euclidean_space"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">C</span> <span class="free">S</span> <span class="main">=</span> dist <span class="free">C</span> <span class="free">T</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"between <span class="main">(</span><span class="free">S</span><span class="main">,</span> <span class="free">T</span><span class="main">)</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">S</span> <span class="free">X</span> <span class="main">*</span> dist <span class="free">X</span> <span class="free">T</span> <span class="main">=</span> <span class="main">(</span>dist <span class="free">C</span> <span class="free">S</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">-</span> <span class="main">(</span>dist <span class="free">C</span> <span class="free">X</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">M</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span> <span class="main">=</span> midpoint <span class="free">S</span> <span class="free">T</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"between <span class="main">(</span><span class="free">S</span><span class="main">,</span> <span class="free">T</span><span class="main">)</span> <span class="skolem">M</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> M_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> between_midpoint<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">T</span> <span class="skolem">M</span> <span class="main">=</span> dist <span class="free">S</span> <span class="skolem">M</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> M_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_midpoint<span class="main">)</span>

  <span class="keyword1"><span class="command">have</span></span> distances<span class="main">:</span> <span class="quoted"><span class="quoted">"max <span class="main">(</span>dist <span class="free">S</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span>dist <span class="free">X</span> <span class="free">T</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>dist <span class="free">S</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>dist <span class="free">X</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">∧</span>
    min <span class="main">(</span>dist <span class="free">S</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span>dist <span class="free">X</span> <span class="free">T</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>dist <span class="free">S</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span>dist <span class="free">X</span> <span class="skolem">M</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">cases</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">S</span> <span class="free">X</span> <span class="main">≤</span> dist <span class="free">X</span> <span class="free">T</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"between <span class="main">(</span><span class="free">X</span><span class="main">,</span> <span class="free">T</span><span class="main">)</span> <span class="skolem">M</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">S</span><span class="main">,</span> <span class="free">T</span><span class="main">)</span> <span class="free">X</span>›</span></span> M_def
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_geq_iff_midpoint_in_between dist_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"between <span class="main">(</span><span class="free">S</span><span class="main">,</span> <span class="skolem">M</span><span class="main">)</span> <span class="free">X</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">S</span><span class="main">,</span> <span class="free">T</span><span class="main">)</span> <span class="free">X</span>›</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">S</span><span class="main">,</span> <span class="free">T</span><span class="main">)</span> <span class="skolem">M</span>›</span></span> between_swap <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">X</span><span class="main">,</span> <span class="free">T</span><span class="main">)</span> <span class="skolem">M</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">X</span> <span class="free">T</span> <span class="main">=</span> dist <span class="free">X</span> <span class="skolem">M</span> <span class="main">+</span> dist <span class="skolem">M</span> <span class="free">T</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> between <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">S</span><span class="main">,</span> <span class="skolem">M</span><span class="main">)</span> <span class="free">X</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">S</span> <span class="free">X</span> <span class="main">=</span> dist <span class="free">S</span> <span class="skolem">M</span> <span class="main">-</span> dist <span class="skolem">M</span> <span class="free">X</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> between dist_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹dist <span class="free">S</span> <span class="free">X</span> <span class="main">≤</span> dist <span class="free">X</span> <span class="free">T</span>›</span></span> <span class="quoted"><span class="quoted">‹dist <span class="free">T</span> <span class="skolem">M</span> <span class="main">=</span> dist <span class="free">S</span> <span class="skolem">M</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> add.commute dist_commute max_def min_def<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="main">(</span>dist <span class="free">S</span> <span class="free">X</span> <span class="main">≤</span> dist <span class="free">X</span> <span class="free">T</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">T</span> <span class="free">X</span> <span class="main">≤</span> dist <span class="free">S</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"between <span class="main">(</span><span class="free">S</span><span class="main">,</span> <span class="free">X</span><span class="main">)</span> <span class="skolem">M</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">S</span><span class="main">,</span> <span class="free">T</span><span class="main">)</span> <span class="free">X</span>›</span></span> M_def
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> dist_geq_iff_midpoint_in_between midpoint_sym between_commute<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"between <span class="main">(</span><span class="free">T</span><span class="main">,</span> <span class="skolem">M</span><span class="main">)</span> <span class="free">X</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">S</span><span class="main">,</span> <span class="free">T</span><span class="main">)</span> <span class="free">X</span>›</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">S</span><span class="main">,</span> <span class="free">T</span><span class="main">)</span> <span class="skolem">M</span>›</span></span> between_swap between_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">S</span><span class="main">,</span> <span class="free">X</span><span class="main">)</span> <span class="skolem">M</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">S</span> <span class="free">X</span> <span class="main">=</span> dist <span class="free">S</span> <span class="skolem">M</span> <span class="main">+</span> dist <span class="skolem">M</span> <span class="free">X</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> between <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">T</span><span class="main">,</span> <span class="skolem">M</span><span class="main">)</span> <span class="free">X</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">T</span> <span class="free">X</span> <span class="main">=</span> dist <span class="free">T</span> <span class="skolem">M</span> <span class="main">-</span> dist <span class="skolem">M</span> <span class="free">X</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> between dist_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> dist <span class="free">S</span> <span class="free">X</span> <span class="main">≤</span> dist <span class="free">X</span> <span class="free">T</span>›</span></span> <span class="quoted"><span class="quoted">‹dist <span class="free">T</span> <span class="skolem">M</span> <span class="main">=</span> dist <span class="free">S</span> <span class="skolem">M</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> dist_commute max_def min_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>

  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"orthogonal <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">(</span><span class="free">S</span> <span class="main">-</span> <span class="skolem">M</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹dist <span class="free">C</span> <span class="free">S</span> <span class="main">=</span> dist <span class="free">C</span> <span class="free">T</span>›</span></span> M_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> isosceles_triangle_orthogonal_on_midpoint<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"orthogonal <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">(</span><span class="free">X</span> <span class="main">-</span> <span class="skolem">M</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"between <span class="main">(</span><span class="free">S</span><span class="main">,</span> <span class="free">T</span><span class="main">)</span> <span class="skolem">M</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> M_def between_midpoint<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">X</span> <span class="main">-</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">S</span> <span class="main">-</span> <span class="skolem">M</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">=</span> <span class="skolem">M</span>"</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">≠</span> <span class="skolem">M</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">X</span> <span class="main">-</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">c</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">S</span> <span class="main">-</span> <span class="skolem">M</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> between_implies_scaled_diff <span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">S</span><span class="main">,</span> <span class="free">T</span><span class="main">)</span> <span class="free">X</span>›</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">S</span><span class="main">,</span> <span class="free">T</span><span class="main">)</span> <span class="skolem">M</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
      <span class="keyword1"><span class="command">from</span></span> this that <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="skolem">thesis</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">=</span> <span class="skolem">M</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> this <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">S</span><span class="main">,</span> <span class="free">T</span><span class="main">)</span> <span class="free">X</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">=</span> <span class="skolem">M</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> midpoint_between M_def<span class="main">)</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">X</span> <span class="main">=</span> <span class="skolem">M</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">S</span> <span class="main">=</span> <span class="skolem">M</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">X</span> <span class="main">-</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="keyword1">*<span class="hidden">⇩</span><sub>R</sub></span> <span class="main">(</span><span class="free">S</span> <span class="main">-</span> <span class="skolem">M</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> this that <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="skolem">thesis</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">from</span></span> this <span class="quoted"><span class="quoted">‹orthogonal <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">(</span><span class="free">S</span> <span class="main">-</span> <span class="skolem">M</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">:</span></span> orthogonal_clauses<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹orthogonal <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">(</span><span class="free">S</span> <span class="main">-</span> <span class="skolem">M</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹orthogonal <span class="main">(</span><span class="free">C</span> <span class="main">-</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">(</span><span class="free">X</span> <span class="main">-</span> <span class="skolem">M</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span>dist <span class="free">S</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>dist <span class="skolem">M</span> <span class="free">C</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">(</span>dist <span class="free">C</span> <span class="free">S</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span>dist <span class="free">X</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">+</span> <span class="main">(</span>dist <span class="skolem">M</span> <span class="free">C</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">(</span>dist <span class="free">C</span> <span class="free">X</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> Pythagoras<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> geometric_observation<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span>dist <span class="free">S</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">(</span>dist <span class="free">C</span> <span class="free">S</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">-</span> <span class="main">(</span>dist <span class="skolem">M</span> <span class="free">C</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span>dist <span class="free">X</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">=</span> <span class="main">(</span>dist <span class="free">C</span> <span class="free">X</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">-</span> <span class="main">(</span>dist <span class="skolem">M</span> <span class="free">C</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">S</span> <span class="free">X</span> <span class="main">*</span> dist <span class="free">X</span> <span class="free">T</span> <span class="main">=</span> max <span class="main">(</span>dist <span class="free">S</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span>dist <span class="free">X</span> <span class="free">T</span><span class="main">)</span> <span class="main">*</span> min <span class="main">(</span>dist <span class="free">S</span> <span class="free">X</span><span class="main">)</span> <span class="main">(</span>dist <span class="free">X</span> <span class="free">T</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">split</span><span class="main"><span class="main">:</span></span> split_max<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>dist <span class="free">S</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">+</span> <span class="main">(</span>dist <span class="free">X</span> <span class="skolem">M</span><span class="main">)</span><span class="main">)</span> <span class="main">*</span> <span class="main">(</span><span class="main">(</span>dist <span class="free">S</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span>dist <span class="free">X</span> <span class="skolem">M</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> distances <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span>dist <span class="free">S</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">-</span> <span class="main">(</span>dist <span class="free">X</span> <span class="skolem">M</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="dynamic"><span class="dynamic">field_simps</span></span> power2_eq_square<span class="main">)</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span>dist <span class="free">C</span> <span class="free">S</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">-</span> <span class="main">(</span>dist <span class="skolem">M</span> <span class="free">C</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span><span class="main">)</span> <span class="main">-</span> <span class="main">(</span><span class="main">(</span>dist <span class="free">C</span> <span class="free">X</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">-</span> <span class="main">(</span>dist <span class="skolem">M</span> <span class="free">C</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> geometric_observation <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="main">(</span>dist <span class="free">C</span> <span class="free">S</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">-</span> <span class="main">(</span>dist <span class="free">C</span> <span class="free">X</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span> product_of_chord_segments<span class="main">:</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">S<span class="hidden">⇩</span><sub>1</sub></span> <span class="free">T<span class="hidden">⇩</span><sub>1</sub></span> <span class="free">S<span class="hidden">⇩</span><sub>2</sub></span> <span class="free">T<span class="hidden">⇩</span><sub>2</sub></span> <span class="free">X</span> <span class="free">C</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'a</span> <span class="main">::</span> euclidean_space"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"between <span class="main">(</span><span class="free">S<span class="hidden">⇩</span><sub>1</sub></span><span class="main">,</span> <span class="free">T<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="free">X</span>"</span></span> <span class="quoted"><span class="quoted">"between <span class="main">(</span><span class="free">S<span class="hidden">⇩</span><sub>2</sub></span><span class="main">,</span> <span class="free">T<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">C</span> <span class="free">S<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">=</span> <span class="free">r</span>"</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">C</span> <span class="free">T<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">=</span> <span class="free">r</span>"</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">C</span> <span class="free">S<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">=</span> <span class="free">r</span>"</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">C</span> <span class="free">T<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">=</span> <span class="free">r</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">S<span class="hidden">⇩</span><sub>1</sub></span> <span class="free">X</span> <span class="main">*</span> dist <span class="free">X</span> <span class="free">T<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">=</span> dist <span class="free">S<span class="hidden">⇩</span><sub>2</sub></span> <span class="free">X</span> <span class="main">*</span> dist <span class="free">X</span> <span class="free">T<span class="hidden">⇩</span><sub>2</sub></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹dist <span class="free">C</span> <span class="free">S<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">=</span> <span class="free">r</span>›</span></span> <span class="quoted"><span class="quoted">‹dist <span class="free">C</span> <span class="free">T<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">=</span> <span class="free">r</span>›</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">S<span class="hidden">⇩</span><sub>1</sub></span><span class="main">,</span> <span class="free">T<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="free">X</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"dist <span class="free">S<span class="hidden">⇩</span><sub>1</sub></span> <span class="free">X</span> <span class="main">*</span> dist <span class="free">X</span> <span class="free">T<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">=</span> <span class="free">r</span> <span class="main">^</span> <span class="numeral">2</span> <span class="main">-</span> <span class="main">(</span>dist <span class="free">C</span> <span class="free">X</span><span class="main">)</span> <span class="main">^</span> <span class="numeral">2</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> chord_property<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹dist <span class="free">C</span> <span class="free">S<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">=</span> <span class="free">r</span>›</span></span> <span class="quoted"><span class="quoted">‹dist <span class="free">C</span> <span class="free">T<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">=</span> <span class="free">r</span>›</span></span> <span class="quoted"><span class="quoted">‹between <span class="main">(</span><span class="free">S<span class="hidden">⇩</span><sub>2</sub></span><span class="main">,</span> <span class="free">T<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span> <span class="free">X</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> dist <span class="free">S<span class="hidden">⇩</span><sub>2</sub></span> <span class="free">X</span> <span class="main">*</span> dist <span class="free">X</span> <span class="free">T<span class="hidden">⇩</span><sub>2</sub></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">subst</span> chord_property<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div>
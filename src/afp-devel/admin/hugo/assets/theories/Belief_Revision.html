<div id="AGM_Logic">
<div class="head">
<h1>Theory AGM_Logic</h1>
</div>
<pre class="source"><span class="comment1">(*&lt;*)</span>
<span class="comment1">―‹ ******************************************************************** 
 * Project         : AGM Theory
 * Version         : 1.0
 *
 * Authors         : Valentin Fouillard, Safouan Taha, Frederic Boulanger
                     and Nicolas Sabouret
 *
 * This file       : AGM logics
 *
 * Copyright (c) 2021 Université Paris Saclay, France
 *
 ******************************************************************************›</span>

<span class="keyword1"><span class="command">theory</span></span> AGM_Logic

<span class="keyword2"><span class="keyword">imports</span></span> <a href="https://www.cl.cam.ac.uk/research/hvg/Isabelle/dist/library/HOL/HOL/Main.html">Main</a>

<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Introduction›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹
The 1985 paper by Carlos Alchourrón, Peter Gärdenfors,
and David Makinson (AGM), “On the Logic of Theory Change: Partial Meet
Contraction and Revision Functions” <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">cite</span></span> "alchourron1985logic"<span class="antiquote"><span class="antiquote">}</span></span></span></span> launches a large and
rapidly growing literature that employs formal models and logics to handle changing beliefs of a rational agent
and to take into account new piece of information observed by this agent. 
In 2011, a review book titled "AGM 25 Years: Twenty-Five Years of Research in Belief Change"
was edited to summarize the first twenty five years of works based on AGM 
<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">cite</span></span> "Ferme2011"<span class="antiquote"><span class="antiquote">}</span></span></span></span>.

According to Google Scholar, the original AGM paper was cited 4000 times! 
This AFP entry is HOL-based and it is a faithful formalization of the logic operators (e.g. contraction, revision, remainder \dots )
axiomatized in the AGM paper. It also contains the proofs of all the theorems stated in the paper that show how these operators combine.
Both proofs of Harper and Levi identities are established.
›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A belief state can be considered as a consistent set of beliefs (logical propositions) closed under logical reasoning.
Belief changes represent the operations that apply on a belief state to remove some of it and/or to add new beliefs (propositions). 
In the latter case, it is possible that other beliefs are affected by these changes (to preserve consistency for example). 
AGM define several postulates to guarantee that such operations preserve consistency meaning that the agent keeps rational. 
Three kinds of operators are defined :
<span class="antiquoted"><span class="antiquoted">▪</span></span> The contraction <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹÷›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : where a proposition is removed from a belief set
<span class="antiquoted"><span class="antiquoted">▪</span></span> The expansion <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹⊕›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : where a proposition is added to a belief set
<span class="antiquoted"><span class="antiquoted">▪</span></span> The revision <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹<span class="hidden">❙</span><b>*</b>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : where a proposition is added to a belief set such that the belief set remains consistent
›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In this AFP entry, there are three theory files: 
<span class="antiquoted"><span class="antiquoted">▸</span></span> The AGM Logic file contains a classification of logics used in the AGM framework.
<span class="antiquoted"><span class="antiquoted">▸</span></span> The AGM Remainder defines a important operator used in the AGM framework.
<span class="antiquoted"><span class="antiquoted">▸</span></span> The AGM Contraction file contains the postulates of the AGM contraction and its relation with the meet contraction.
<span class="antiquoted"><span class="antiquoted">▸</span></span> The AGM Revision file contains the postulates of the AGM revision and its relation with the meet revision.  
›</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Logics›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The AGM framework depends on the underlying logic used to express beliefs. AGM requires at least a Tarskian propositional calculus. 
If this logic is also supra-classical and/or compact, new properties are established and the main theorems of AGM are strengthened. 
To model AGM it is therefore important to start by formalizing this underlying logic and its various extensions. 
We opted for a deep embedding in HOL which required the redefinition of all the logical operators and an axiomatization of their rules. 
This is certainly not efficient in terms of proof but it gives a total control of our formalization and an assurance 
that the logic used has no hidden properties depending on the Isabelle/HOL implementation. 
We use the Isabelle <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator">∗</span></span>‹locales›</span></span> feature and we take advantage of the inheritance/extension mechanisms between locales.›</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Tarskian Logic›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
The first locale formalizes a Tarskian logic based on the famous Tarski's consequence operator: <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">Cn</span></span><span class="main"><span class="main">(</span></span><span class="free"><span class="free">A</span></span><span class="main"><span class="main">)</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> 
which gives the set of all propositions (<span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator">❙</span></span>‹closure›</span></span>) that can be inferred from the set of propositions <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">A</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>, 
Exactly as it is classically axiomatized in the literature, three assumptions of the locale define the consequence operator.
›</span></span>
<span class="keyword1"><span class="command">locale</span></span> Tarskian_logic <span class="main">=</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">Cn</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span> set›</span></span>
<span class="keyword2"><span class="keyword">assumes</span></span> monotonicity_L<span class="main">:</span>     <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">⊆</span> <span class="free">B</span> <span class="main">⟹</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> inclusion_L<span class="main">:</span>        <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> transitivity_L<span class="main">:</span>     <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span>

<span class="comment1">― ‹
  Short notation for ``<span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">‹<span class="free">φ</span>›</span><span class="antiquote">}</span></span> can be inferred from the propositions in <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">‹<span class="free">A</span>›</span><span class="antiquote">}</span></span>''.
›</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">infer</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> bool›</span></span>  <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">‹<span class="keyword1"><span class="keyword1"><span class="keyword1">⊢</span></span></span>›</span> 50<span class="main">)</span>
<span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span> <span class="main">≡</span> <span class="free">φ</span> <span class="main">∈</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span>

<span class="comment1">― ‹
  <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">‹<span class="free">φ</span>›</span><span class="antiquote">}</span></span> is valid (a tautology) if it can be inferred from nothing.
›</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">valid</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> <span class="main">⇒</span> bool›</span></span>            <span class="main">(</span><span class="quoted">‹<span class="keyword1"><span class="keyword1"><span class="keyword1">⊩</span></span></span>›</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="free">φ</span> <span class="main">≡</span> <span class="main">{}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span>›</span></span>

<span class="comment1">― ‹
  <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊕</span></span> <span class="free">φ</span>›</span><span class="antiquote">}</span></span> is all that can be infered from  <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">‹<span class="free">A</span>›</span><span class="antiquote">}</span></span> and  <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">‹<span class="free">φ</span>›</span><span class="antiquote">}</span></span>.
›</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">expansion</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> set›</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">‹<span class="keyword1"><span class="keyword1"><span class="keyword1">⊕</span></span></span>›</span> 57<span class="main">)</span>
<span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊕</span></span> <span class="free">φ</span> <span class="main">≡</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">φ</span><span class="main">}</span><span class="main">)</span>›</span></span>

<span class="keyword2"><span class="keyword">begin</span></span> 

<span class="keyword1" id="AGM_Logic-idempotency_L"><span class="command">lemma</span></span> idempotency_L<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inclusion_L transitivity_L subset_antisym<span class="main">)</span>

<span class="keyword1" id="AGM_Logic-assumption_L"><span class="command">lemma</span></span> assumption_L<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">φ</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> inclusion_L infer_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 

<span class="keyword1" id="AGM_Logic-validD_L"><span class="command">lemma</span></span> validD_L<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="free">φ</span> <span class="main">⟹</span> <span class="free">φ</span> <span class="main">∈</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> monotonicity_L valid_def infer_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1" id="AGM_Logic-valid_expansion"><span class="command">lemma</span></span> valid_expansion<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="main"><span class="free">⊩</span></span> <span class="free">φ</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free">⊕</span></span> <span class="free">φ</span> <span class="main">=</span> <span class="free">K</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> idempotency_L insert_absorb validD_L valid_def expansion_def<span class="main">)</span>

<span class="keyword1" id="AGM_Logic-transitivity2_L"><span class="command">lemma</span></span> transitivity2_L<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">φ</span> <span class="main">∈</span> <span class="free">B</span><span class="main">.</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="bound">φ</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span>›</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">B</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> infer_def subsetI<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span>  <span class="keyword1"><span class="command">using</span></span> idempotency_L monotonicity_L <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">ψ</span> <span class="main">∈</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> infer_def<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> infer_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="AGM_Logic-Cn_same"><span class="command">lemma</span></span> Cn_same<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∀</span><span class="bound">C</span><span class="main">.</span> <span class="free">A</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="bound">C</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">B</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="bound">C</span><span class="main">)</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">from</span></span> h <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">φ</span> <span class="main">∈</span> <span class="free">B</span><span class="main">.</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="bound">φ</span>›</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Tarskian_logic.assumption_L Tarskian_logic_axioms infer_def<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> h<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">φ</span> <span class="main">∈</span> <span class="free">A</span><span class="main">.</span> <span class="free">B</span> <span class="main"><span class="free">⊢</span></span> <span class="bound">φ</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Tarskian_logic.assumption_L Tarskian_logic_axioms infer_def<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">C</span><span class="main">.</span> <span class="free">A</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="bound">C</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">B</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="bound">C</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> h idempotency_L inclusion_L monotonicity_L <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">∀</span><span class="bound">C</span><span class="main">.</span> <span class="main">(</span><span class="free">A</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="bound">C</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">B</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="bound">C</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">C</span><span class="main">.</span> <span class="main">(</span><span class="free">A</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="bound">C</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">B</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="bound">C</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">from</span></span> h <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">A</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">B</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">A</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">B</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">B</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inclusion_L<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> idempotency_L monotonicity_L <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">∀</span><span class="bound">C</span><span class="main">.</span> <span class="main">(</span><span class="free">A</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="bound">C</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">B</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="bound">C</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">― ‹
The closure of the union of two consequence closures.
›</span>
<span class="keyword1" id="AGM_Logic-Cn_union"><span class="command">lemma</span></span> Cn_union<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">∪</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span> <span class="main">∪</span> <span class="free">B</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">∪</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">Cn</span> <span class="main">(</span><span class="free">A</span> <span class="main">∪</span> <span class="free">B</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> monotonicity_L<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">∪</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span> <span class="main">∪</span> <span class="free">B</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> idempotency_L<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">A</span> <span class="main">∪</span> <span class="free">B</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span><span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">∪</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> inclusion_L <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="free">A</span> <span class="main">∪</span> <span class="free">B</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">∪</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> monotonicity_L<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">― ‹
The closure of an infinite union of consequence closures.
›</span>
<span class="keyword1" id="AGM_Logic-Cn_Union"><span class="command">lemma</span></span> Cn_Union<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">⋃</span><span class="main">{</span><span class="free">Cn</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span><span class="main">|</span><span class="bound">B</span><span class="main">.</span> <span class="free">P</span> <span class="bound">B</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">⋃</span><span class="main">{</span><span class="bound">B</span><span class="main">.</span> <span class="free">P</span> <span class="bound">B</span><span class="main">}</span><span class="main">)</span>›</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?A</span> <span class="main">=</span> <span class="var">?B</span>›</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?A</span> <span class="main">⊆</span> <span class="free">Cn</span> <span class="var">?B</span>›</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> monotonicity_L<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> Union_least<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Sup_upper in_mono mem_Collect_eq monotonicity_L<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?A</span> <span class="main">⊆</span> <span class="var">?B</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> idempotency_L<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?B</span> <span class="main">⊆</span> <span class="var">?A</span>›</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> Union_subsetI inclusion_L mem_Collect_eq monotonicity_L<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">― ‹
The intersection of two closures is closed.
›</span>
<span class="keyword1" id="AGM_Logic-Cn_inter"><span class="command">lemma</span></span> Cn_inter<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">∩</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">K</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">K</span> <span class="keyword3"><span class="command">assume</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">∩</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">from</span></span> h <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">K</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">K</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="skolem">K</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="skolem">K</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> idempotency_L monotonicity_L <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="main"><span class="keyword3">+</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="skolem">K</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">∩</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> h <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="skolem">K</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inclusion_L subset_antisym<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">∩</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">K</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">― ‹
An infinite intersection of closures is closed.
›</span>
<span class="keyword1" id="AGM_Logic-Cn_Inter"><span class="command">lemma</span></span> Cn_Inter<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="main">⋂</span><span class="main">{</span><span class="free">Cn</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span><span class="main">|</span><span class="bound">B</span><span class="main">.</span> <span class="free">P</span> <span class="bound">B</span><span class="main">}</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">K</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">K</span> <span class="keyword3"><span class="command">assume</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">K</span> <span class="main">=</span> <span class="main">⋂</span><span class="main">{</span><span class="free">Cn</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span><span class="main">|</span><span class="bound">B</span><span class="main">.</span> <span class="free">P</span> <span class="bound">B</span><span class="main">}</span>›</span></span>
    <span class="keyword1"><span class="command">from</span></span> h <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">B</span><span class="main">.</span> <span class="free">P</span> <span class="bound">B</span> <span class="main">⟶</span> <span class="skolem">K</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">B</span><span class="main">.</span> <span class="free">P</span> <span class="bound">B</span> <span class="main">⟶</span> <span class="free">Cn</span><span class="main">(</span><span class="skolem">K</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> idempotency_L monotonicity_L <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="skolem">K</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">⋂</span><span class="main">{</span><span class="free">Cn</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span><span class="main">|</span><span class="bound">B</span><span class="main">.</span> <span class="free">P</span> <span class="bound">B</span><span class="main">}</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> h <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="skolem">K</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> inclusion_L subset_antisym<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="main">⋂</span><span class="main">{</span><span class="free">Cn</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span><span class="main">|</span><span class="bound">B</span><span class="main">.</span> <span class="free">P</span> <span class="bound">B</span><span class="main">}</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">K</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Supraclassical Logic›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹
A Tarskian logic has only one abstract operator catching the notion of consequence. A basic case of such a logic is a <span class="antiquoted"><span class="antiquoted"><span class="operator"><span class="operator">❙</span></span>‹Supraclassical›</span></span> logic that 
is a logic with all classical propositional operators (e.g. conjunction (<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>∧›</span></span></span></span>), implication(<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>⟶›</span></span></span></span>), negation (<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>¬›</span></span></span></span>) \dots ) together with their classical semantics.

We define a new locale. In order to distinguish the propositional operators of our supraclassical logic from those of Isabelle/HOL, we use dots (e.g. <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>.∧.›</span></span></span></span> stands for conjunction). 
We axiomatize the introduction and elimination rules of each operator as it is commonly established in the classical literature. As explained before, 
we give priority to a complete control of our logic instead of an efficient shallow embedding in Isabelle/HOL.
›</span></span>

<span class="keyword1"><span class="command">locale</span></span> Supraclassical_logic <span class="main">=</span> Tarskian_logic <span class="main">+</span>

<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">true_PL</span><span class="main">::</span>   <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span>›</span></span>             <span class="main">(</span><span class="quoted">‹<span class="keyword1">⊤</span>›</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">false_PL</span><span class="main">::</span>  <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span>›</span></span>             <span class="main">(</span><span class="quoted">‹<span class="keyword1">⊥</span>›</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">imp_PL</span><span class="main">::</span>    <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span>›</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">‹<span class="keyword1">.⟶.</span>›</span> 55<span class="main">)</span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">not_PL</span><span class="main">::</span>    <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span>›</span></span>       <span class="main">(</span><span class="quoted">‹<span class="keyword1">.¬</span>›</span><span class="main">)</span>  
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">conj_PL</span><span class="main">::</span>   <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span>›</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">‹<span class="keyword1">.∧.</span>›</span> 55<span class="main">)</span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">disj_PL</span><span class="main">::</span>   <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span>›</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">‹<span class="keyword1">.∨.</span>›</span> 55<span class="main">)</span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="free">equiv_PL</span><span class="main">::</span>  <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span>›</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">‹<span class="keyword1">.⟷.</span>›</span> 55<span class="main">)</span>

<span class="keyword2"><span class="keyword">assumes</span></span> true_PL<span class="main">:</span>     <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main"><span class="free">⊤</span></span>›</span></span>

    <span class="keyword2"><span class="keyword">and</span></span> false_PL<span class="main">:</span>    <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main"><span class="free">⊥</span></span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span>›</span></span>

    <span class="keyword2"><span class="keyword">and</span></span> impI_PL<span class="main">:</span>     <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">p</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">q</span><span class="main">)</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> mp_PL<span class="main">:</span>       <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span>›</span></span>

    <span class="keyword2"><span class="keyword">and</span></span> notI_PL<span class="main">:</span>     <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="main"><span class="free">⊥</span></span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main"><span class="free">.¬</span></span> <span class="free">p</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> notE_PL<span class="main">:</span>     <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main"><span class="free">.¬</span></span> <span class="free">p</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="main"><span class="free">⊥</span></span><span class="main">)</span>›</span></span>

    <span class="keyword2"><span class="keyword">and</span></span> conjI_PL<span class="main">:</span>    <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">q</span><span class="main">)</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> conjE1_PL<span class="main">:</span>   <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> conjE2_PL<span class="main">:</span>   <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span>›</span></span>

    <span class="keyword2"><span class="keyword">and</span></span> disjI1_PL<span class="main">:</span>   <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">q</span><span class="main">)</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> disjI2_PL<span class="main">:</span>   <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">q</span><span class="main">)</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> disjE_PL<span class="main">:</span>    <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">r</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span><span class="main"><span class="free">.⟶.</span></span> <span class="free">r</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">r</span>›</span></span>

    <span class="keyword2"><span class="keyword">and</span></span> equivI_PL<span class="main">:</span>   <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">p</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.⟷.</span></span> <span class="free">q</span><span class="main">)</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> equivE1_PL<span class="main">:</span>  <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟷.</span></span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">q</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> equivE2_PL<span class="main">:</span>  <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟷.</span></span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">p</span>›</span></span>

<span class="comment1">― ‹non intuitionistic rules›</span>
    <span class="keyword2"><span class="keyword">and</span></span> absurd_PL<span class="main">:</span>   <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> ex_mid_PL<span class="main">:</span>   <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.∨.</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span><span class="main">)</span>›</span></span>

<span class="keyword2"><span class="keyword">begin</span></span> 

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹In the following, we will first retrieve the classical logic operators semantics coming from previous introduction and elimination rules›</span></span>

<span class="keyword1" id="AGM_Logic-non_consistency"><span class="command">lemma</span></span> non_consistency<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main"><span class="free">.¬</span></span> <span class="free">p</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span>›</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> false_PL mp_PL notE_PL singleton_iff transitivity2_L<span class="main">)</span>

<span class="comment1">― ‹this direct result brings directly many remarkable properties of implication (i.e. transitivity)›</span>
<span class="keyword1" id="AGM_Logic-imp_PL"><span class="command">lemma</span></span> imp_PL<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">q</span> <span class="main">⟷</span> <span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">p</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span>›</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">intro</span> iffI impI_PL<span class="main">)</span>
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> mp_PL<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> p<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="free"><span class="quoted"><span class="free">p</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">meson</span> UnI1 assumption_L transitivity2_L<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> assumption_L <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="AGM_Logic-not_PL"><span class="command">lemma</span></span> not_PL<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main"><span class="free">.¬</span></span> <span class="free">p</span> <span class="main">⟷</span> <span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">p</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="main"><span class="free">⊥</span></span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> notE_PL notI_PL imp_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="comment1">― ‹Classical logic result›</span>
<span class="keyword1" id="AGM_Logic-notnot_PL"><span class="command">lemma</span></span> notnot_PL<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span>›</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> iffI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>absurd_PL<span class="main">)</span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> mp_PL notE_PL Un_upper1 Un_upper2 assumption_L infer_def monotonicity_L not_PL singletonI subsetD<span class="main">)</span>

<span class="keyword1" id="AGM_Logic-conj_PL"><span class="command">lemma</span></span> conj_PL<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">q</span> <span class="main">⟷</span> <span class="main">(</span><span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main">∧</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> conjE1_PL conjE2_PL conjI_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 

<span class="keyword1" id="AGM_Logic-disj_PL"><span class="command">lemma</span></span> disj_PL<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">q</span> <span class="main">⟷</span> <span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">q</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">q</span><span class="main">)</span>›</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">intro</span> impI_PL<span class="main">)</span> <span class="main">(</span><span class="operator">meson</span> Un_iff assumption_L insertI1 non_consistency<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span> <span class="main"><span class="free">.⟶.</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">q</span><span class="main">)</span>›</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assumption_L impI_PL<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> a b c <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main"><span class="free">.¬</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">q</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">erule_tac</span> disjE_PL<span class="main">)</span> <span class="operator">simp_all</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span>›</span></span> 
    <span class="keyword1"><span class="command">using</span></span> imp_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span> 
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span>›</span></span>
  <span class="keyword1"><span class="command">hence</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main"><span class="free">.¬</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">q</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> impI_PL<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">q</span>›</span></span> 
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule_tac</span> disjE_PL<span class="main"><span class="main">[</span></span><span class="operator">OF</span> ex_mid_PL<span class="main"><span class="main">,</span></span> <span class="operator">of</span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">A</span></span></span></span> <span class="quoted"><span class="free"><span class="quoted"><span class="free">p</span></span></span></span> <span class="quoted"><span class="quoted"><span class="quoted">‹<span class="free"><span class="free">p</span></span> <span class="main"><span class="free"><span class="main"><span class="free">.∨.</span></span></span></span> <span class="free"><span class="free">q</span></span>›</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> assumption_L disjI2_PL disjI1_PL impI_PL imp_PL<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="AGM_Logic-equiv_PL"><span class="command">lemma</span></span> equiv_PL<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟷.</span></span> <span class="free">q</span> <span class="main">⟷</span> <span class="main">(</span><span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">p</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span> <span class="main">∧</span> <span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">q</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> imp_PL equivE1_PL equivE2_PL equivI_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">corollary</span></span> valid_imp_PL<span class="main">:</span>  <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">{</span><span class="free">p</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span><span class="main">)</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> valid_not_PL<span class="main">:</span>  <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">{</span><span class="free">p</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="main"><span class="free">⊥</span></span><span class="main">)</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> valid_conj_PL<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main"><span class="free">⊩</span></span> <span class="free">p</span> <span class="main">∧</span> <span class="main"><span class="free">⊩</span></span> <span class="free">q</span><span class="main">)</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> valid_disj_PL<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span><span class="main">)</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> valid_equiv_PL<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.⟷.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">{</span><span class="free">p</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span> <span class="main">∧</span> <span class="main">{</span><span class="free">q</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> imp_PL not_PL conj_PL disj_PL equiv_PL valid_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Second, we will combine each logical operator with the consequence operator <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Cn›</span></span></span></span>: it is a trick to profit from set theory to get many essential 
lemmas without complex inferences›</span></span>
<span class="keyword1"><span class="command">declare</span></span> infer_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span>

<span class="keyword1" id="AGM_Logic-nonemptyCn"><span class="command">lemma</span></span> nonemptyCn<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> true_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="AGM_Logic-Cn_true"><span class="command">lemma</span></span> Cn_true<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">⊤</span></span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{}</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> Cn_same true_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="AGM_Logic-Cn_false"><span class="command">lemma</span></span> Cn_false<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">⊥</span></span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> UNIV›</span></span> 
  <span class="keyword1"><span class="command">using</span></span> false_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="AGM_Logic-Cn_imp"><span class="command">lemma</span></span> Cn_imp<span class="main">:</span>     <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">q</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">p</span><span class="main">}</span><span class="main">)</span>›</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> Cn_imp_bis<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">q</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">p</span><span class="main">}</span><span class="main">)</span>›</span></span> 
  <span class="keyword1"><span class="command">using</span></span> Cn_same imp_PL idempotency_L inclusion_L infer_def subset_insertI <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1" id="AGM_Logic-Cn_not"><span class="command">lemma</span></span> Cn_not<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main"><span class="free">.¬</span></span> <span class="free">p</span> <span class="main">⟷</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">p</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> UNIV›</span></span>
  <span class="keyword1"><span class="command">using</span></span> Cn_false Cn_imp notE_PL not_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1" id="AGM_Logic-Cn_conj"><span class="command">lemma</span></span> Cn_conj<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">p</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">q</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">intro</span> iffI conjI_PL<span class="main"><span class="keyword3">,</span></span> <span class="operator">frule</span> conjE1_PL<span class="main"><span class="keyword3">,</span></span> <span class="operator">frule</span> conjE2_PL<span class="main">)</span> 
  <span class="keyword1"><span class="command">using</span></span> Cn_same Un_insert_right bot.extremum idempotency_L inclusion_L <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="AGM_Logic-Cn_conj_bis"><span class="command">lemma</span></span> Cn_conj_bis<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">q</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">p</span><span class="main">,</span> <span class="free">q</span><span class="main">}</span><span class="main">)</span>›</span></span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold</span> Cn_same<span class="main">)</span>
     <span class="main">(</span><span class="operator">meson</span> Supraclassical_logic.conj_PL Supraclassical_logic_axioms insert_subset<span class="main">)</span>

<span class="keyword1" id="AGM_Logic-Cn_disj"><span class="command">lemma</span></span> Cn_disj<span class="main">:</span>     <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">q</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span><span class="main">}</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> Cn_disj_bis<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">q</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span><span class="main">}</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> disj_PL Cn_same imp_PL idempotency_L inclusion_L infer_def subset_insertI <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1" id="AGM_Logic-Cn_equiv"><span class="command">lemma</span></span> Cn_equiv<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.⟷.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">p</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">q</span><span class="main">}</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Cn_imp_bis equivE1_PL equivE2_PL equivI_PL set_eq_subset<span class="main">)</span>

<span class="keyword1"><span class="command">corollary</span></span> valid_nonemptyCn<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{}</span><span class="main">)</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> valid_Cn_imp<span class="main">:</span>     <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">q</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">p</span><span class="main">}</span><span class="main">)</span>›</span></span> 
      <span class="keyword2"><span class="keyword">and</span></span> valid_Cn_not<span class="main">:</span>     <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">p</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> UNIV›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> valid_Cn_conj<span class="main">:</span>    <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">p</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">q</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{}</span><span class="main">)</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> valid_Cn_disj<span class="main">:</span>    <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">q</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span><span class="main">}</span><span class="main">)</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> valid_Cn_equiv<span class="main">:</span>   <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.⟷.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">p</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">q</span><span class="main">}</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> nonemptyCn Cn_imp Cn_not Cn_conj Cn_disj Cn_equiv valid_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="comment1">― ‹Finally, we group additional lemmas that were essential in further proofs›</span>
<span class="keyword1" id="AGM_Logic-consistency"><span class="command">lemma</span></span> consistency<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">p</span><span class="main">}</span><span class="main">)</span> <span class="main">∩</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{}</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">q</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="free">p</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="skolem">q</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="skolem">q</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">{}</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span><span class="main">)</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">q</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> impI_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{}</span> <span class="main"><span class="free">⊢</span></span> <span class="skolem">q</span>›</span></span> 
      <span class="keyword1"><span class="command">using</span></span> ex_mid_PL <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule_tac</span> disjE_PL<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> p<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span class="quoted"><span class="free">p</span></span></span></span></span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword">and</span></span></span></span> q<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">‹<span class="main"><span class="free"><span class="main"><span class="free"><span class="main"><span class="free">.¬</span></span></span></span></span></span> <span class="free"><span class="free"><span class="free">p</span></span></span>›</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">blast</span>   
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">p</span><span class="main">}</span><span class="main">)</span> <span class="main">∩</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{}</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> subset_iff<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{}</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">p</span><span class="main">}</span><span class="main">)</span> <span class="main">∩</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span><span class="main">}</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> monotonicity_L<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="AGM_Logic-Cn_notnot"><span class="command">lemma</span></span> Cn_notnot<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="free">φ</span><span class="main">)</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">φ</span><span class="main">}</span><span class="main">)</span>›</span></span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> hide_lams<span class="main"><span class="main">)</span></span> notnot_PL valid_Cn_equiv valid_equiv_PL<span class="main">)</span> 

<span class="keyword1" id="AGM_Logic-conj_com"><span class="command">lemma</span></span> conj_com<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">q</span> <span class="main">⟷</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">p</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> conj_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="AGM_Logic-conj_com_Cn"><span class="command">lemma</span></span> conj_com_Cn<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">q</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">q</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">p</span><span class="main">}</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Cn_conj_bis insert_commute<span class="main">)</span> 

<span class="keyword1" id="AGM_Logic-disj_com"><span class="command">lemma</span></span> disj_com<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">q</span> <span class="main">⟷</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">p</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">p</span> <span class="skolem">q</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="skolem">p</span> <span class="main"><span class="free">.∨.</span></span> <span class="skolem">q</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="skolem">q</span> <span class="main"><span class="free">.∨.</span></span> <span class="skolem">p</span>›</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">erule</span> disjE_PL<span class="main">)</span> 
      <span class="keyword1"><span class="command">using</span></span> assumption_L disjI2_PL disjI1_PL impI_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="AGM_Logic-disj_com_Cn"><span class="command">lemma</span></span> disj_com_Cn<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">p</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">q</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">q</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">p</span><span class="main">}</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> Cn_same <span class="keyword1"><span class="command">using</span></span> disj_com <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1" id="AGM_Logic-imp_contrapos"><span class="command">lemma</span></span> imp_contrapos<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">q</span> <span class="main">⟷</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main"><span class="free">.¬</span></span> <span class="free">q</span> <span class="main"><span class="free">.⟶.</span></span> <span class="main"><span class="free">.¬</span></span> <span class="free">p</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Cn_not Un_insert_left Un_insert_right imp_PL notnot_PL<span class="main">)</span>

<span class="keyword1" id="AGM_Logic-equiv_negation"><span class="command">lemma</span></span> equiv_negation<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟷.</span></span> <span class="free">q</span> <span class="main">⟷</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main"><span class="free">.¬</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟷.</span></span> <span class="main"><span class="free">.¬</span></span> <span class="free">q</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> equivE1_PL equivE2_PL equivI_PL imp_contrapos <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="AGM_Logic-imp_trans"><span class="command">lemma</span></span> imp_trans<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span><span class="free">q</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span> <span class="main"><span class="free">.⟶.</span></span><span class="free">r</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span><span class="free">r</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> Cn_imp_bis <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="AGM_Logic-imp_recovery0"><span class="command">lemma</span></span> imp_recovery0<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.∨.</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">q</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">subst</span> disj_PL<span class="main"><span class="keyword3">,</span></span> <span class="operator">subst</span> imp_contrapos<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> assumption_L impI_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="AGM_Logic-imp_recovery1"><span class="command">lemma</span></span> imp_recovery1<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">q</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> disjE_PL<span class="main">[</span><span class="operator">OF</span> imp_recovery0<span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="free">p</span></span> <span class="quoted"><span class="free">p</span></span> <span class="quoted"><span class="free">q</span></span><span class="main">]</span> assumption_L imp_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="AGM_Logic-imp_recovery2"><span class="command">lemma</span></span> imp_recovery2<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">q</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">p</span><span class="main">)</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">p</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> imp_PL imp_recovery1 imp_trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="AGM_Logic-impI2"><span class="command">lemma</span></span> impI2<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">q</span>›</span></span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assumption_L impI_PL in_mono sup_ge1 transitivity2_L<span class="main">)</span>

<span class="keyword1" id="AGM_Logic-conj_equiv"><span class="command">lemma</span></span> conj_equiv<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main"><span class="free">.⟷.</span></span> <span class="free">q</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Un_insert_right assumption_L conjE2_PL conjI_PL equiv_PL impI2 imp_PL insertI1 sup_bot.right_neutral<span class="main">)</span>

<span class="keyword1" id="AGM_Logic-conj_imp"><span class="command">lemma</span></span> conj_imp<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">r</span> <span class="main">⟷</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="main">(</span><span class="free">q</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">r</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Cn</span> <span class="main">(</span><span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">r</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span> <span class="main">(</span><span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">p</span><span class="main">,</span> <span class="free">q</span><span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">)</span></span> Cn_conj_bis Cn_imp_bis Cn_union Un_insert_right sup_bot.right_neutral<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="main">(</span><span class="free">q</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">r</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Un_insert_right impI_PL inclusion_L infer_def insert_commute insert_subset subset_eq sup_bot.right_neutral<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
   <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="main">(</span><span class="free">q</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">p</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="free">q</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> imp_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> Cn_conj_bis Cn_union impI_PL infer_def insert_is_Un sup_assoc<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="AGM_Logic-conj_not_impE_PL"><span class="command">lemma</span></span> conj_not_impE_PL<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">r</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="main"><span class="free">.¬</span></span> <span class="free">q</span><span class="main">)</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">r</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">r</span>›</span></span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> conj_imp disjE_PL ex_mid_PL imp_PL<span class="main">)</span>

<span class="keyword1" id="AGM_Logic-disj_notE_PL"><span class="command">lemma</span></span> disj_notE_PL<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.∨.</span></span> <span class="main"><span class="free">.¬</span></span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> Cn_imp Cn_imp_bis Cn_not disjE_PL notnot_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1" id="AGM_Logic-disj_not_impE_PL"><span class="command">lemma</span></span> disj_not_impE_PL<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">r</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∨.</span></span> <span class="main"><span class="free">.¬</span></span> <span class="free">q</span><span class="main">)</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">r</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">r</span>›</span></span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Un_insert_right disjE_PL disj_PL disj_com ex_mid_PL insert_commute sup_bot.right_neutral<span class="main">)</span>

<span class="keyword1" id="AGM_Logic-imp_conj"><span class="command">lemma</span></span> imp_conj<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">q</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">r</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">s</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">r</span><span class="main">)</span> <span class="main"><span class="free">.⟶.</span></span> <span class="main">(</span><span class="free">q</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">s</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">intro</span> impI_PL conjI_PL<span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> imp_PL<span class="main"><span class="main">[</span></span><span class="operator">symmetric</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assumption_L conjE1_PL conjE2_PL imp_trans infer_def insertI1 validD_L valid_imp_PL<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1" id="AGM_Logic-conj_overlap"><span class="command">lemma</span></span> conj_overlap<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="main">(</span><span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span><span class="main">)</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">q</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> conj_PL disjI2_PL disj_com disj_notE_PL<span class="main">)</span>

<span class="keyword1" id="AGM_Logic-morgan"><span class="command">lemma</span></span> morgan<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="free">p</span><span class="main">)</span> <span class="main"><span class="free">.∨.</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="free">q</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> conj_imp disj_PL disj_com imp_PL imp_contrapos notE_PL notI_PL<span class="main">)</span>

<span class="keyword1" id="AGM_Logic-conj_superexpansion1"><span class="command">lemma</span></span> conj_superexpansion1<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main"><span class="free">.∧.</span></span> <span class="main"><span class="free">.¬</span></span> <span class="free">p</span> <span class="main">⟷</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main"><span class="free">.¬</span></span> <span class="free">p</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> conj_PL disjI1_PL morgan <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1" id="AGM_Logic-conj_superexpansion2"><span class="command">lemma</span></span> conj_superexpansion2<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="free">p</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">q</span><span class="main">)</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">p</span> <span class="main">⟷</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">p</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> conj_PL disjI1_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Compact Logic›</span></span>
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If the logic is compact, which means that any result is based on a finite set of hypothesis›</span></span>
<span class="keyword1"><span class="command">locale</span></span> Compact_logic <span class="main">=</span> Tarskian_logic <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> compactness_L<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∃</span><span class="bound">A'</span><span class="main">.</span> <span class="bound">A'</span><span class="main">⊆</span> <span class="free">A</span> <span class="main">∧</span> finite <span class="bound">A'</span> <span class="main">∧</span> <span class="bound">A'</span><span class="main"><span class="free">⊢</span></span> <span class="free">φ</span><span class="main">)</span>›</span></span>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Very important lemma preparing the application of the Zorn's lemma. It states that in a compact logic, we can not deduce <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>φ›</span></span></span></span>
if we accumulate an infinity of hypothesis groups which locally do not deduce phi›</span></span>
<span class="keyword1" id="AGM_Logic-chain_closure"><span class="command">lemma</span></span> chain_closure<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main"><span class="free">⊩</span></span> <span class="free">φ</span> <span class="main">⟹</span> subset.chain <span class="main">{</span><span class="bound">B</span><span class="main">.</span> <span class="main">¬</span> <span class="bound">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span><span class="main">}</span> <span class="free">C</span> <span class="main">⟹</span> <span class="main">¬</span> <span class="main">⋃</span><span class="free">C</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span>›</span></span> 
<span class="keyword1"><span class="command">proof</span></span>                                    
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹subset.chain <span class="main">{</span><span class="bound">B</span><span class="main">.</span> <span class="main">¬</span> <span class="bound">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span><span class="main">}</span> <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main"><span class="free">⊩</span></span> <span class="free">φ</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋃</span> <span class="free">C</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span>›</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A'</span></span> <span class="keyword2"><span class="keyword">where</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">A'</span><span class="main">⊆</span> <span class="main">⋃</span> <span class="free">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹finite <span class="skolem">A'</span>›</span></span>  <span class="keyword2"><span class="keyword">and</span></span> e<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">A'</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> compactness_L <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> f<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">f</span> <span class="main">≡</span> <span class="main">λ</span><span class="bound">a</span><span class="main">.</span> <span class="keyword1">SOME</span> <span class="bound">B</span><span class="main">.</span> <span class="bound">B</span> <span class="main">∈</span> <span class="free">C</span> <span class="main">∧</span> <span class="bound">a</span> <span class="main">∈</span> <span class="bound">B</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">‹finite <span class="main">(</span><span class="skolem">f</span> <span class="main">`</span> <span class="skolem">A'</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> f d <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">f</span> <span class="main">`</span> <span class="skolem">A'</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">C</span>›</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> Union_iff c someI_ex subset_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">‹subset.chain <span class="main">{</span><span class="bound">B</span><span class="main">.</span> <span class="main">¬</span> <span class="bound">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span><span class="main">}</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">`</span> <span class="skolem">A'</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> a h
    <span class="keyword1"><span class="command">using</span></span> a h <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> subsetD subset_chain_def subset_trans<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A'</span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="main">⋃</span> <span class="main">(</span><span class="skolem">f</span> <span class="main">`</span> <span class="skolem">A'</span><span class="main">)</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">B</span><span class="main">.</span> <span class="main">¬</span> <span class="bound">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span><span class="main">}</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> g i 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> Union_in_chain image_is_empty subset_chain_def subset_eq<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> j<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">A'</span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="main">¬</span> <span class="main">⋃</span><span class="main">(</span><span class="skolem">f</span> <span class="main">`</span> <span class="skolem">A'</span><span class="main">)</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A'</span> <span class="main">⊆</span> <span class="main">⋃</span><span class="main">(</span><span class="skolem">f</span> <span class="main">`</span> <span class="skolem">A'</span><span class="main">)</span>›</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> f <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> Union_iff c someI_ex subset_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> j e b <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> infer_def monotonicity_L subsetD valid_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword2"><span class="keyword">end</span></span>


</pre>
</div><div id="AGM_Remainder">
<div class="head">
<h1>Theory AGM_Remainder</h1>
</div>
<pre class="source"><span class="comment1">(*&lt;*)</span>
<span class="comment1">―‹ ******************************************************************** 
 * Project         : AGM Theory
 * Version         : 1.0
 *
 * Authors         : Valentin Fouillard, Safouan Taha, Frederic Boulanger
                     and Nicolas Sabouret
 *
 * This file       : AGM Remainders
 *
 * Copyright (c) 2021 Université Paris Saclay, France
 *
 ******************************************************************************›</span>

<span class="keyword1"><span class="command">theory</span></span> AGM_Remainder

<span class="keyword2"><span class="keyword">imports</span></span> <a href="#AGM_Logic">AGM_Logic</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="comment1">(*&gt;*)</span>



<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Remainders›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In AGM, one important feature is to eliminate some proposition from a set of propositions by ensuring 
that the set of retained clauses is maximal and that nothing among these clauses allows to retrieve the eliminated proposition›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Remainders in a Tarskian logic›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹In a general context of a Tarskian logic, we consider a descriptive definition (by comprehension)›</span></span>
<span class="keyword1"><span class="command">context</span></span> Tarskian_logic

<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">remainder</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> set set›</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">‹<span class="keyword1">.⊥.</span>›</span> 55<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> rem<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main"><span class="free">.⊥.</span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">≡</span> <span class="main">{</span><span class="bound">B</span><span class="main">.</span> <span class="bound">B</span> <span class="main">⊆</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">∧</span> <span class="main">¬</span> <span class="bound">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound"><span class="bound">B'</span></span><span class="main">⊆</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">.</span> <span class="bound">B</span> <span class="main">⊂</span> <span class="bound">B'</span> <span class="main">⟶</span> <span class="bound">B'</span> <span class="main"><span class="free">⊢</span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span><span class="main">}</span>›</span></span> 

<span class="keyword1" id="AGM_Remainder-rem_inclusion"><span class="command">lemma</span></span> rem_inclusion<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">B</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">⟹</span> <span class="free">B</span> <span class="main">⊆</span> <span class="free">A</span>›</span></span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>rem <span class="quasi_keyword">split</span><span class="main"><span class="main">:</span></span>if_splits<span class="main">)</span> 

<span class="keyword1" id="AGM_Remainder-rem_closure"><span class="command">lemma</span></span> rem_closure<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">B</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">⟹</span> <span class="free">B</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>›</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>rem infer_def<span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> idempotency_L inclusion_L monotonicity_L psubsetI<span class="main">)</span>

<span class="keyword1" id="AGM_Remainder-remainder_extensionality"><span class="command">lemma</span></span> remainder_extensionality<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">φ</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">ψ</span><span class="main">}</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">=</span> <span class="free">A</span> <span class="main">.⊥.</span> <span class="free">ψ</span>›</span></span> 
  <span class="keyword1"><span class="command">unfolding</span></span> rem infer_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">safe</span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Cn_same<span class="main">)</span> <span class="operator">blast</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword1" id="AGM_Remainder-nonconsequence_remainder"><span class="command">lemma</span></span> nonconsequence_remainder<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{</span><span class="free">A</span><span class="main">}</span> <span class="main">⟷</span> <span class="main">¬</span> <span class="free">A</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span>›</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> rem <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>                           

<span class="comment1">― ‹As we will see further, the other direction requires compactness!›</span>
<span class="keyword1" id="AGM_Remainder-taut2emptyrem"><span class="command">lemma</span></span> taut2emptyrem<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="free">φ</span> <span class="main">⟹</span> <span class="free">A</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>›</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> rem <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> infer_def validD_L<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Remainders in a supraclassical logic›</span></span>
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In case of a supraclassical logic, remainders get impressive properties›</span></span>
<span class="keyword1"><span class="command">context</span></span> Supraclassical_logic

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="comment1">― ‹As an effect of being maximal, a remainder keeps the eliminated proposition in its propositions hypothesis›</span>
<span class="keyword1" id="AGM_Remainder-remainder_recovery"><span class="command">lemma</span></span> remainder_recovery<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span> <span class="main">⟹</span> <span class="free">B</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">⟹</span> <span class="free">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">ψ</span>›</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">ψ</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">B</span>
    <span class="keyword3"><span class="command">assume</span></span>  a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">ψ</span> <span class="main">∈</span> <span class="free">K</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> e<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">φ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">ψ</span> <span class="main">∉</span> <span class="free">Cn</span><span class="main">(</span><span class="skolem">B</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">with</span></span> a <span class="keyword1"><span class="command">have</span></span> f<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">φ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">ψ</span> <span class="main">∈</span> <span class="free">K</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> impI2 infer_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> d e <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">φ</span> <span class="main">∈</span> <span class="free">Cn</span><span class="main">(</span><span class="skolem">B</span> <span class="main">∪</span> <span class="main">{</span><span class="free">φ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">ψ</span><span class="main">}</span><span class="main">)</span>›</span></span> 
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>rem<span class="main"><span class="keyword3">,</span></span> <span class="operator">elim</span> conjE<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> dual_order.order_iff_strict inclusion_L insert_subset<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> d <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> rem imp_recovery1 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> CollectD infer_def<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span> <span class="main">⟹</span> <span class="free">B</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">⟹</span> <span class="free">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">ψ</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> idempotency_L <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">― ‹When you remove some proposition <span class="antiquoted"><span class="raw_text"><span class="operator">‹</span>φ›</span></span> several other propositions can be lost. 
An important lemma states that the resulting remainder is also a remainder of any lost proposition›</span>
<span class="keyword1" id="AGM_Remainder-remainder_recovery_bis"><span class="command">lemma</span></span> remainder_recovery_bis<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span> <span class="main">⟹</span> <span class="main">¬</span> <span class="free">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span> <span class="main">⟹</span> <span class="free">B</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">⟹</span> <span class="free">B</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">ψ</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="free">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">B</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span>›</span></span>
  <span class="keyword1"><span class="command">hence</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">ψ</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> remainder_recovery <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> c <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">B</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">ψ</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>rem<span class="main">)</span> <span class="main">(</span><span class="operator">meson</span> b dual_order.trans infer_def insert_subset monotonicity_L mp_PL order_refl psubset_imp_subset<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">corollary</span></span> remainder_recovery_imp<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span> <span class="main">⟹</span> <span class="main"><span class="free">⊩</span></span> <span class="main">(</span><span class="free">ψ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">φ</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">B</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">⟹</span> <span class="free">B</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">ψ</span>›</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule</span> remainder_recovery_bis<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>rem<span class="main">)</span> <span class="main">(</span><span class="operator">meson</span> infer_def mp_PL validD_L<span class="main">)</span>

<span class="comment1">― ‹If we integrate back the eliminated proposition into the remainder, we retrieve the original set!›</span>
<span class="keyword1" id="AGM_Remainder-remainder_expansion"><span class="command">lemma</span></span> remainder_expansion<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span> <span class="main">⟹</span> <span class="main">¬</span> <span class="free">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span> <span class="main">⟹</span> <span class="free">B</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">⟹</span> <span class="free">B</span> <span class="main"><span class="free">⊕</span></span> <span class="free">ψ</span> <span class="main">=</span> <span class="free">K</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="free">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">B</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span>›</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">B</span> <span class="main"><span class="free">⊕</span></span> <span class="free">ψ</span> <span class="main">⊆</span> <span class="free">K</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Un_insert_right expansion_def idempotency_L infer_def insert_subset 
              monotonicity_L rem_inclusion sup_bot.right_neutral<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="free">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">B</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span>›</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">χ</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">χ</span> <span class="main">∈</span> <span class="free">K</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> e<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span> <span class="main"><span class="free">.⟶.</span></span><span class="skolem">χ</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> remainder_recovery<span class="main">[</span><span class="operator">OF</span> a _ d<span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="skolem">χ</span></span><span class="main">]</span> assumption_L <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">ψ</span> <span class="main">∈</span> <span class="free">K</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> a b idempotency_L infer_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">hence</span></span> f<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">B</span> <span class="main">∪</span> <span class="main">{</span><span class="free">ψ</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> b c d <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>rem<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> inclusion_L insert_iff insert_subsetI less_le_not_le subset_iff<span class="main">)</span> 
    <span class="keyword1"><span class="command">from</span></span> e f <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">B</span> <span class="main">∪</span> <span class="main">{</span><span class="free">ψ</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="skolem">χ</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> imp_PL imp_trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">⊆</span> <span class="free">B</span> <span class="main"><span class="free">⊕</span></span> <span class="free">ψ</span>›</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> expansion_def subsetI<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹To eliminate a conjunction, we only need to remove one side›</span></span>
<span class="keyword1" id="AGM_Remainder-remainder_conj"><span class="command">lemma</span></span> remainder_conj<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">)</span> <span class="main">∪</span> <span class="main">(</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="free">ψ</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">intro</span> subset_antisym Un_least subsetI<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>rem<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">meson</span> conj_PL infer_def<span class="main">)</span>
   <span class="keyword1"><span class="command">using</span></span> remainder_recovery_imp<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">K</span></span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="quoted">‹<span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span>›</span></span> <span class="quoted"><span class="free">φ</span></span><span class="main">]</span> 
   <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">meson</span> assumption_L conjE1_PL singletonI subsetI valid_imp_PL<span class="main">)</span>
  <span class="keyword1"><span class="command">using</span></span> remainder_recovery_imp<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">K</span></span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="quoted">‹<span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span>›</span></span> <span class="quoted"><span class="free">ψ</span></span><span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assumption_L conjE2_PL singletonI subsetI valid_imp_PL<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Remainders in a compact logic›</span></span>
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In case of a supraclassical logic, remainders get impressive properties›</span></span>
<span class="keyword1"><span class="command">context</span></span> Compact_logic
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The following lemma is the Lindembaum's lemma requiring the Zorn's lemma (already available in standard Isabelle/HOL). 
  For more details, please refer to the book "Theory of logical calculi" <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">cite</span></span> wojcicki2013theory<span class="antiquote"><span class="antiquote">}</span></span></span></span>. 
This very important lemma states that we can get a maximal set (remainder <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>B'›</span></span></span></span>) starting from any set 
<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>B›</span></span></span></span> if this latter does not infer the proposition <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>φ›</span></span></span></span> we want to eliminate›</span></span>
<span class="keyword1" id="AGM_Remainder-upper_remainder"><span class="command">lemma</span></span> upper_remainder<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">B</span> <span class="main">⊆</span> <span class="free">A</span> <span class="main">⟹</span> <span class="main">¬</span> <span class="free">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">B'</span><span class="main">.</span> <span class="free">B</span> <span class="main">⊆</span> <span class="bound">B'</span> <span class="main">∧</span>  <span class="bound">B'</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">.⊥.</span> <span class="free">φ</span>›</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">B</span> <span class="main">⊆</span> <span class="free">A</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="free">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main"><span class="free">⊩</span></span> <span class="free">φ</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> b infer_def validD_L <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">ℬ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ℬ</span> <span class="main">≡</span> <span class="main">{</span><span class="bound">B'</span><span class="main">.</span> <span class="free">B</span> <span class="main">⊆</span> <span class="bound">B'</span> <span class="main">∧</span> <span class="bound">B'</span> <span class="main">⊆</span> <span class="free">A</span> <span class="main">∧</span> <span class="main">¬</span> <span class="bound">B'</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹subset.chain <span class="skolem">ℬ</span> <span class="skolem">C</span> <span class="main">⟹</span> subset.chain <span class="main">{</span><span class="bound">B</span><span class="main">.</span> <span class="main">¬</span> <span class="bound">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span><span class="main">}</span> <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">C</span>
    <span class="keyword1"><span class="command">unfolding</span></span> ℬ_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> le_fun_def less_eq_set_def subset_chain_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> e<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">⟹</span> subset.chain <span class="skolem">ℬ</span> <span class="skolem">C</span> <span class="main">⟹</span> <span class="free">B</span> <span class="main">⊆</span> <span class="main">⋃</span> <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">C</span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> ℬ_def subset_chain_def less_eq_Sup mem_Collect_eq subset_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">C</span>
    <span class="keyword3"><span class="command">assume</span></span> f<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">‹subset.chain <span class="skolem">ℬ</span> <span class="skolem">C</span>›</span></span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋃</span> <span class="skolem">C</span> <span class="main">∈</span> <span class="skolem">ℬ</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> ℬ_def  e<span class="main">[</span><span class="operator">OF</span> f g<span class="main">]</span> chain_closure<span class="main">[</span><span class="operator">OF</span> c d<span class="main"><span class="main">[</span></span><span class="operator">OF</span> g<span class="main"><span class="main">]</span></span><span class="main">]</span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> CollectD Sup_least Sup_subset_mono g subset.chain_def subset_trans<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> f<span class="main">=</span>this 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹subset.chain <span class="skolem">ℬ</span> <span class="skolem">C</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">U</span><span class="main">∈</span><span class="skolem">ℬ</span><span class="main">.</span> <span class="main">∀</span><span class="bound">X</span><span class="main">∈</span><span class="skolem">C</span><span class="main">.</span> <span class="bound">X</span> <span class="main">⊆</span> <span class="bound">U</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">C</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span><span class="main">)</span> 
     <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">meson</span> Union_upper f<span class="main">)</span> 
    <span class="keyword1"><span class="command">using</span></span> ℬ_def a b <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> subset_Zorn<span class="main">[</span><span class="operator">OF</span> this<span class="main">,</span> <span class="operator">simplified</span><span class="main">]</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B'</span></span> <span class="keyword2"><span class="keyword">where</span></span> f<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B'</span><span class="main">∈</span> <span class="skolem">ℬ</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">X</span><span class="main">∈</span><span class="skolem">ℬ</span><span class="main">.</span> <span class="skolem">B'</span> <span class="main">⊆</span> <span class="bound">X</span> <span class="main">⟶</span> <span class="bound">X</span> <span class="main">=</span> <span class="skolem">B'</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>rem ℬ_def<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="skolem">B'</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> psubsetE subset_trans<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">― ‹An immediate corollary ruling tautologies›</span>
<span class="keyword1"><span class="command">corollary</span></span> emptyrem2taut<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="main"><span class="free">⊩</span></span> <span class="free">φ</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> bot.extremum empty_iff upper_remainder valid_def<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="AGM_Contraction">
<div class="head">
<h1>Theory AGM_Contraction</h1>
</div>
<pre class="source"><span class="comment1">(*&lt;*)</span>
<span class="comment1">―‹ ******************************************************************** 
 * Project         : AGM Theory
 * Version         : 1.0
 *
 * Authors         : Valentin Fouillard, Safouan Taha, Frederic Boulanger
                     and Nicolas Sabouret
 *
 * This file       : AGM contraction
 *
 * Copyright (c) 2021 Université Paris Saclay, France
 *
 * All rights reserved.
 *
 ******************************************************************************›</span>

<span class="keyword1"><span class="command">theory</span></span> AGM_Contraction

<span class="keyword2"><span class="keyword">imports</span></span> <a href="#AGM_Logic">AGM_Logic</a> <a href="#AGM_Remainder">AGM_Remainder</a>

<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Contractions›</span></span>
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The first operator of belief change of the AGM framework is contraction. This operator consist to remove 
a sentence <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> from a belief set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> in such a way that <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> no longer imply <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.

In the following we will first axiomatize such operators at different levels of logics (Tarskian, supraclassical and compact) 
and then we will give constructions satisfying these axioms. The following graph summarizes all equivalences we established:

\includegraphics[width=\textwidth]{"graph_locales.pdf"}

We will use the extension feature of locales in Isabelle/HOL to incrementally define the contraction 
operator as shown by blue arrows in the previous figure. Then, using the interpretation feature of locales, we will prove the equivalence between
descriptive and constructive approaches at each level depending on the adopted logics (black arrows).    
›</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹AGM contraction postulates›</span></span>
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹
The operator of contraction is denoted by the symbol <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹÷›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and respects the six following conditions :
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹contract_closure›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : a belief set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> contracted by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> should be logically closed
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹contract_inclusion›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : a contracted set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> should be a subset of the original one
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹contract_vacuity›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : if <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is not included in a set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> then the contraction of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> involves no change at all
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹contract_success›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : if a set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is contracted by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> then <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> does not imply <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹contract_recovery›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>: all propositions removed in a set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> by contraction of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> will be recovered by expansion of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹contract_extensionality›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : Extensionality guarantees that the logic of contraction is extensional in the sense of allowing logically 
quivalent sentences to be freely substituted for each other›</span></span>
<span class="keyword1"><span class="command">locale</span></span> AGM_Contraction <span class="main">=</span> Tarskian_logic <span class="main">+</span>
<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">contraction</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> set›</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">‹<span class="keyword1"><span class="keyword1"><span class="keyword1">÷</span></span></span>›</span> 55<span class="main">)</span>
<span class="keyword2"><span class="keyword">assumes</span></span> contract_closure<span class="main">:</span>        <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span><span class="main">)</span>›</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> contract_inclusion<span class="main">:</span>      <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span> <span class="main">⊆</span> <span class="free">K</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> contract_vacuity<span class="main">:</span>        <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">φ</span> <span class="main">∉</span> <span class="free">K</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span> <span class="main">=</span> <span class="free">K</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> contract_success<span class="main">:</span>        <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">φ</span> <span class="main">∉</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{}</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">φ</span> <span class="main">∉</span> <span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> contract_recovery<span class="main">:</span>       <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main">⊆</span> <span class="main">(</span><span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span><span class="main">)</span> <span class="main"><span class="free">⊕</span></span> <span class="free">φ</span><span class="main">)</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> contract_extensionality<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">φ</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">ψ</span><span class="main">}</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span> <span class="main">=</span> <span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">ψ</span>›</span></span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹
A full contraction is defined by two more postulates to rule the conjunction. We base on a supraclassical logic.
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹contract_conj_overlap›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : An element in both <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹K ÷ φ›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>  and  <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹K ÷ ψ›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>  is also an element of  <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹K ÷ (φ ∧ ψ)›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹contract_conj_inclusion›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : If <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> not in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹K ÷ (φ ∧ ψ)›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>  then all elements removed by this contraction are also removed from <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹K ÷ φ›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>›</span></span>
<span class="keyword1"><span class="command">locale</span></span> AGM_FullContraction <span class="main">=</span> AGM_Contraction <span class="main">+</span> Supraclassical_logic <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> contract_conj_overlap<span class="main">:</span>   <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> contract_conj_inclusion<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">φ</span> <span class="main">∉</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span>

<span class="keyword2"><span class="keyword">begin</span></span> 
<span class="comment1">― ‹two important lemmas/corollaries that can replace the two assumptions <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">text</span> <span class="raw_text">‹contract_conj_overlap›</span><span class="antiquote">}</span></span> and <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">text</span> <span class="raw_text">‹contract_conj_inclusion›</span><span class="antiquote">}</span></span>›</span>
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹contract_conj_overlap_variant›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> does not need <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>ψ›</span></span></span></span> to occur in the left side! ›</span></span>
<span class="keyword1"><span class="command">corollary</span></span> contract_conj_overlap_variant<span class="main">:</span>  <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span><span class="main">)</span> <span class="main">∩</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">φ</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span>›</span></span> 
    <span class="keyword1"><span class="command">hence</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main">=</span> <span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="main">(</span><span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="free">φ</span><span class="main">)</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">ψ</span><span class="main">)</span><span class="main">)</span>›</span></span> 
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">rule_tac</span> contract_extensionality<span class="main"><span class="main">[</span></span><span class="operator">OF</span> a<span class="main"><span class="main">]</span></span><span class="main">)</span> 
      <span class="keyword1"><span class="command">using</span></span> conj_overlap<span class="main">[</span><span class="operator">of</span> <span class="main">_</span> <span class="quoted"><span class="free">φ</span></span> <span class="quoted"><span class="free">ψ</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Cn_same<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> e<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">∩</span> <span class="free">Cn</span> <span class="main">{</span><span class="free">φ</span><span class="main">}</span> <span class="main">⊆</span> <span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="free">φ</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">ψ</span><span class="main">)</span>›</span></span> 
    <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">safe</span><span class="main">)</span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">χ</span>
      <span class="keyword3"><span class="command">assume</span></span> f<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">χ</span> <span class="main">∈</span> <span class="free">K</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">χ</span> <span class="main">∈</span> <span class="free">Cn</span> <span class="main">{</span><span class="free">φ</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="free">φ</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main"><span class="free">⊢</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="free">φ</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">χ</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> a contract_recovery expansion_def f impI_PL infer_def subset_eq<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="free">φ</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main"><span class="free">⊢</span></span> <span class="main"><span class="free">.¬</span></span> <span class="free">φ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">χ</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> disjI1_PL imp_trans inclusion_L infer_def insert_subset validD_L valid_imp_PL<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> g <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">χ</span> <span class="main">∈</span> <span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="free">φ</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">ψ</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> a contract_closure disjE_PL ex_mid_PL infer_def validD_L valid_imp_PL<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> d <span class="keyword1"><span class="command">using</span></span> e contract_conj_overlap<span class="main">[</span><span class="operator">OF</span> a<span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="free">φ</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="free">φ</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">ψ</span><span class="main">)</span>›</span></span><span class="main">]</span> a contract_inclusion <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span> 
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span> <span class="main">∨</span> <span class="main">¬</span> <span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span>›</span></span><span class="main">)</span>  
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> IntE a assumption_L conjE1_PL conjE2_PL contract_inclusion contract_vacuity subsetD subsetI<span class="main">)</span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span> 

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹contract_conj_inclusion_variant›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>: Everything retained in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹K ÷ (φ ∧ ψ)›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is retained in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹K ÷ ψ›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>›</span></span>
<span class="keyword1"><span class="command">corollary</span></span> contract_conj_inclusion_variant <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span><span class="main">)</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">ψ</span><span class="main">)</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">φ</span> <span class="main">∈</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="free">ψ</span> <span class="main">∈</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span><span class="main">)</span>›</span></span> 
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span> <span class="main">∈</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span><span class="main">)</span>›</span></span> 
      <span class="keyword1"><span class="command">using</span></span> Supraclassical_logic.conjI_PL Supraclassical_logic_axioms a contract_closure <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">with</span></span> d <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> Supraclassical_logic.valid_conj_PL Supraclassical_logic_axioms 
                Tarskian_logic.valid_expansion Tarskian_logic_axioms a contract_closure contract_inclusion 
                contract_recovery contract_success dual_order.trans expansion_def<span class="main">)</span>     
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> a conj_com_Cn contract_conj_inclusion contract_extensionality<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Partial meet contraction definition›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A partial meet contraction of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is the intersection of some sets that not imply <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.
We define these sets as the "remainders" <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹(K .⊥. φ›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.
The function of selection <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">γ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> select the best set of the remainders that do not imply <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>.
This function respect these postulates :
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹is_selection›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : if there exist some set that do not imply <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> then the function selection <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">γ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is a subset of these sets
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹tautology_selection›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : if there is no set that do not imply <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> then the result of the selection function is <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">nonempty_selection</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : An empty selection function do not exist
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">extensional_selection</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : Two proposition with the same closure have the same selection function›</span></span>
<span class="keyword1"><span class="command">locale</span></span> PartialMeetContraction <span class="main">=</span> Tarskian_logic <span class="main">+</span>

<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">selection</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span>  <span class="main">⇒</span> <span class="tfree">'a</span> set set›</span></span> <span class="main">(</span><span class="quoted">‹<span class="keyword1"><span class="keyword1">γ</span></span>›</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">assumes</span></span> is_selection<span class="main">:</span>          <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">)</span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="keyword1"><span class="free">γ</span></span> <span class="free">K</span> <span class="free">φ</span> <span class="main">⊆</span> <span class="main">(</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">)</span>›</span></span>
<span class="keyword2"><span class="keyword">assumes</span></span> tautology_selection<span class="main">:</span>   <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="keyword1"><span class="free">γ</span></span> <span class="free">K</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{</span><span class="free">K</span><span class="main">}</span>›</span></span>
<span class="keyword2"><span class="keyword">assumes</span></span> nonempty_selection<span class="main">:</span>    <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="keyword1"><span class="free">γ</span></span> <span class="free">K</span> <span class="free">φ</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span>
<span class="keyword2"><span class="keyword">assumes</span></span> extensional_selection<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">φ</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">ψ</span><span class="main">}</span><span class="main">)</span> <span class="main">⟹</span> <span class="keyword1"><span class="free">γ</span></span> <span class="free">K</span> <span class="free">φ</span> <span class="main">=</span> <span class="keyword1"><span class="free">γ</span></span> <span class="free">K</span> <span class="free">ψ</span>›</span></span>

<span class="comment1">― ‹extensionality seems very hard to implement for a constructive approach, 
one basic implementation will be to ignore <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">‹<span class="free">A</span>›</span><span class="antiquote">}</span></span> and <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">term</span> <span class="quoted">‹<span class="free">φ</span>›</span><span class="antiquote">}</span></span> 
and only base on <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">text</span> <span class="raw_text">‹A .⊥. φ›</span><span class="antiquote">}</span></span> that 
is already proved as extensional (lemma <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">text</span> <span class="raw_text">‹remainder_extensionality›</span><span class="antiquote">}</span></span>)›</span> 

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹A partial meet is the intersection of set of selected element.›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Tarskian_logic<span class="main">)</span> <span class="entity">meet_contraction</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span>  <span class="main">⇒</span> <span class="tfree">'a</span> set set<span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> set›</span></span> <span class="main">(</span><span class="quoted">‹_ <span class="keyword1">÷⇘</span>_<span class="keyword1">⇙</span> _›</span> <span class="main">[</span>60<span class="main">,</span>50<span class="main">,</span>60<span class="main">]</span>55<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> mc<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> ÷<span class="hidden">⇘</span><sub><span class="free"><span class="bound"><span class="entity">γ</span></span></span></sub><span class="hidden">⇙</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">⋂</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span>›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Following this definition 4 postulates of AGM can be proved on a partial meet contraction:
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹contract_inclusion›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹ contract_vacuity›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹ contract_closure›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹ contract_extensionality›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹pmc_inclusion›</span></span> <span class="antiquote"><span class="antiquote">}</span></span></span></span> :a partial meet contraction is a subset of the contracted set›</span></span>
<span class="keyword1" id="AGM_Contraction-pmc_inclusion"><span class="command">lemma</span></span> pmc_inclusion<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ</span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span> <span class="main">⊆</span> <span class="free">K</span>›</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>›</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mc tautology_selection<span class="main">)</span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> Inf_less_eq in_mono is_selection nonempty_selection rem_inclusion<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹pmc_vacuity›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> :  if <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is not included in a set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> then the partial meet contraction of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> involves not change at all›</span></span>
<span class="keyword1" id="AGM_Contraction-pmc_vacuity"><span class="command">lemma</span></span> pmc_vacuity<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">¬</span> <span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span> <span class="main">⟹</span> <span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ</span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span> <span class="main">=</span> <span class="free">K</span>›</span></span> 
  <span class="keyword1"><span class="command">unfolding</span></span> mc nonconsequence_remainder
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Inf_superset_mono Un_absorb1 cInf_singleton insert_not_empty is_selection mc nonconsequence_remainder pmc_inclusion sup_commute<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹pmc_closure›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : a partial meet contraction is logically closed›</span></span>
<span class="keyword1" id="AGM_Contraction-pmc_closure"><span class="command">lemma</span></span> pmc_closure<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ</span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ</span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span><span class="main">)</span>›</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> subset_antisym<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>inclusion_L mc transitivity_L<span class="main"><span class="keyword3">,</span></span> <span class="operator">goal_cases</span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> 1
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋂</span><span class="main">(</span><span class="keyword1"><span class="free">γ</span></span> <span class="main">(</span><span class="free">Cn</span> <span class="free">A</span><span class="main">)</span> <span class="free">φ</span><span class="main">)</span> <span class="main">=</span> <span class="main">⋂</span><span class="main">{</span><span class="free">Cn</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span><span class="main">|</span><span class="bound">B</span><span class="main">.</span> <span class="bound">B</span> <span class="main">∈</span> <span class="keyword1"><span class="free">γ</span></span> <span class="main">(</span><span class="free">Cn</span> <span class="free">A</span><span class="main">)</span> <span class="free">φ</span><span class="main">}</span>›</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">metis</span> idempotency_L insert_absorb insert_iff insert_subset is_selection rem_closure tautology_selection<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">from</span></span> Cn_Inter<span class="main">[</span><span class="operator">OF</span> this<span class="main">]</span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹pmc_extensionality›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : Extensionality guarantees that the logic of contraction is extensional in the sense of allowing logically equivalent sentences to be freely substituted for each other›</span></span>
<span class="keyword1" id="AGM_Contraction-pmc_extensionality"><span class="command">lemma</span></span> pmc_extensionality<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">φ</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">ψ</span><span class="main">}</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ</span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span> <span class="main">=</span> <span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ</span></span></sub><span class="hidden">⇙</span> <span class="free">ψ</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> extensional_selection mc<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹pmc_tautology›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : if <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is a tautology then the partial meet contraction of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>›</span></span>
<span class="keyword1" id="AGM_Contraction-pmc_tautology"><span class="command">lemma</span></span> pmc_tautology<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="main"><span class="free">⊩</span></span> <span class="free">φ</span> <span class="main">⟹</span>  <span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ</span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span> <span class="main">=</span> <span class="free">K</span>›</span></span> 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mc taut2emptyrem tautology_selection<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹completion›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is a an operator that can build an equivalent selection from an existing one›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Tarskian_logic<span class="main">)</span> <span class="entity">completion</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span>  <span class="main">⇒</span> <span class="tfree">'a</span> set set<span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span>  <span class="main">⇒</span> <span class="tfree">'a</span> set set›</span></span> <span class="main">(</span><span class="quoted">‹<span class="keyword1">*</span>›</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">*</span></span> <span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">≡</span> <span class="keyword1">if</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">.⊥.</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span> <span class="keyword1">then</span> <span class="main">{</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">}</span> <span class="keyword1">else</span> <span class="main">{</span><span class="bound">B</span><span class="main">.</span> <span class="bound">B</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">.⊥.</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">∧</span> <span class="main">⋂</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">γ</span></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">B</span><span class="main">}</span>›</span></span>


<span class="keyword1" id="AGM_Contraction-selection_completion"><span class="command">lemma</span></span> selection_completion<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="keyword1"><span class="free">γ</span></span> <span class="free">K</span> <span class="free">φ</span> <span class="main">⊆</span> <span class="main">*</span> <span class="keyword1"><span class="free">γ</span></span> <span class="free">K</span> <span class="free">φ</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> completion_def is_selection tautology_selection <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> Tarskian_logic<span class="main">)</span> completion_completion<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">*</span> <span class="main">(</span><span class="main">*</span> <span class="free">γ</span><span class="main">)</span> <span class="free">K</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">*</span> <span class="free">γ</span> <span class="free">K</span> <span class="free">φ</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>completion_def<span class="main">)</span>

<span class="keyword1" id="AGM_Contraction-pmc_completion"><span class="command">lemma</span></span> pmc_completion<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="main">*</span><span class="keyword1"><span class="free">γ</span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span> <span class="main">=</span> <span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ</span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span>›</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> mc completion_def tautology_selection<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Inter_lower equals0D in_mono is_selection<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A transitively relational meet contraction is a partial meet contraction using a binary relation between the elements of the selection function›</span></span>
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A relation is : 
<span class="antiquoted"><span class="antiquoted">▪</span></span> transitive (<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹trans_rel›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>)
<span class="antiquoted"><span class="antiquoted">▪</span></span> non empty (there is always an element  preferred to the others (<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹nonempty_rel›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>))›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A selection function <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is transitively relational <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹rel_sel›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> with the following condition :
<span class="antiquoted"><span class="antiquoted">▪</span></span> If the the remainders <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹K .⊥. φ›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is empty then the selection function return <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
<span class="antiquoted"><span class="antiquoted">▪</span></span> Else the selection function return a non empty transitive relation on the remainders›</span></span>
<span class="keyword1"><span class="command">locale</span></span> TransitivelyRelationalMeetContraction <span class="main">=</span>  Tarskian_logic <span class="main">+</span>

<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">relation</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span> set <span class="main">⇒</span> bool›</span></span> <span class="main">(</span><span class="quoted">‹_ <span class="keyword1"><span class="keyword1">≼⇘</span></span>_<span class="keyword1"><span class="keyword1">⇙</span></span> _›</span> <span class="main">[</span>60<span class="main">,</span>50<span class="main">,</span>60<span class="main">]</span>55<span class="main">)</span>
<span class="keyword2"><span class="keyword">assumes</span></span> trans_rel<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">B</span> ≼<span class="hidden">⇘</span><sub><span class="free">K</span></sub><span class="hidden">⇙</span> <span class="free">C</span> <span class="main">⟹</span> <span class="free">C</span> ≼<span class="hidden">⇘</span><sub><span class="free">K</span></sub><span class="hidden">⇙</span> <span class="free">D</span> <span class="main">⟹</span> <span class="free">B</span> ≼<span class="hidden">⇘</span><sub><span class="free">K</span></sub><span class="hidden">⇙</span> <span class="free">D</span>›</span></span>
<span class="keyword2"><span class="keyword">assumes</span></span> nonempty_rel<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">)</span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">B</span><span class="main">∈</span><span class="main">(</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">C</span><span class="main">∈</span><span class="main">(</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">)</span><span class="main">.</span> <span class="bound">C</span> ≼<span class="hidden">⇘</span><sub><span class="free">K</span></sub><span class="hidden">⇙</span> <span class="bound">B</span><span class="main">)</span>›</span></span> <span class="comment1">― ‹pas clair dans la litterrature›</span>

<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">rel_sel</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span>  <span class="main">⇒</span> <span class="tfree">'a</span> set set›</span></span> <span class="main">(</span><span class="quoted">‹<span class="keyword1"><span class="keyword1">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span>›</span><span class="main">)</span> 
<span class="keyword2"><span class="keyword">defines</span></span> rel_sel<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span> <span class="free">K</span> <span class="free">φ</span> <span class="main">≡</span> <span class="keyword1">if</span> <span class="main">(</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span> <span class="keyword1">then</span> <span class="main">{</span><span class="free">K</span><span class="main">}</span> 
                                              <span class="keyword1">else</span> <span class="main">{</span><span class="bound">B</span><span class="main">.</span> <span class="bound">B</span><span class="main">∈</span><span class="main">(</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">C</span><span class="main">∈</span><span class="main">(</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">)</span><span class="main">.</span> <span class="bound">C</span> ≼<span class="hidden">⇘</span><sub><span class="free">K</span></sub><span class="hidden">⇙</span> <span class="bound">B</span><span class="main">)</span><span class="main">}</span>›</span></span>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A transitively relational selection function respect the partial meet contraction postulates.›</span></span>
<span class="keyword1"><span class="command">sublocale</span></span> PartialMeetContraction <span class="keyword2"><span class="keyword">where</span></span> selection <span class="main">=</span> <span class="quoted"><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main">)</span>
     <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rel_sel<span class="main">)</span> 
   <span class="keyword1"><span class="command">using</span></span> nonempty_rel <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">using</span></span> remainder_extensionality <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A full meet contraction is a limiting case of the partial meet contraction where if the remainders are not empty then
the selection function return all the remainders (as defined by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹full_sel›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>›</span></span>
<span class="keyword1"><span class="command">locale</span></span> FullMeetContraction <span class="main">=</span> Tarskian_logic <span class="main">+</span>

<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">full_sel</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span>  <span class="main">⇒</span> <span class="tfree">'a</span> set set›</span></span> <span class="main">(</span><span class="quoted">‹<span class="keyword1"><span class="keyword1">γ<span class="hidden">⇩</span><sub>F</sub><span class="hidden">⇩</span><sub>C</sub></span></span>›</span><span class="main">)</span> 
<span class="keyword2"><span class="keyword">defines</span></span> full_sel<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>F</sub><span class="hidden">⇩</span><sub>C</sub></span></span> <span class="free">K</span> <span class="free">φ</span> <span class="main">≡</span> <span class="keyword1">if</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span> <span class="keyword1">then</span> <span class="main">{</span><span class="free">K</span><span class="main">}</span> <span class="keyword1">else</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span>›</span></span>

<span class="keyword2"><span class="keyword">begin</span></span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A full selection and a relation ? is a transitively relational meet contraction postulates.›</span></span>
<span class="keyword1"><span class="command">sublocale</span></span> TransitivelyRelationalMeetContraction <span class="keyword2"><span class="keyword">where</span></span> relation <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">λ</span> <span class="bound">K</span> <span class="bound">A</span> <span class="bound">B</span><span class="main">.</span> True›</span></span> <span class="keyword2"><span class="keyword">and</span></span> rel_sel<span class="main">=</span><span class="quoted"><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>F</sub><span class="hidden">⇩</span><sub>C</sub></span></span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold_locales</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>full_sel<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> eq_reflection<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span><span class="main">)</span> 

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Equivalence of partial meet contraction and AGM contraction›</span></span>


<span class="keyword1"><span class="command">locale</span></span> PMC_SC <span class="main">=</span> PartialMeetContraction <span class="main">+</span> Supraclassical_logic <span class="main">+</span> Compact_logic 

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹In a context of a supraclassical and a compact logic the two remaining postulates of AGM contraction :
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹contract_recovery›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹contract_success›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
can be proved on a partial meet contraction.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹pmc_recovery›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : all proposition removed by a partial meet contraction of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> will be recovered by the expansion of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>›</span></span>

<span class="comment1">― ‹recovery requires supraclassicality›</span>
<span class="keyword1" id="AGM_Contraction-pmc_recovery"><span class="command">lemma</span></span> pmc_recovery<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main">⊆</span> <span class="main">(</span><span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ</span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span><span class="main">)</span> <span class="main"><span class="free">⊕</span></span> <span class="free">φ</span><span class="main">)</span>›</span></span>  
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>›</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">no_asm</span><span class="main"><span class="main">)</span></span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>mc expansion_def<span class="main">)</span> 
  <span class="keyword1"><span class="command">using</span></span> inclusion_L tautology_selection <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">ψ</span>
      <span class="keyword3"><span class="command">assume</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="skolem">ψ</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">φ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">ψ</span> <span class="main">∈</span> <span class="main">⋂</span><span class="main">(</span><span class="keyword1"><span class="free">γ</span></span> <span class="free">K</span> <span class="free">φ</span><span class="main">)</span>›</span></span> 
        <span class="keyword1"><span class="command">using</span></span> is_selection<span class="main">[</span><span class="operator">OF</span> a b<span class="main">]</span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">metis</span> a d infer_def rem_closure remainder_recovery subsetD<span class="main">)</span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">with</span></span> a b <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">⊆</span> <span class="free">Cn</span> <span class="main">(</span>insert <span class="free">φ</span> <span class="main">(</span><span class="main">⋂</span> <span class="main">(</span><span class="keyword1"><span class="free">γ</span></span> <span class="free">K</span> <span class="free">φ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> Un_commute assumption_L imp_PL infer_def insert_is_Un subsetI<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹pmc_success›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : a partial meet contraction of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> not imply <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>›</span></span>
<span class="comment1">― ‹success requires compacteness›</span>
<span class="keyword1" id="AGM_Contraction-pmc_success"><span class="command">lemma</span></span> pmc_success<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">φ</span> <span class="main">∉</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{}</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">φ</span> <span class="main">∉</span> <span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ</span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">φ</span> <span class="main">∉</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{}</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">φ</span> <span class="main">∈</span> <span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ</span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span>›</span></span>
  <span class="keyword1"><span class="command">from</span></span> c <span class="keyword3"><span class="command">show</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">unfolding</span></span> mc
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{</span><span class="free">K</span><span class="main">}</span>›</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> assumption_L c nonconsequence_remainder pmc_inclusion<span class="main"><span class="main">[</span></span><span class="operator">OF</span> a<span class="main"><span class="main">]</span></span> subsetD<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">B</span><span class="main">∈</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">.</span> <span class="free">φ</span> <span class="main">∉</span> <span class="bound">B</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> assumption_L rem <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> b emptyrem2taut validD_L <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
      <span class="keyword1"><span class="command">using</span></span> b c mc nonempty_selection<span class="main">[</span><span class="operator">OF</span> a<span class="main">]</span> validD_L emptyrem2taut is_selection<span class="main">[</span><span class="operator">OF</span> a<span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Inter_iff bot.extremum_uniqueI subset_iff<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹As a partial meet contraction has been proven to respect all postulates of AGM contraction 
the equivalence between the both are straightforward›</span></span>
<span class="keyword1"><span class="command">sublocale</span></span> AGM_Contraction <span class="keyword2"><span class="keyword">where</span></span> contraction <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">λ</span><span class="bound">A</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">A</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ</span></span></sub><span class="hidden">⇙</span> <span class="bound">φ</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> pmc_closure pmc_inclusion pmc_vacuity 
        pmc_success pmc_recovery pmc_extensionality
        expansion_def idempotency_L infer_def
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold_locales</span><span class="main">)</span> <span class="operator">metis</span><span class="main"><span class="keyword3">+</span></span>

<span class="keyword2"><span class="keyword">end</span></span>


<span class="keyword1"><span class="command">locale</span></span> AGMC_SC <span class="main">=</span> AGM_Contraction <span class="main">+</span> Supraclassical_logic <span class="main">+</span> Compact_logic

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹obs 2.5 page 514›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AGM_selection</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span>  <span class="main">⇒</span> <span class="tfree">'a</span> set set›</span></span> <span class="main">(</span><span class="quoted">‹<span class="keyword1">γ<span class="hidden">⇩</span><sub>A</sub><span class="hidden">⇩</span><sub>G</sub><span class="hidden">⇩</span><sub>M</sub></span>›</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> AGM_sel<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>A</sub><span class="hidden">⇩</span><sub>G</sub><span class="hidden">⇩</span><sub>M</sub></span></span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">≡</span> <span class="keyword1">if</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">.⊥.</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">=</span> <span class="main">{}</span> <span class="keyword1">then</span> <span class="main">{</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">}</span> <span class="keyword1">else</span> <span class="main">{</span><span class="bound">B</span><span class="main">.</span> <span class="bound">B</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main">.⊥.</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="main"><span class="free">÷</span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">⊆</span> <span class="bound">B</span><span class="main">}</span>›</span></span> 

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The selection function <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="keyword1">γ<span class="hidden">⇩</span><sub>A</sub><span class="hidden">⇩</span><sub>G</sub><span class="hidden">⇩</span><sub>M</sub></span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> respect the partial meet contraction postulates›</span></span>
<span class="keyword1"><span class="command">sublocale</span></span> PartialMeetContraction <span class="keyword2"><span class="keyword">where</span></span> selection <span class="main">=</span> <span class="quoted"><span class="keyword1">γ<span class="hidden">⇩</span><sub>A</sub><span class="hidden">⇩</span><sub>G</sub><span class="hidden">⇩</span><sub>M</sub></span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">unfold</span> AGM_sel<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">goal_cases</span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>1 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">φ</span><span class="main">)</span> <span class="comment1">― ‹<span class="antiquoted"><span class="antiquote">@{</span><span class="operator">text</span> <span class="raw_text">‹non_emptiness›</span><span class="antiquote">}</span></span> of selection requires a compact logic›</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>  <span class="keyword1"><span class="command">using</span></span> upper_remainder<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">‹<span class="skolem">K</span> <span class="main"><span class="free">÷</span></span> <span class="skolem">φ</span>›</span></span> <span class="quoted"><span class="skolem">K</span></span> <span class="quoted"><span class="skolem">φ</span></span><span class="main">]</span> contract_success<span class="main">[</span><span class="operator">OF</span> 1<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> contract_closure contract_inclusion infer_def taut2emptyrem valid_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>2 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">φ</span> <span class="skolem">ψ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> contract_extensionality Collect_cong remainder_extensionality<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span> 

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹contraction_is_pmc›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : an AGM contraction is equivalent to a partial met contraction using the selection function <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>γ<span class="hidden">⇩</span><sub>A</sub><span class="hidden">⇩</span><sub>G</sub><span class="hidden">⇩</span><sub>M</sub>›</span></span></span></span>›</span></span>
<span class="keyword1" id="AGM_Contraction-contraction_is_pmc"><span class="command">lemma</span></span> contraction_is_pmc<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span> <span class="main">=</span> <span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1">γ<span class="hidden">⇩</span><sub>A</sub><span class="hidden">⇩</span><sub>G</sub><span class="hidden">⇩</span><sub>M</sub></span></sub><span class="hidden">⇙</span> <span class="free">φ</span>›</span></span> <span class="comment1">― ‹requires a supraclassical logic›</span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span> <span class="main">⊆</span> <span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1">γ<span class="hidden">⇩</span><sub>A</sub><span class="hidden">⇩</span><sub>G</sub><span class="hidden">⇩</span><sub>M</sub></span></sub><span class="hidden">⇙</span> <span class="free">φ</span>›</span></span> 
    <span class="keyword1"><span class="command">using</span></span> contract_inclusion<span class="main">[</span><span class="operator">OF</span> a<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>mc AGM_sel<span class="main">)</span> 
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1">γ<span class="hidden">⇩</span><sub>A</sub><span class="hidden">⇩</span><sub>G</sub><span class="hidden">⇩</span><sub>M</sub></span></sub><span class="hidden">⇙</span> <span class="free">φ</span> <span class="main">⊆</span> <span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="free">φ</span>›</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{}</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> nonconsequence_remainder taut2emptyrem <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>mc AGM_sel<span class="main">)</span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> a emptyrem2taut contract_closure contract_recovery valid_expansion<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>  
    <span class="keyword3"><span class="command">case</span></span> validFalse<span class="main">:</span>False
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span>›</span></span><span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> True
      <span class="keyword1"><span class="command">hence</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span>
        <span class="keyword1"><span class="command">using</span></span> emptyrem2taut validFalse <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">have</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">ψ</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">⟹</span> <span class="free">φ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">ψ</span> <span class="main">∈</span> <span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">ψ</span> 
        <span class="keyword1"><span class="command">using</span></span> Supraclassical_logic.impI_PL Supraclassical_logic_axioms a contract_closure contract_recovery expansion_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">ψ</span>
        <span class="keyword3"><span class="command">assume</span></span> e<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">ψ</span> <span class="main">∈</span> <span class="free">K</span> ›</span></span> <span class="keyword2"><span class="keyword">and</span></span> f<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">ψ</span> <span class="main">∉</span> <span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span>›</span></span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">ψ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">φ</span><span class="main">)</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">φ</span> <span class="main">∉</span> <span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span>›</span></span> 
          <span class="keyword1"><span class="command">using</span></span> imp_recovery2<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span>›</span></span> <span class="quoted"><span class="free">φ</span></span> <span class="quoted"><span class="skolem">ψ</span></span><span class="main">]</span> a contract_closure d e f <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">hence</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">ψ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">φ</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span>›</span></span> 
          <span class="keyword1"><span class="command">using</span></span> a contract_closure impI_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">ψ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">φ</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">B</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span>›</span></span>  
          <span class="keyword1"><span class="command">using</span></span> upper_remainder<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">ψ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="free">φ</span><span class="main">}</span>›</span></span> <span class="quoted"><span class="free">K</span></span> <span class="quoted"><span class="free">φ</span></span><span class="main">]</span> a True contract_inclusion idempotency_L impI2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">hence</span></span> j<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">ψ</span> <span class="main">∉</span> <span class="free">Cn</span><span class="main">(</span><span class="skolem">B</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> CollectD mp_PL Un_insert_right a infer_def insert_subset rem rem_closure<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ψ</span> <span class="main">∉</span>  <span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1">γ<span class="hidden">⇩</span><sub>A</sub><span class="hidden">⇩</span><sub>G</sub><span class="hidden">⇩</span><sub>M</sub></span></sub><span class="hidden">⇙</span> <span class="free">φ</span>›</span></span> 
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>mc AGM_sel b<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule_tac</span> x<span class="main"><span class="main">=</span></span><span class="quoted"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword"><span class="quasi_keyword">in</span></span></span> exI<span class="main">)</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> Tarskian_logic.assumption_L Tarskian_logic_axioms h i j le_sup_iff<span class="main">)</span>
      <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
        <span class="keyword1"><span class="command">using</span></span> a pmc_inclusion <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> False
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">{</span><span class="free">K</span><span class="main">}</span>›</span></span>
        <span class="keyword1"><span class="command">using</span></span> nonconsequence_remainder taut2emptyrem <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
        <span class="keyword1"><span class="command">using</span></span> False a contract_vacuity idempotency_L pmc_vacuity <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="AGM_Contraction-contraction_with_completion"><span class="command">lemma</span></span> contraction_with_completion<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span> <span class="main">=</span> <span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="main">*</span> <span class="keyword1">γ<span class="hidden">⇩</span><sub>A</sub><span class="hidden">⇩</span><sub>G</sub><span class="hidden">⇩</span><sub>M</sub></span></sub><span class="hidden">⇙</span> <span class="free">φ</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> contraction_is_pmc pmc_completion<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="comment1">(* in case of doubt uncomment one of these∈
sublocale AGMC_SC ⊆ PMC_SC where selection = γ<span class="hidden">⇩</span><sub>A</sub><span class="hidden">⇩</span><sub>G</sub><span class="hidden">⇩</span><sub>M</sub><span class="hidden">⇩</span><sub>C</sub> 
  by (unfold_locales)

sublocale PMC_SC ⊆ AGMC_SC where contraction = ‹λA φ. A ÷<span class="hidden">⇘</span><sub>γ</sub><span class="hidden">⇙</span> φ›
  by (unfold_locales)
*)</span>

<span class="keyword1"><span class="command">locale</span></span> TRMC_SC <span class="main">=</span> TransitivelyRelationalMeetContraction <span class="main">+</span> PMC_SC <span class="keyword2"><span class="keyword">where</span></span> selection <span class="main">=</span> <span class="quoted"><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span></span>

<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹A transitively relational selection function respect conjuctive overlap.›</span></span>
<span class="keyword1" id="AGM_Contraction-rel_sel_conj_overlap"><span class="command">lemma</span></span> rel_sel_conj_overlap<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span> <span class="free">K</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main">⊆</span> <span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span> <span class="free">K</span> <span class="free">φ</span> <span class="main">∪</span> <span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span> <span class="free">K</span> <span class="free">ψ</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">intro</span> subsetI<span class="main">)</span> 
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">B</span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∈</span> <span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span> <span class="free">K</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∈</span> <span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span> <span class="free">K</span> <span class="free">φ</span> <span class="main">∪</span> <span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span> <span class="free">K</span> <span class="free">ψ</span>›</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="free">φ</span> <span class="main">∨</span> <span class="main"><span class="free">⊩</span></span> <span class="free">ψ</span> <span class="main">∨</span> <span class="main">¬</span> <span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span> <span class="main">∨</span> <span class="main">¬</span> <span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span>›</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">elim</span> disjE<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="free">φ</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">ψ</span><span class="main">}</span><span class="main">)</span>›</span></span> 
      <span class="keyword1"><span class="command">using</span></span> conj_equiv valid_Cn_equiv valid_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> b <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Un_iff a c extensional_selection<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="free">ψ</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">φ</span><span class="main">}</span><span class="main">)</span>›</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Cn_conj_bis Cn_same validD_L<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> b <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Un_iff a c extensional_selection<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> UnI1 a b conjE1_PL is_selection nonconsequence_remainder nonempty_selection tautology_selection subset_singletonD<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> UnI2 a b conjE2_PL is_selection nonconsequence_remainder nonempty_selection tautology_selection subset_singletonD<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">(</span><span class="main"><span class="free">⊩</span></span> <span class="free">φ</span> <span class="main">∨</span> <span class="main"><span class="free">⊩</span></span> <span class="free">ψ</span> <span class="main">∨</span> <span class="main">¬</span> <span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span> <span class="main">∨</span> <span class="main">¬</span> <span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span>  <span class="main">≠</span> <span class="main">{}</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">.⊥.</span> <span class="free">ψ</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> j<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">.⊥.</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> k<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> d emptyrem2taut valid_conj_PL <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> Supraclassical_logic.conjI_PL Supraclassical_logic_axioms d<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> 
      <span class="keyword1"><span class="command">using</span></span> remainder_conj<span class="main">[</span><span class="operator">OF</span> a k<span class="main">]</span> b h i j rel_sel <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A transitively relational meet contraction respect conjuctive overlap.›</span></span>
<span class="keyword1" id="AGM_Contraction-trmc_conj_overlap"><span class="command">lemma</span></span> trmc_conj_overlap<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span></sub><span class="hidden">⇙</span> <span class="free">ψ</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> mc <span class="keyword1"><span class="command">using</span></span> rel_sel_conj_overlap <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A transitively relational selection function respect conjuctive inclusion›</span></span>
<span class="keyword1" id="AGM_Contraction-rel_sel_conj_inclusion"><span class="command">lemma</span></span> rel_sel_conj_inclusion<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span> <span class="free">K</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">)</span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span> <span class="free">K</span> <span class="free">φ</span> <span class="main">⊆</span> <span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span> <span class="free">K</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">intro</span> subsetI<span class="main">)</span> 
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">B</span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span> <span class="free">K</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">)</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∈</span> <span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span> <span class="free">K</span> <span class="free">φ</span>›</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∈</span> <span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span> <span class="free">K</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span>›</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="free">φ</span> <span class="main">∨</span> <span class="main"><span class="free">⊩</span></span> <span class="free">ψ</span> <span class="main">∨</span> <span class="main">¬</span> <span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span> <span class="main">∨</span> <span class="main">¬</span> <span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">ψ</span>›</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="free">φ</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> 
      <span class="keyword1"><span class="command">using</span></span> b taut2emptyrem <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊩</span></span> <span class="free">ψ</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">φ</span><span class="main">}</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Cn_conj_bis Cn_same validD_L<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> 
      <span class="keyword1"><span class="command">using</span></span> a c extensional_selection <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>  
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">φ</span> <span class="main">∉</span> <span class="free">Cn</span> <span class="free">K</span>›</span></span>
    <span class="keyword1"><span class="command">with</span></span> d <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Int_emptyI Tarskian_logic.nonconsequence_remainder Tarskian_logic_axioms a b c idempotency_L 
                inf_bot_right is_selection nonempty_selection singletonD subset_singletonD<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">ψ</span> <span class="main">∉</span> <span class="free">Cn</span> <span class="free">K</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> e<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main">∉</span> <span class="free">Cn</span> <span class="free">K</span>›</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> Supraclassical_logic.conjE2_PL Supraclassical_logic_axioms<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> f<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span> <span class="free">K</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="free">K</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Tarskian_logic.nonconsequence_remainder Tarskian_logic_axioms a insert_not_empty is_selection 
                nonempty_selection subset_singletonD<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> b <span class="keyword1"><span class="command">have</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="free">K</span><span class="main">}</span>›</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> nonconsequence_remainder<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> <span class="keyword1"><span class="command">using</span></span> rem <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> d f <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> a c is_selection <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main"><span class="free">⊩</span></span> <span class="free">φ</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> e<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main"><span class="free">⊩</span></span> <span class="free">ψ</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> f<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">φ</span> <span class="main">∈</span> <span class="free">Cn</span> <span class="free">K</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">ψ</span> <span class="main">∈</span> <span class="free">Cn</span> <span class="free">K</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span>  <span class="main">≠</span> <span class="main">{}</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">.⊥.</span> <span class="free">ψ</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> j<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">.⊥.</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> k<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> e d emptyrem2taut valid_conj_PL <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> Supraclassical_logic.conjI_PL Supraclassical_logic_axioms f g<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> o<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">⟹</span> <span class="skolem">B</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">B</span>
      <span class="keyword1"><span class="command">using</span></span> a k remainder_conj <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> b <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B'</span></span> <span class="keyword2"><span class="keyword">where</span></span> l<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B'</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> m<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">C</span><span class="main">∈</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span><span class="main">.</span> <span class="bound">C</span> ≼<span class="hidden">⇘</span><sub><span class="free">K</span></sub><span class="hidden">⇙</span> <span class="skolem">B'</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> n<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">φ</span> <span class="main">∉</span> <span class="skolem">B'</span>›</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>mc rel_sel j<span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> assumption_L rem <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">have</span></span> p<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B'</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span>›</span></span> 
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> rem<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> Supraclassical_logic.conjE1_PL Supraclassical_logic_axioms 
                Tarskian_logic.rem Tarskian_logic_axioms a l mem_Collect_eq n rem_closure<span class="main">)</span>
    <span class="keyword1"><span class="command">from</span></span> c <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> 
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>rel_sel o j h<span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> m p trans_rel a <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A transitively relational meet contraction respect conjuctive inclusion›</span></span>
<span class="keyword1" id="AGM_Contraction-trmc_conj_inclusion"><span class="command">lemma</span></span> trmc_conj_inclusion<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">φ</span> <span class="main">∉</span> <span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">φ</span> <span class="main">∉</span> <span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∈</span> <span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span> <span class="free">K</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="skolem">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span>›</span></span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>mc<span class="main">)</span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> b emptyrem2taut is_selection pmc_tautology rem_closure subset_iff validD_L valid_conj_PL<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∈</span> <span class="main">(</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> remainder_recovery_bis<span class="main">[</span><span class="operator">OF</span> a _ d<span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">‹<span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span>›</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> hide_lams<span class="main"><span class="main">)</span></span> a conj_PL emptyrem2taut insert_not_empty is_selection 
                                    nonconsequence_remainder subsetD taut2emptyrem<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> c <span class="keyword1"><span class="command">have</span></span> e<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span> <span class="free">K</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span><span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">)</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span></sub><span class="hidden">⇙</span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> mc <span class="keyword1"><span class="command">using</span></span> rel_sel_conj_inclusion<span class="main">[</span><span class="operator">OF</span> a e<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹As a transitively relational meet contraction has been proven to respect all postulates of AGM full contraction 
the equivalence between the both are straightforward›</span></span>
<span class="keyword1"><span class="command">sublocale</span></span> AGM_FullContraction <span class="keyword2"><span class="keyword">where</span></span> contraction <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">λ</span><span class="bound">A</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">A</span>  ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span></sub><span class="hidden">⇙</span> <span class="bound">φ</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> trmc_conj_inclusion trmc_conj_overlap
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">unfold_locales</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>

                                    
<span class="keyword1"><span class="command">locale</span></span> AGMFC_SC <span class="main">=</span> AGM_FullContraction <span class="main">+</span> AGMC_SC 

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹An AGM relation is defined as ?›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AGM_relation</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span> set <span class="main">⇒</span> bool›</span></span> 
  <span class="keyword2"><span class="keyword">where</span></span> AGM_rel<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">AGM_relation</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="free"><span class="bound"><span class="entity">K</span></span></span> <span class="free"><span class="bound"><span class="entity">B</span></span></span>  <span class="main">≡</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">K</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">K</span></span></span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span>  <span class="main">(</span><span class="main">∃</span><span class="bound">φ</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">K</span></span></span> <span class="main"><span class="free">⊢</span></span> <span class="bound">φ</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">K</span></span></span> <span class="main">.⊥.</span> <span class="bound">φ</span><span class="main">)</span>
                                                            <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound">φ</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">K</span></span></span> <span class="main"><span class="free">⊢</span></span> <span class="bound">φ</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">K</span></span></span> <span class="main">.⊥.</span> <span class="bound">φ</span> <span class="main">∧</span>  <span class="free"><span class="bound"><span class="entity">K</span></span></span> <span class="main"><span class="free">÷</span></span> <span class="bound">φ</span> <span class="main">⊆</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span>
                                                            <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">φ</span><span class="main">.</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">K</span></span></span> <span class="main"><span class="free">⊢</span></span> <span class="bound">φ</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">K</span></span></span> <span class="main">.⊥.</span> <span class="bound">φ</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">K</span></span></span> <span class="main">.⊥.</span> <span class="bound">φ</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">K</span></span></span> <span class="main"><span class="free">÷</span></span> <span class="bound">φ</span> <span class="main">⊆</span> <span class="free"><span class="bound"><span class="entity">C</span></span></span><span class="main">)</span> <span class="main">⟶</span> <span class="free"><span class="bound"><span class="entity">K</span></span></span> <span class="main"><span class="free">÷</span></span> <span class="bound">φ</span> <span class="main">⊆</span> <span class="free"><span class="bound"><span class="entity">B</span></span></span><span class="main">)</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹An AGM relational selection is defined as a function that return <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> if the remainders of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹K .⊥. φ›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is empty and
the best element of the remainders according to an AGM relation›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AGM_relational_selection</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span>  <span class="main">⇒</span> <span class="tfree">'a</span> set set›</span></span> <span class="main">(</span><span class="quoted">‹<span class="keyword1">γ<span class="hidden">⇩</span><sub>A</sub><span class="hidden">⇩</span><sub>G</sub><span class="hidden">⇩</span><sub>M</sub><span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span>›</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> AGM_rel_sel<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>A</sub><span class="hidden">⇩</span><sub>G</sub><span class="hidden">⇩</span><sub>M</sub><span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span></span>  <span class="free"><span class="bound"><span class="entity">K</span></span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">≡</span> <span class="keyword1">if</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">K</span></span></span> <span class="main">.⊥.</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span> 
                                   <span class="keyword1">then</span> <span class="main">{</span><span class="free"><span class="bound"><span class="entity">K</span></span></span><span class="main">}</span> 
                                   <span class="keyword1">else</span> <span class="main">{</span><span class="bound">B</span><span class="main">.</span> <span class="bound">B</span><span class="main">∈</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">K</span></span></span> <span class="main">.⊥.</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">C</span><span class="main">∈</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">K</span></span></span> <span class="main">.⊥.</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span><span class="main">.</span> AGM_relation <span class="bound">C</span> <span class="free"><span class="bound"><span class="entity">K</span></span></span> <span class="bound">B</span><span class="main">)</span><span class="main">}</span>›</span></span>

<span class="keyword1" id="AGM_Contraction-AGM_rel_sel_completion"><span class="command">lemma</span></span> AGM_rel_sel_completion<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="keyword1">γ<span class="hidden">⇩</span><sub>A</sub><span class="hidden">⇩</span><sub>G</sub><span class="hidden">⇩</span><sub>M</sub><span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span> <span class="free">K</span> <span class="free">φ</span> <span class="main">=</span> <span class="main">*</span> <span class="keyword1">γ<span class="hidden">⇩</span><sub>A</sub><span class="hidden">⇩</span><sub>G</sub><span class="hidden">⇩</span><sub>M</sub></span> <span class="free">K</span> <span class="free">φ</span>›</span></span> 
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">unfold</span> AGM_rel_sel<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>completion_def <span class="quasi_keyword">split</span><span class="main"><span class="main">:</span></span> if_splits<span class="main">)</span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>AGM_sel<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">S</span> <span class="skolem">B</span> <span class="skolem">C</span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">S</span> <span class="main">∈</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">.⊥.</span> <span class="free">φ</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∈</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">.⊥.</span> <span class="free">φ</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">⋂</span> <span class="main">{</span><span class="bound"><span class="bound">B</span></span> <span class="main">∈</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">.</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span> <span class="main">⊆</span> <span class="bound">B</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">B</span>›</span></span> 
     <span class="keyword2"><span class="keyword">and</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">.⊥.</span> <span class="free">φ</span>›</span></span>
  <span class="keyword1"><span class="command">hence</span></span> e<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">φ</span> <span class="main">∉</span>  <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span>›</span></span> 
    <span class="keyword1"><span class="command">using</span></span> Tarskian_logic.taut2emptyrem Tarskian_logic_axioms contract_success <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹AGM_relation <span class="skolem">C</span> <span class="main">(</span><span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">)</span> <span class="skolem">B</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹<span class="free">φ</span> <span class="main">∈</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">ψ</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span> <span class="free">A</span> <span class="main"><span class="free">÷</span></span> <span class="skolem">ψ</span> <span class="main">⊆</span> <span class="skolem">C</span>›</span></span> 
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span> <span class="free">A</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span> <span class="free">A</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span>›</span></span> 
        <span class="keyword1"><span class="command">using</span></span> contract_conj_inclusion_variant<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="free">φ</span></span> <span class="quoted"><span class="skolem">ψ</span></span><span class="main">]</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> assumption_L contract_conj_inclusion d mem_Collect_eq rem subset_iff<span class="main">)</span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> f <span class="main">=</span> this
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">ψ</span> <span class="skolem">φ'</span>
      <span class="keyword3"><span class="command">assume</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">ψ</span> <span class="main">∈</span> <span class="free">Cn</span> <span class="free">A</span> <span class="main"><span class="free">÷</span></span> <span class="skolem">φ'</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∈</span> <span class="free">Cn</span> <span class="free">A</span> <span class="main">.⊥.</span> <span class="skolem">φ'</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> j<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">Cn</span> <span class="free">A</span> <span class="main"><span class="free">÷</span></span> <span class="skolem">φ'</span> <span class="main">⊆</span> <span class="skolem">C</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> i<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">ψ</span> <span class="main">∉</span> <span class="skolem">B</span>›</span></span> 
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">φ'</span> <span class="main"><span class="free">.∨.</span></span> <span class="skolem">ψ</span> <span class="main">∈</span> <span class="free">Cn</span> <span class="free">A</span> <span class="main"><span class="free">÷</span></span> <span class="skolem">φ'</span>›</span></span>
        <span class="keyword1"><span class="command">using</span></span> Supraclassical_logic.disjI2_PL Supraclassical_logic_axioms contract_closure <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
      <span class="keyword1"><span class="command">hence</span></span> k<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">φ'</span> <span class="main"><span class="free">.∨.</span></span> <span class="skolem">ψ</span> <span class="main">∈</span> <span class="free">Cn</span> <span class="free">A</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span>›</span></span> 
        <span class="keyword1"><span class="command">using</span></span> contract_conj_overlap_variant<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="free">A</span></span> <span class="quoted"><span class="skolem">φ'</span></span> <span class="quoted"><span class="free">φ</span></span><span class="main">]</span> f<span class="main">[</span><span class="operator">OF</span> j<span class="main">]</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> IntI Supraclassical_logic.disjI1_PL Supraclassical_logic_axioms conj_com_Cn 
                  contract_extensionality inclusion_L singletonI subsetD<span class="main">)</span> 
      <span class="keyword1"><span class="command">hence</span></span> l<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">Cn</span> <span class="free">A</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span> <span class="main">⊆</span> <span class="skolem">B</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> c <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> k l <span class="keyword1"><span class="command">have</span></span> m<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">φ'</span> <span class="main"><span class="free">.∨.</span></span> <span class="skolem">ψ</span> <span class="main">∈</span> <span class="skolem">B</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> n<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">=</span><span class="free">Cn</span><span class="main">(</span><span class="skolem">B</span><span class="main">)</span>›</span></span> 
        <span class="keyword1"><span class="command">using</span></span> b rem_closure <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="main"><span class="keyword3">+</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">ψ</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="skolem">φ'</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> g h i
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>rem<span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> contract_inclusion insertI1 insert_subsetI psubsetI subsetD subset_insertI<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> n m <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main"><span class="free">⊢</span></span> <span class="skolem">φ'</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Cn_equiv assumption_L disjE_PL disj_com equiv_PL imp_PL<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> h <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> 
        <span class="keyword1"><span class="command">using</span></span> assumption_L rem <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> g <span class="main">=</span> this
    <span class="keyword1"><span class="command">with</span></span> True <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">unfold</span> AGM_rel<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule_tac</span> disjI2<span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> d b c <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>AGM_rel idempotency_L <span class="quasi_keyword">del</span><span class="main"><span class="main">:</span></span>subsetI<span class="main">)</span> <span class="operator">blast</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AGM_rel b d idempotency_L infer_def nonconsequence_remainder singletonD<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">S</span> <span class="skolem">B</span> <span class="skolem">ψ</span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">S</span> <span class="main">∈</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">.⊥.</span> <span class="free">φ</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∈</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">.⊥.</span> <span class="free">φ</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">C</span><span class="main">∈</span><span class="free">Cn</span> <span class="free">A</span> <span class="main">.⊥.</span> <span class="free">φ</span><span class="main">.</span> AGM_relation <span class="bound">C</span> <span class="main">(</span><span class="free">Cn</span> <span class="free">A</span><span class="main">)</span> <span class="skolem">B</span>›</span></span> 
     <span class="keyword2"><span class="keyword">and</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">C'</span><span class="main">.</span> <span class="bound">C'</span> <span class="main">∈</span> <span class="free">Cn</span> <span class="free">A</span> <span class="main">.⊥.</span> <span class="free">φ</span> <span class="main">∧</span> <span class="free">Cn</span> <span class="free">A</span> <span class="main"><span class="free">÷</span></span> <span class="free">φ</span> <span class="main">⊆</span> <span class="bound">C'</span> <span class="main">⟶</span> <span class="skolem">ψ</span> <span class="main">∈</span> <span class="bound">C'</span>›</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ψ</span> <span class="main">∈</span> <span class="skolem">B</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> AGM_rel
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> AGM_sel empty_Collect_eq insert_Diff insert_not_empty 
              nonconsequence_remainder nonempty_selection singletonD<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A transitively relational selection and an AGM relation is a transitively relational meet contraction›</span></span>
<span class="keyword1"><span class="command">sublocale</span></span> TransitivelyRelationalMeetContraction <span class="keyword2"><span class="keyword">where</span></span> relation <span class="main">=</span> <span class="quoted">AGM_relation</span> <span class="keyword2"><span class="keyword">and</span></span> rel_sel <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="keyword1">γ<span class="hidden">⇩</span><sub>A</sub><span class="hidden">⇩</span><sub>G</sub><span class="hidden">⇩</span><sub>M</sub><span class="hidden">⇩</span><sub>T</sub><span class="hidden">⇩</span><sub>R</sub></span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">no_asm</span><span class="main"><span class="main">)</span></span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span>atomize_eq<span class="main"><span class="keyword3">,</span></span> <span class="operator">goal_cases</span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> a<span class="main">:</span><span class="main">(</span>1 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">C</span> <span class="skolem">B'</span> <span class="skolem">B</span><span class="main">)</span> <span class="comment1">― ‹Very difficult proof requires litterature and high automation of isabelle!›</span>
  <span class="keyword1"><span class="command">from</span></span> a<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> AGM_rel <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">elim</span> disjE conjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">simp_all</span><span class="main">)</span> 
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">intro</span> disjI2 allI impI<span class="main"><span class="keyword3">,</span></span> <span class="operator">elim</span> exE conjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">goal_cases</span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>1 <span class="skolem">ψ</span> _ _ <span class="skolem">φ</span><span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∈</span> <span class="skolem">K</span> <span class="main">.⊥.</span> <span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B'</span> <span class="main">∈</span> <span class="skolem">K</span> <span class="main">.⊥.</span> <span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> <span class="skolem">K</span> <span class="main">.⊥.</span> <span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> remainder_conj<span class="main">[</span><span class="operator">OF</span> a<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">]</span> 1 conjI_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> e<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">K</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">B</span>›</span></span> 
      <span class="keyword1"><span class="command">using</span></span> contract_conj_inclusion_variant<span class="main">[</span><span class="operator">OF</span> a<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="skolem">φ</span></span>  <span class="quoted"><span class="skolem">ψ</span></span><span class="main">]</span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> <span class="quoted">"1"</span><span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> <span class="quoted">"1"</span><span class="main"><span class="main">(</span></span>12<span class="main"><span class="main">)</span></span> <span class="quoted">"1"</span><span class="main"><span class="main">(</span></span>16<span class="main"><span class="main">)</span></span> <span class="quoted">"1"</span><span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> <span class="quoted">"1"</span><span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> <span class="quoted">"1"</span><span class="main"><span class="main">(</span></span>8<span class="main"><span class="main">)</span></span> Supraclassical_logic.conj_PL 
                Supraclassical_logic_axioms dual_order.trans<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">χ</span>
      <span class="keyword3"><span class="command">assume</span></span> f<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">χ</span> <span class="main">∈</span> <span class="skolem">K</span> <span class="main"><span class="free">÷</span></span> <span class="skolem">ψ</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ψ</span> <span class="main"><span class="free">.∨.</span></span> <span class="skolem">χ</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">K</span> <span class="main"><span class="free">÷</span></span> <span class="skolem">ψ</span><span class="main">)</span> <span class="main">∩</span> <span class="free">Cn</span> <span class="main">{</span><span class="skolem">ψ</span><span class="main">}</span>›</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Int_iff Supraclassical_logic.disjI1_PL Supraclassical_logic.disjI2_PL Supraclassical_logic_axioms 
                  f a<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> contract_closure in_mono inclusion_L singletonI<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">ψ</span> <span class="main"><span class="free">.∨.</span></span> <span class="skolem">χ</span> <span class="main">∈</span> <span class="skolem">B</span>›</span></span> 
        <span class="keyword1"><span class="command">using</span></span> contract_conj_overlap_variant<span class="main">[</span><span class="operator">OF</span> a<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="skolem">ψ</span></span><span class="main">]</span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AGM_Contraction.contract_extensionality AGM_Contraction_axioms a<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> conj_com_Cn e in_mono<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ψ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">χ</span> <span class="main">∈</span> <span class="skolem">B</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> a<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> <span class="quoted">"1"</span><span class="main"><span class="main">(</span></span>10<span class="main"><span class="main">)</span></span> <span class="quoted">"1"</span><span class="main"><span class="main">(</span></span>15<span class="main"><span class="main">)</span></span> <span class="quoted">"1"</span><span class="main"><span class="main">(</span></span>16<span class="main"><span class="main">)</span></span> assumption_L f in_mono infer_def rem_closure rem_inclusion remainder_recovery<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> g <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">χ</span> <span class="main">∈</span> <span class="skolem">B</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> 1<span class="main"><span class="main">(</span></span>15<span class="main"><span class="main">)</span></span> a<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> disjE_PL infer_def order_refl rem_closure validD_L valid_Cn_imp<span class="main">)</span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>2 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">φ</span><span class="main">)</span> 
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">*</span> <span class="keyword1">γ<span class="hidden">⇩</span><sub>A</sub><span class="hidden">⇩</span><sub>G</sub><span class="hidden">⇩</span><sub>M</sub></span>  <span class="skolem">K</span> <span class="skolem">φ</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span> 
    <span class="keyword1"><span class="command">using</span></span> nonempty_selection<span class="main">[</span><span class="operator">OF</span> 2<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="skolem">φ</span></span><span class="main">]</span> selection_completion<span class="main">[</span><span class="operator">OF</span> 2<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="skolem">φ</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> AGM_rel_sel_completion<span class="main">[</span><span class="operator">OF</span> 2<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="skolem">φ</span></span><span class="main">]</span> AGM_rel_sel 2<span class="main">(</span>1<span class="main">,</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>3 <span class="skolem">K</span> <span class="skolem">φ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">using</span></span> AGM_rel_sel_completion AGM_rel_sel <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span> 

<span class="comment1">― ‹ça marche tout seul! ==&gt; Je ne vois pas où sont utilisés ces lemmas›</span>
<span class="keyword1"><span class="command">lemmas</span></span> fullcontraction_is_pmc <span class="main">=</span> contraction_is_pmc
<span class="keyword1"><span class="command">lemmas</span></span> fullcontraction_is_trmc <span class="main">=</span> contraction_with_completion

<span class="keyword2"><span class="keyword">end</span></span>


<span class="keyword1"><span class="command">locale</span></span> FMC_SC <span class="main">=</span> FullMeetContraction <span class="main">+</span> TRMC_SC

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1" id="AGM_Contraction-full_meet_weak1"><span class="command">lemma</span></span> full_meet_weak1<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>F</sub><span class="hidden">⇩</span><sub>C</sub></span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span><span class="main">)</span> <span class="main">=</span> <span class="free">K</span> <span class="main">∩</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="free">φ</span><span class="main">}</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">intro</span> subset_antisym Int_greatest<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span>›</span></span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹ <span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>F</sub><span class="hidden">⇩</span><sub>C</sub></span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">K</span>›</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Inf_less_eq full_sel mc rem_inclusion<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> 
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span>›</span></span>   
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>F</sub><span class="hidden">⇩</span><sub>C</sub></span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="free">φ</span><span class="main">}</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">ψ</span>
    <span class="keyword3"><span class="command">assume</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">ψ</span> <span class="main">∈</span> <span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>F</sub><span class="hidden">⇩</span><sub>C</sub></span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="free">φ</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="skolem">ψ</span>›</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="skolem">ψ</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Un_insert_right insert_is_Un not_PL notnot_PL<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="main">{</span><span class="free">φ</span> <span class="main"><span class="free">.∨.</span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">ψ</span><span class="main">}</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assumption_L disjI2_PL singleton_iff transitivity2_L<span class="main">)</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="free">φ</span> <span class="main"><span class="free">.∨.</span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">ψ</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">B</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> e<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> a b disjI1_PL empty_subsetI idempotency_L infer_def insert_subset upper_remainder<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> f<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="skolem">ψ</span> <span class="main">∈</span> <span class="skolem">B</span>›</span></span> 
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> CollectD assumption_L insert_subset disj_notE_PL rem<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="skolem">ψ</span> <span class="main">∈</span> <span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>F</sub><span class="hidden">⇩</span><sub>C</sub></span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">using</span></span> e mc full_sel <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ψ</span> <span class="main">∈</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="free">φ</span><span class="main">}</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> c infer_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span> 
<span class="keyword1"><span class="command">next</span></span> 
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span>›</span></span>   
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">∩</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="free">φ</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>F</sub><span class="hidden">⇩</span><sub>C</sub></span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">safe</span><span class="main">)</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">ψ</span>
    <span class="keyword3"><span class="command">assume</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">ψ</span> <span class="main">∈</span> <span class="free">K</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> d<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">ψ</span> <span class="main">∈</span> <span class="free">Cn</span> <span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="free">φ</span><span class="main">}</span>›</span></span>
    <span class="keyword1"><span class="command">have</span></span> e<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main"><span class="free">⊢</span></span> <span class="main"><span class="free">.¬</span></span> <span class="free">φ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">ψ</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">B</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> d validD_L valid_imp_PL<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">B</span>
      <span class="keyword3"><span class="command">assume</span></span> f<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">∈</span> <span class="free">K</span> <span class="main">.⊥.</span> <span class="free">φ</span>›</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">ψ</span>›</span></span>
        <span class="keyword1"><span class="command">using</span></span> a assumption_L c remainder_recovery <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> f<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main"><span class="free">⊢</span></span> <span class="skolem">ψ</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> d e
        <span class="keyword1"><span class="command">using</span></span> disjE_PL ex_mid_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ψ</span> <span class="main">∈</span> <span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>F</sub><span class="hidden">⇩</span><sub>C</sub></span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span>mc c full_sel<span class="main">)</span>
      <span class="keyword1"><span class="command">using</span></span> a rem_closure <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1" id="AGM_Contraction-full_meet_weak2"><span class="command">lemma</span></span> full_meet_weak2<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free">⊢</span></span> <span class="free">φ</span> <span class="main">⟹</span> <span class="free">Cn</span><span class="main">(</span><span class="main">(</span><span class="free">K</span> ÷<span class="hidden">⇘</span><sub><span class="keyword1"><span class="free">γ<span class="hidden">⇩</span><sub>F</sub><span class="hidden">⇩</span><sub>C</sub></span></span></sub><span class="hidden">⇙</span> <span class="free">φ</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="free">φ</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="free">φ</span><span class="main">}</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> full_meet_weak1 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Cn_union idempotency_L inf.cobounded2 sup.absorb_iff2 sup_commute<span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</div><div id="AGM_Revision">
<div class="head">
<h1>Theory AGM_Revision</h1>
</div>
<pre class="source"><span class="comment1">(*&lt;*)</span>
<span class="comment1">―‹ ******************************************************************** 
 * Project         : AGM Theory
 * Version         : 1.0
 *
 * Authors         : Valentin Fouillard, Safouan Taha, Frederic Boulanger
                     and Nicolas Sabouret
 *
 * This file       : AGM revision
 *
 * Copyright (c) 2021 Université Paris Saclay, France
 *
 ******************************************************************************›</span>

<span class="keyword1"><span class="command">theory</span></span> AGM_Revision

<span class="keyword2"><span class="keyword">imports</span></span> <a href="#AGM_Contraction">AGM_Contraction</a>

<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Revisions›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The third operator of belief change introduce by the AGM framework is the revision. In revision a sentence 
<span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is added to the belief set  <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> in such a way that other sentences 
of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> are removed if needed so that <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is consistent›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹AGM revision postulates›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The revision operator is denoted by the symbol <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹<span class="hidden">❙</span><b>*</b>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and respect the following conditions :
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹revis_closure›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : a belief set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> revised by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> should be logically closed
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹revis_inclusion›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : a belief set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> revised by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> should be a subset of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> expanded by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹revis_vacuity›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : if <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹¬φ›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is not in <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> then the revision of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is equivalent of the expansion of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹revis_success›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : a belief set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> revised by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> should contain <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹revis_extensionality›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> :  Extensionality guarantees that the logic of contraction is extensional in the sense of allowing logically equivalent sentences to be freely substituted for each other
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹revis_consistency›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : a belief set <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> revised by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is consistent if <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is consistent›</span></span>
<span class="keyword1"><span class="command">locale</span></span> AGM_Revision <span class="main">=</span> Supraclassical_logic <span class="main">+</span>

<span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">revision</span><span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> set <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> set›</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">‹<span class="keyword1"><span class="keyword1"><span class="hidden">❙</span><b>*</b></span></span>›</span> 55<span class="main">)</span>

<span class="keyword2"><span class="keyword">assumes</span></span> revis_closure<span class="main">:</span>        <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="free">φ</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="free">φ</span><span class="main">)</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> revis_inclusion<span class="main">:</span>      <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="free">φ</span> <span class="main">⊆</span> <span class="free">K</span> <span class="main"><span class="free">⊕</span></span> <span class="free">φ</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> revis_vacuity<span class="main">:</span>        <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="main"><span class="free">.¬</span></span> <span class="free">φ</span> <span class="main">∉</span> <span class="free">K</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free">⊕</span></span> <span class="free">φ</span> <span class="main">⊆</span> <span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="free">φ</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> revis_success<span class="main">:</span>        <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">φ</span> <span class="main">∈</span> <span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="free">φ</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> revis_extensionality<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">φ</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="free">ψ</span><span class="main">}</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="free">φ</span> <span class="main">=</span> <span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="free">ψ</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> revis_consistency<span class="main">:</span>    <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="main"><span class="free">.¬</span></span> <span class="free">φ</span> <span class="main">∉</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{}</span><span class="main">)</span>  <span class="main">⟹</span> <span class="main"><span class="free">⊥</span></span> <span class="main">∉</span> <span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="free">φ</span>›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A full revision is defined by two more postulates :
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹revis_superexpansion›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : An element of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹ K <span class="hidden">❙</span><b>*</b> (φ .∧. ψ)›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is also an element of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> revised by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> and expanded by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">ψ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
<span class="antiquoted"><span class="antiquoted">▪</span></span> <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹revis_subexpansion›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> : An element of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹(K <span class="hidden">❙</span><b>*</b> φ) ⊕ ψ›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> is also an element of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> revised by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹φ .∧. ψ›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> if <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹(K <span class="hidden">❙</span><b>*</b> φ)›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> do not imply <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹¬ ψ›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
›</span></span>
<span class="keyword1"><span class="command">locale</span></span> AGM_FullRevision <span class="main">=</span> AGM_Revision <span class="main">+</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> revis_superexpansion<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="free">φ</span><span class="main">)</span> <span class="main"><span class="free">⊕</span></span> <span class="free">ψ</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> revis_subexpansion<span class="main">:</span>   <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="main"><span class="free">.¬</span></span> <span class="free">ψ</span> <span class="main">∉</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="free">φ</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="free">φ</span><span class="main">)</span> <span class="main"><span class="free">⊕</span></span> <span class="free">ψ</span> <span class="main">⊆</span> <span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="free">ψ</span><span class="main">)</span>›</span></span>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="comment1">― ‹important lemmas/corollaries that can replace the previous assumptions›</span>
<span class="keyword1"><span class="command">corollary</span></span> revis_superexpansion_ext <span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="free">φ</span><span class="main">)</span> <span class="main">∩</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="free">ψ</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">ψ</span><span class="main">)</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">intro</span> subsetI<span class="main"><span class="keyword3">,</span></span> <span class="operator">elim</span> IntE<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">χ</span>
  <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">χ</span> <span class="main">∈</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="free">φ</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">χ</span> <span class="main">∈</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="free">ψ</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹ <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main">(</span><span class="skolem">φ'</span> <span class="main"><span class="free">.∨.</span></span> <span class="skolem">ψ'</span><span class="main">)</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">φ'</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="skolem">φ'</span><span class="main">}</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">φ'</span> <span class="skolem">ψ'</span> 
    <span class="keyword1"><span class="command">using</span></span> conj_superexpansion2 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Cn_same<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="skolem">φ'</span> <span class="main">⊆</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="main">(</span><span class="skolem">φ'</span> <span class="main"><span class="free">.∨.</span></span> <span class="skolem">ψ'</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">⊕</span></span> <span class="skolem">φ'</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">φ'</span> <span class="skolem">ψ'</span>
    <span class="keyword1"><span class="command">using</span></span> revis_superexpansion<span class="main">[</span><span class="operator">OF</span> a<span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">‹<span class="skolem">φ'</span> <span class="main"><span class="free">.∨.</span></span> <span class="skolem">ψ'</span>›</span></span> <span class="quoted"><span class="skolem">φ'</span></span><span class="main">]</span> revis_extensionality a <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">φ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">χ</span> <span class="main">∈</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">ψ</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="free">ψ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">χ</span> <span class="main">∈</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">ψ</span><span class="main">)</span><span class="main">)</span>›</span></span> 
    <span class="keyword1"><span class="command">using</span></span> d<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">φ</span></span> <span class="quoted"><span class="free">ψ</span></span><span class="main">]</span> d<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="free">ψ</span></span> <span class="quoted"><span class="free">φ</span></span><span class="main">]</span> revis_extensionality<span class="main">[</span><span class="operator">OF</span> a disj_com_Cn<span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="free">ψ</span></span> <span class="quoted"><span class="free">φ</span></span><span class="main">]</span>  
    <span class="keyword1"><span class="command">using</span></span> imp_PL a b c expansion_def revis_closure <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span>  c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">χ</span> <span class="main">∈</span> <span class="main">(</span><span class="free">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="main">(</span><span class="free">φ</span> <span class="main"><span class="free">.∨.</span></span> <span class="free">ψ</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> disjE_PL a revis_closure revis_success <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Relation of AGM revision and AGM contraction ›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The AGM contraction of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> can be defined as the AGM revision of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹¬φ›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
intersect with <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> (to remove <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹¬φ›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> from K revised). This definition is known as Harper identity <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">cite</span></span> "Harper1976"<span class="antiquote"><span class="antiquote">}</span></span></span></span>›</span></span>
<span class="keyword1"><span class="command">sublocale</span></span> AGM_Revision <span class="main">⊆</span> AGM_Contraction <span class="keyword2"><span class="keyword">where</span></span> contraction <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">λ</span><span class="bound">K</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">K</span> <span class="main">∩</span> <span class="main">(</span><span class="bound">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="main"><span class="free">.¬</span></span> <span class="bound">φ</span><span class="main">)</span>›</span></span> 
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">goal_cases</span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> closure<span class="main">:</span><span class="main">(</span>1 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">φ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Cn_inter revis_closure<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> inclusion<span class="main">:</span><span class="main">(</span>2 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">φ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> vacuity<span class="main">:</span><span class="main">(</span>3 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">φ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">)</span> <span class="main">∉</span> <span class="skolem">K</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> absurd_PL infer_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">K</span> <span class="main">⊆</span> <span class="main">(</span><span class="skolem">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">)</span>›</span></span> 
    <span class="keyword1"><span class="command">using</span></span> revis_vacuity<span class="main">[</span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> φ<span class="main"><span class="main">=</span></span><span class="quoted"><span class="quoted">‹<span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span>›</span></span><span class="main">]</span> expansion_def inclusion_L vacuity<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> success<span class="main">:</span><span class="main">(</span>4 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">φ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">)</span> <span class="main">∉</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{}</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> infer_def notnot_PL <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">hence</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main"><span class="free">⊥</span></span> <span class="main">∉</span> <span class="skolem">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> revis_consistency success<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span> <span class="main">∈</span>  <span class="skolem">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">)</span>›</span></span>      
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> revis_success success<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> a <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">φ</span> <span class="main">∉</span>  <span class="skolem">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> infer_def non_consistency revis_closure success<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> recovery<span class="main">:</span><span class="main">(</span>5 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">φ</span><span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> 
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">ψ</span>
    <span class="keyword3"><span class="command">assume</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">ψ</span> <span class="main">∈</span> <span class="skolem">K</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">φ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">ψ</span> <span class="main">∈</span> <span class="skolem">K</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> impI2 recovery <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">.¬</span></span> <span class="skolem">ψ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span> <span class="main">∈</span> <span class="skolem">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> impI2 recovery revis_closure revis_success <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">φ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">ψ</span> <span class="main">∈</span> <span class="skolem">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> imp_contrapos recovery revis_closure <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword1"><span class="command">with</span></span> b <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ψ</span> <span class="main">∈</span> <span class="free">Cn</span> <span class="main">(</span><span class="skolem">K</span> <span class="main">∩</span> <span class="main">(</span><span class="skolem">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">φ</span><span class="main">}</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> Int_iff Supraclassical_logic.imp_PL Supraclassical_logic_axioms inclusion_L subsetD<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> extensionality<span class="main">:</span><span class="main">(</span>6 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">φ</span> <span class="skolem">ψ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="skolem">ψ</span><span class="main">}</span><span class="main">)</span>›</span></span> 
    <span class="keyword1"><span class="command">using</span></span>  equiv_negation<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">‹<span class="main">{}</span>›</span></span> <span class="quoted"><span class="skolem">φ</span></span> <span class="quoted"><span class="skolem">ψ</span></span><span class="main">]</span> valid_Cn_equiv valid_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">ψ</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> extensionality<span class="main">(</span>1<span class="main">)</span> revis_extensionality <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">locale</span></span> AGMC_S <span class="main">=</span> AGM_Contraction <span class="main">+</span> Supraclassical_logic

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The AGM revision of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> can be defined as the AGM contraction of <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">K</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span> by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">text</span></span> <span class="raw_text"><span class="raw_text">‹¬φ›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>
followed by an expansion by <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">term</span></span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="free">φ</span></span>›</span></span><span class="antiquote"><span class="antiquote">}</span></span></span></span>. This definition is known as Levi identity <span class="antiquoted"><span class="antiquoted"><span class="antiquote"><span class="antiquote">@{</span></span><span class="operator"><span class="operator">cite</span></span> "Levi1977SubjunctivesDA"<span class="antiquote"><span class="antiquote">}</span></span></span></span>.›</span></span>
<span class="keyword1"><span class="command">sublocale</span></span> AGMC_S <span class="main">⊆</span> AGM_Revision <span class="keyword2"><span class="keyword">where</span></span> revision <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">λ</span><span class="bound">K</span> <span class="bound">φ</span><span class="main">.</span> <span class="main">(</span><span class="bound">K</span> <span class="main"><span class="free">÷</span></span> <span class="main"><span class="free">.¬</span></span> <span class="bound">φ</span><span class="main">)</span> <span class="main"><span class="free">⊕</span></span> <span class="bound">φ</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">goal_cases</span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> closure<span class="main">:</span><span class="main">(</span>1 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">φ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> expansion_def idempotency_L<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> inclusion<span class="main">:</span><span class="main">(</span>2 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">φ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">K</span> <span class="main"><span class="free">÷</span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span> <span class="main">⊆</span> <span class="skolem">K</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">φ</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> contract_inclusion inclusion <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> expansion_def monotonicity_L<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> vacuity<span class="main">:</span><span class="main">(</span>3 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">φ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> contract_vacuity expansion_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> success<span class="main">:</span><span class="main">(</span>4 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">φ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> assumption_L expansion_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> extensionality<span class="main">:</span><span class="main">(</span>5 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">φ</span> <span class="skolem">ψ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="skolem">ψ</span><span class="main">}</span><span class="main">)</span>›</span></span> 
    <span class="keyword1"><span class="command">using</span></span>  equiv_negation<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">‹<span class="main">{}</span>›</span></span> <span class="quoted"><span class="skolem">φ</span></span> <span class="quoted"><span class="skolem">ψ</span></span><span class="main">]</span> valid_Cn_equiv valid_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">K</span> <span class="main"><span class="free">÷</span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">K</span> <span class="main"><span class="free">÷</span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">ψ</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> contract_extensionality extensionality<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Cn_union expansion_def extensionality<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> consistency<span class="main">:</span><span class="main">(</span>6 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">φ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> contract_closure contract_success expansion_def infer_def not_PL<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The relationship between AGM full revision and  AGM full contraction is the same as the relation between AGM revison and AGM contraction›</span></span>
<span class="keyword1"><span class="command">sublocale</span></span> AGM_FullRevision <span class="main">⊆</span> AGM_FullContraction <span class="keyword2"><span class="keyword">where</span></span> contraction <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">λ</span><span class="bound">K</span> <span class="bound">φ</span><span class="main">.</span> <span class="bound">K</span> <span class="main">∩</span> <span class="main">(</span><span class="bound">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="main"><span class="free">.¬</span></span> <span class="bound">φ</span><span class="main">)</span>›</span></span> 
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">goal_cases</span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> conj_overlap<span class="main">:</span><span class="main">(</span>1 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">φ</span> <span class="skolem">ψ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">)</span> <span class="main"><span class="free">.∨.</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="skolem">ψ</span><span class="main">)</span><span class="main">}</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> Cn_same morgan <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span><span class="main">)</span> 
    <span class="keyword1"><span class="command">using</span></span> revis_superexpansion_ext<span class="main">[</span><span class="operator">OF</span> conj_overlap<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">.¬</span></span> <span class="skolem">ψ</span>›</span></span><span class="main">]</span> 
          revis_extensionality<span class="main">[</span><span class="operator">OF</span> conj_overlap<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> a<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> conj_inclusion<span class="main">:</span><span class="main">(</span>2 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">φ</span> <span class="skolem">ψ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span> <span class="main"><span class="free">.∧.</span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">}</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> conj_superexpansion1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Cn_same<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> conj_inclusion <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">cases</span> <span class="quoted"><span class="quoted">‹<span class="skolem">φ</span> <span class="main">∈</span> <span class="skolem">K</span>›</span></span><span class="main">)</span>
    <span class="keyword3"><span class="command">case</span></span> True
    <span class="keyword1"><span class="command">hence</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">)</span> <span class="main">∉</span> <span class="skolem">K</span> <span class="main"><span class="free"><span class="hidden">❙</span><b>*</b></span></span> <span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> absurd_PL  conj_inclusion revis_closure <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> revis_subexpansion<span class="main">[</span><span class="operator">OF</span> conj_inclusion<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> b<span class="main">]</span> revis_extensionality<span class="main">[</span><span class="operator">OF</span> conj_inclusion<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> a<span class="main">]</span> 
             expansion_def inclusion_L <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">case</span></span> False
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> conj_inclusion<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> contract_vacuity<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">locale</span></span> AGMFC_S <span class="main">=</span> AGM_FullContraction <span class="main">+</span> AGMC_S

<span class="keyword1"><span class="command">sublocale</span></span> AGMFC_S <span class="main">⊆</span> AGM_FullRevision <span class="keyword2"><span class="keyword">where</span></span> revision <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">λ</span><span class="bound">K</span> <span class="bound">φ</span><span class="main">.</span> <span class="main">(</span><span class="bound">K</span> <span class="main"><span class="free">÷</span></span> <span class="main"><span class="free">.¬</span></span> <span class="bound">φ</span><span class="main">)</span> <span class="main"><span class="free">⊕</span></span> <span class="bound">φ</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">unfold_locales</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">safe</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">goal_cases</span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> super<span class="main">:</span><span class="main">(</span>1 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">φ</span> <span class="skolem">ψ</span> <span class="skolem">χ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">χ</span> <span class="main">∈</span> <span class="free">Cn</span><span class="main">(</span><span class="free">Cn</span><span class="main">(</span><span class="skolem">A</span><span class="main">)</span> <span class="main"><span class="free">÷</span></span> <span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span><span class="main">)</span>›</span></span> 
    <span class="keyword1"><span class="command">using</span></span> Supraclassical_logic.imp_PL Supraclassical_logic_axioms expansion_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">χ</span> <span class="main">∈</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span><span class="main">}</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> Supraclassical_logic.imp_recovery0 Supraclassical_logic.valid_disj_PL Supraclassical_logic_axioms<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">χ</span> <span class="main">∈</span> <span class="free">Cn</span><span class="main">(</span><span class="skolem">A</span><span class="main">)</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span> <span class="main"><span class="free">.∧.</span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">)</span>›</span></span> 
    <span class="keyword1"><span class="command">using</span></span> contract_conj_overlap_variant<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="skolem">A</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="skolem">A</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span>›</span></span><span class="main">]</span> a b
    <span class="keyword1"><span class="command">using</span></span> AGM_Contraction.contract_closure AGM_FullContraction_axioms AGM_FullContraction_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">have</span></span> d<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span> <span class="main"><span class="free">.∧.</span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">}</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> conj_superexpansion1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Cn_same<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> e<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">χ</span> <span class="main">∈</span> <span class="free">Cn</span><span class="main">(</span><span class="skolem">A</span><span class="main">)</span> <span class="main"><span class="free">÷</span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span>›</span></span> 
    <span class="keyword1"><span class="command">using</span></span> AGM_Contraction.contract_extensionality<span class="main">[</span><span class="operator">OF</span> _ _ d<span class="main">]</span> c
          AGM_FullContraction_axioms AGM_FullContraction_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">hence</span></span> f<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">φ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="main">(</span><span class="skolem">ψ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">χ</span><span class="main">)</span> <span class="main">∈</span> <span class="free">Cn</span><span class="main">(</span><span class="skolem">A</span><span class="main">)</span> <span class="main"><span class="free">÷</span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span>›</span></span> 
    <span class="keyword1"><span class="command">using</span></span> conj_imp AGM_Contraction.contract_closure AGM_FullContraction_axioms AGM_FullContraction_def conj_imp <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assumption_L expansion_def imp_PL infer_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> sub<span class="main">:</span><span class="main">(</span>2 <span class="skolem">K</span> <span class="skolem">A</span> <span class="skolem">ψ</span> <span class="skolem">φ</span> <span class="skolem">χ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="skolem">φ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="main">(</span><span class="skolem">ψ</span> <span class="main"><span class="free">.⟶.</span></span> <span class="skolem">χ</span><span class="main">)</span> <span class="main">∈</span> <span class="free">Cn</span><span class="main">(</span><span class="skolem">A</span><span class="main">)</span> <span class="main"><span class="free">÷</span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AGMC_S.axioms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> AGMC_S_axioms AGM_Contraction.contract_closure expansion_def impI_PL infer_def revis_closure<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> b<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span> <span class="main"><span class="free">.∧.</span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">Cn</span><span class="main">(</span><span class="main">{</span><span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">}</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> conj_superexpansion1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Cn_same<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span> <span class="main">∉</span> <span class="free">Cn</span> <span class="skolem">A</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> sub<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> assumption_L conj_imp expansion_def imp_PL infer_def not_PL<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="skolem">A</span><span class="main">)</span> <span class="main"><span class="free">÷</span></span> <span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span> <span class="main">⊆</span> <span class="free">Cn</span><span class="main">(</span><span class="skolem">A</span><span class="main">)</span> <span class="main"><span class="free">÷</span></span> <span class="main">(</span><span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> contract_conj_inclusion<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">‹<span class="free">Cn</span><span class="main">(</span><span class="skolem">A</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="skolem">A</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">.¬</span></span> <span class="main">(</span><span class="skolem">φ</span> <span class="main"><span class="free">.∧.</span></span> <span class="skolem">ψ</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">.¬</span></span> <span class="skolem">φ</span>›</span></span><span class="main">]</span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AGM_Contraction.contract_extensionality AGM_FullContraction.axioms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> AGM_FullContraction_axioms b c<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> a assumption_L conj_imp expansion_def imp_PL in_mono infer_def<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword2"><span class="keyword">end</span></span>


</pre>
</div>